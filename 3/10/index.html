<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.93.3">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机 :: Gen 的学习笔记</title><link href=/css/nucleus.css?1646808665 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1646808665 rel=stylesheet>
<link href=/css/hybrid.css?1646808665 rel=stylesheet>
<link href=/css/featherlight.min.css?1646808665 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1646808665 rel=stylesheet>
<link href=/css/auto-complete.css?1646808665 rel=stylesheet>
<link href=/css/atom-one-dark-reasonable.css?1646808665 rel=stylesheet>
<link href=/css/theme.css?1646808665 rel=stylesheet>
<link href=/css/tabs.css?1646808665 rel=stylesheet>
<link href=/css/hugo-theme.css?1646808665 rel=stylesheet>
<link href=/css/theme-green.css?1646808665 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1646808665></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/3/10/>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a id=logo href=/><svg id="grav-logo" style="width:100%;height:100%" viewBox="0 0 504 140" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421"><path id="path189" style="fill:#000;stroke-width:.204716" d="m82.052734 5.96875c-.854728.206286-1.398833 1.0426648-2.119991 1.5136522-1.191736.9811717-2.382712 1.9632671-3.575321 2.9433788 2.594183.350428 5.145702.867699 7.545412 1.808313 5.15394 2.088262 10.087847 4.726839 15.416602 6.374822 1.147804.40744 2.285264.842546 3.422754 1.277803 1.75942-1.384373 3.51938-2.768062 5.27734-4.154297-5.15508-1.970902-10.472419-3.533913-15.466989-5.9135627-3.304489-1.4459104-6.569291-3.1504213-10.136525-3.8383905-.121039-.00522-.24197-.024031-.363282-.011719z"/><path id="path450" style="fill:#000;stroke-width:.204716" d="m196.30273 32.138672c-1.55372 1.106817-3.11032 2.209608-4.66406 3.316406 4.11763 4.405283 7.13993 9.726972 9.45954 15.262663 1.56282 4.287959 2.2182 8.808703 2.86451 13.292499.38887 3.231143.62551 6.590222.0466 9.712715-.96049 4.643178-2.51468 9.199787-4.84902 13.336481-1.78789 2.835013-4.77216 5.01731-8.11326 5.529767-2.16053.194334-4.25815-1.330295-4.80458-3.419166-.29054-.914485-.51906-1.850946-.67999-2.79699 2.1261-1.148168 4.25191-2.296867 6.37891-3.443359.78567-2.636208 1.75001-5.564844.60547-8.248047-.53525-1.298746-2.07776-1.892115-3.39901-1.607978-1.67519.02941-3.3829.406643-4.74129 1.430853-2.09614 1.168313-4.10099 2.916619-4.64291 5.358765-.73735 2.904669-.11138 5.915639.29727 8.820042.49411 2.882218 1.53935 5.996824 4.13517 7.643151 2.35305 1.561098 5.48511 1.763546 8.04109.579307 3.30354-1.331591 6.21912-3.456703 8.96703-5.688008 1.96663-1.643363 3.42478-3.806368 4.42597-6.15213 2.06828-4.393527 3.59057-9.083525 4.21247-13.907794.54472-5.741127-.61574-11.455157-1.66588-17.071718-.80064-3.920321-2.18078-7.71884-4.16423-11.197019-2.05596-3.912809-4.48616-7.631847-7.30162-11.041456-.13607.097-.27214.194011-.40821.291016zm-8.92578 46.195312c.2043 1.815935-.60122 3.548925-1.07929 5.263081-.26336.819832-.52694 1.639598-.78985 2.459576-.30945-2.140868-.59564-4.349894-.22997-6.496983.18103-.524926.30215-1.38075 1.03046-1.299978.29126.03359 1.0366-.341949 1.06865.0743z"/><path id="path452" style="fill:#000;stroke-width:.204716" d="m194.86719 31.490234c-1.70711 1.334537-3.41328 2.670271-5.1211 4.003907 2.86943.883205 5.775 2.063806 7.95683 4.093286 4.34216 3.834897 7.82362 8.740548 9.94201 14.191942 1.76448 4.476901 2.8312 9.131581 3.98461 13.784118.98733 4.367667 1.90544 8.806141 3.88594 12.856576 1.24292 2.622586 2.70301 5.245971 5.0027 7.092602 2.86039 2.399492 6.23621 4.055842 9.38886 6.021597 2.04982 1.173006 4.12056 2.42864 6.39784 3.079398 1.45651.10626 2.44267-1.215991 3.58737-1.828292.94383-.603205 1.48969-1.756053 1.1938-2.859996-.26262-3.334359-1.79835-6.420037-2.55184-9.603237-1.082-3.641846-2.12776-7.319367-2.61203-11.103361-1.00164-5.999038-1.25683-12.026556-1.07049-18.099458.15781-3.468309.76516-7.086829 1.79952-10.394254.64699-1.974316 1.63337-3.824169 2.48746-5.7485 1.81963 1.486138 2.86594 3.671816 3.9004 5.728955.64108 1.500012.97375 3.161278.76757 4.790577-.65333-.253181-1.39605-.122429-1.84271.440021-1.42475 1.127514-2.85059 2.25365-4.27448 3.382244 1.88905.912209 4.07218 1.774111 6.16993 1.046875 1.41721-.500184 2.61209-1.460186 3.82031-2.322265 1.61109-1.433166 2.12717-3.722659 1.84286-5.796283-.25541-3.407249-2.01838-6.471843-3.90241-9.234739-1.20503-1.564932-2.69095-3.179269-4.68989-3.629264-2.29359-.240154-4.23277 1.369272-5.7447 2.892708-1.43661 2.020458-2.19043 4.395461-3.26252 6.599693-1.49815 3.623296-2.20417 7.528274-2.57907 11.414395-.28341 3.951365-.19329 7.924341.002 11.877608.33001 4.919807.95661 9.833736 2.05577 14.642753.86678 3.567725 1.99782 7.062219 3.05361 10.576879-3.15033-1.782655-6.31477-3.575686-9.24095-5.712379-2.79226-2.230651-4.33102-5.569215-5.59547-8.821527-1.43467-3.856976-2.08138-7.93959-3.1517-11.901307-1.2033-4.621024-2.39596-9.284022-4.32968-13.665113-2.65871-5.844039-6.70058-11.067953-11.71736-15.073502-1.61991-1.219808-3.40929-2.21157-5.31445-2.910157-.0794.0625-.15886.125-.23828.1875z"/><path id="path454" style="fill:#000;stroke-width:.204716" d="m254.32422 60.896484c-2.83006.191036-5.03358 2.200857-7.25961 3.693573-2.47583 1.745762-4.35875 4.322203-5.13274 7.262544-.87682 3.10457-.8925 6.386041-.66333 9.580213.28103 2.760325 1.40168 5.413874 3.21193 7.520311 1.70594 2.226415 3.96523 4.02624 6.58223 5.060539 1.96205.825143 4.24546 1.477142 6.30644.60157.53052-.223408-.579.488221-.79955.696267-3.55669 2.717013-6.96075 5.643309-10.03806 8.898339-3.00732 3.02489-5.58812 6.54712-7.09012 10.56555-1.52988 3.64022-2.18897 7.75831-1.16537 11.62585 1.1817 4.89934 4.89376 9.02479 9.55065 10.89607 3.31904 1.41685 6.8989 2.15208 10.47421 2.53862 1.33062.14817 2.74633-.0804 3.79142-.97127 1.26107-.73033 2.85276-1.49217 3.09455-3.10504.98221-4.40417.4144-8.94054.57187-13.40766.0559-9.78704-.13373-19.58303.15814-29.363921.22294-.322518.70593-.47792.98565-.786323 3.15772-2.482196 6.24325-5.094621 9.44181-7.481219.59962-.562387 1.37371-1.333493 1.12122-2.214688-.58838-1.019752-1.9005-.72381-2.80832-.393333-1.78507.665067-3.47142 1.597264-4.9082 2.856236-1.27226.954663-2.48458 2.004466-3.71388 2.992226.0582-1.808273-.2238-3.702052.46966-5.419967 1.29511-4.12273 1.38265-8.583115.37497-12.777365-.40543-2.092479-.5444-4.224875-.57901-6.349544-.12138-1.041696-1.27545-1.792292-2.25563-1.339589-.44131.07748-.73882.621708-1.12056.653678-2.66594-1.25476-5.64308-1.684906-8.56131-1.835573zm.33203 5.285157c2.01725.246306 4.08801.70676 5.74023 1.958984.49385-.198426.10745 1.069897.2356 1.480834.0141 5.004454.0397 10.022836-.26491 15.015164-.54725 1.610021-1.37948 3.119937-2.27537 4.560643-.29357.413619-.64502.972024-1.23854.753886-2.97677-.555212-5.7871-2.226129-7.55638-4.708964-1.73668-1.945495-2.4821-4.544038-2.47151-7.147851-.0102-2.492946.0306-4.99488.91085-7.343489.73261-1.875515 1.96563-3.730677 3.8265-4.614744 1.01134-.351459 2.06471-.0229 3.09353.04554zm5.48437 34.769529c-.0724 10.74931.0496 21.50087-.0827 32.24888-.0316.50518-.0784 1.00973-.14971 1.51089-3.6299-.36444-7.17132-1.2816-10.41387-2.97137-3.31505-1.88151-5.62981-5.38503-6.00686-9.18451-.34732-2.69647.25495-5.42026 1.34629-7.88372 1.31942-3.35117 3.42797-6.40619 5.95909-8.88755 2.88063-3.07638 6.02153-5.910197 9.37903-8.457618-.0104 1.208333-.0208 2.416667-.0313 3.624998z"/><path id="path456" style="fill:#000;stroke-width:.204716" d="m286.45117 62.744141c-.66276.0108-1.0893.579612-1.58984.919921-2.93216-.416883-6.1457-.03654-8.52713 1.859521-1.32775.839426-2.71795 1.775792-3.34291 3.285064-1.96619 3.59837-2.81372 7.799977-2.48463 11.879219.58618 4.391569 3.77417 8.360576 8.02068 9.714478 3.09823 1.057475 6.42957 1.208399 9.67383 1.054687 2.00132-.177732 3.83824-1.164999 5.41409-2.288612 1.93792-1.221245 3.80495-2.745567 4.75664-4.887712 1.27631-2.582436 2.06687-5.395576 2.51547-8.233505.29359-2.654253-1.0275-5.228394-2.7852-7.132573-2.12288-2.207611-4.88968-3.643737-7.64514-4.897051-1.24663-.488298-2.51233-.998051-3.82059-1.270293-.0615.0067-.12392-.01566-.18527-.0031zm-.76172 5.544921c1.33874.466153 2.72682 1.108914 3.99146 1.820734 2.3343 1.241606 4.77095 2.977239 5.44214 5.689032.34285 2.011522-.5266 3.97606-1.06266 5.878051-.57623 1.593021-1.21802 3.351886-2.6703 4.347853-1.85437.702929-3.8863.346015-5.81627.291151-2.9267-.216886-6.09721-1.13898-7.8626-3.659801-1.58319-2.125298-1.94862-4.931501-1.41712-7.483183.34601-2.202505.95334-4.411407 2.16488-6.305711 1.72955-.549238 3.55003-.159042 5.2991.01258.58196.0145 1.07248-.33425 1.44114-.750866.16341.05339.32682.106771.49023.160156z"/><path id="path458" style="fill:#000;stroke-width:.204716" d="m312.22656 63.080078c-2.51287-.06687-4.65817 1.475076-6.57812 2.91211-2.04617 1.597902-3.36366 3.956301-3.96106 6.457589-.69758 2.785863-.78555 5.72098-.38894 8.557054.45501 2.562579 1.62143 5.141346 3.83069 6.648159 2.22165 1.784303 4.86213 3.031589 7.67199 3.533149 3.55108.707794 7.20025.635324 10.80301.591013 2.16637-.158142 4.39539-.452498 6.36267-1.410011 2.07587-1.747288 3.95151-3.712247 5.70312-5.78125-2.79921.445598-5.49844 1.330936-8.26339 1.923705-3.39336.425307-6.83433.249648-10.23012-.04257-3.24745-.407049-6.52917-1.646109-8.82841-4.041056-.87222-1.044913-1.21587-2.282305-1.45637-3.562052-.26964-2.262109-.13957-4.588823.36966-6.808958.33731-1.374369.93104-2.721367 1.91644-3.756179 2.37937-.429241 4.84399.104078 7.07813.939453 1.11063.442475 2.11782 1.117109 2.96875 1.955078 1.69271-1.222252 3.38676-2.442646 5.08008-3.664062-2.66632-2.652709-6.35737-4.016762-10.05096-4.376845-.67268-.08546-1.35003-.09118-2.02717-.07433z"/><path id="path460" style="fill:#000;stroke-width:.204716" d="m286.07422 99.496094c-1.07934-.0024-1.82247.939246-2.52539 1.519526-.851.70779-1.76177 1.34363-2.75 1.84571.10409 1.4247 1.00637 2.71545 2.30403 3.3049 1.0993.9205 2.58927 1.76482 4.04753 1.17752 1.90839-.57603 3.60529-2.60159 3.03127-4.66604-.24239-1.55382-1.36304-3.209315-3.09377-3.187476-.33817.0088-.67622-.02649-1.01367.0059z"/><path id="path464" style="fill:#000;stroke-width:.204716" d="m371.67188 20.626953c-3.87604 1.944717-7.75613 3.888659-11.47852 6.119141 1.10416-.0044 2.20833-.0089 3.3125-.01172-2.12786 4.917471-2.2546 10.388689-2.12305 15.660156.35129 5.01355 2.02586 9.810998 3.70363 14.509646 1.38866 3.777132 2.7827 7.452227 3.66164 11.3659.85336 3.402855 1.29928 6.910206 1.308 10.447135.0802 4.183874.21652 8.436832-.61619 12.533292-.82952 4.256594-2.10342 8.496467-4.44794 12.181686-1.27591 2.17814-2.95847 4.09056-4.92893 5.66614-1.4947 1.30394-3.28466 2.42294-5.1431 2.96612-2.39632.75818-4.8139.92992-7.31504.96576-1.38398-.001-2.76732-.6657-3.42811-1.91942-1.17952-1.92247-1.43828-4.29667-1.23452-6.50088-.072-.59683.49407-.45599.8906-.49906.4488-.0105 1.13089-.11797 1.17301.51024.41153 1.70485.26658 3.48863.31896 5.23047 71e-5.68229.002 1.36459.003 2.04688 1.90405-1.12478 3.80883-2.24831 5.7129-3.37305-.13258-2.7825.25622-5.8613-1.42774-8.28125-.9124-1.199373-2.54906-1.368673-3.94062-1.215946-1.58257-.05091-3.231.243516-4.50269 1.241586-2.01363 1.04845-3.69566 2.97113-3.89001 5.30511-.35901 2.56593.15031 5.20715 1.10217 7.59326 1.08182 2.48207 3.33319 4.66552 6.14699 4.84641 2.41571.25391 4.83773-.17138 7.23065-.45987 3.43975-.6249 6.46732-2.49346 9.27287-4.49033 3.70335-2.48113 7.17849-5.51773 9.32948-9.48525 2.76734-4.614072 4.23626-9.901741 4.96799-15.199902.5525-4.277499.36306-8.601147.27024-12.900272-.10538-3.360412-.59916-6.701988-1.5034-9.941147-1.01323-4.310005-2.61015-8.445066-4.11035-12.599558-1.15953-3.383432-2.2477-6.765931-2.76717-10.283458-.33024-3.191741-.23107-6.55122.089-9.779123.36915-3.275313 1.43804-6.518457 3.45986-9.153927.90985-1.339577 1.8197-2.679149 2.72974-4.018598-.60873.307943-1.21745.615885-1.82617.923828z"/><path id="path466" style="fill:#000;stroke-width:.204716" d="m378.41211 36.992188c-2.95498.280324-5.86099.959554-8.72191 1.726685-3.48706 1.125695-6.68165 3.068917-9.47059 5.423031-2.56647 2.52845-3.92486 5.941757-5.55982 9.083275-.82608 1.721803-1.65239 3.443491-2.47815 5.165446 2.4334-1.275762 4.86732-2.550527 7.30078-3.826172 1.48474-3.078592 2.82421-6.267576 5.04492-8.919922.37009-.484192 1.06101-.352533 1.4769-.805542.96403-.824462 2.26732-1.015047 3.43718-1.415431 2.16001-.556031 4.36494-1.020535 6.56444-1.321996 1.63608-.05267 2.81813 1.277896 3.61272 2.548816 1.61011 2.517063 2.53967 5.509476 2.17683 8.471365-.15926.806383-.30463 1.757669-.91027 2.335911-1.23529.812349-2.5271 1.570455-3.64881 2.53258-1.05465 1.010852-1.29014 2.99378.005 3.90959 1.10397.771221 2.48005.146732 3.46359-.520192 1.29018-.710688 2.43727-1.673469 3.63473-2.496494 3.70686-.791836 7.53625-.861897 11.30656-.662435 1.77784.291901 3.18039 1.611104 4.02392 3.142913 2.57898 3.825958 4.24413 8.148004 4.98248 12.705642.67022 3.616411 1.12179 7.379282.74216 11.014872-.34106 1.748258-.84725 3.691605-1.96926 5.175636-.96893.649595-2.1745.835524-3.28802 1.122337-2.6009.548228-5.39227.396336-7.7976-.803806-2.77349-1.192048-5.22531-3.0329-7.28016-5.233016-.3945-.779099-.90346-.07995-1.38135.226711-1.35242.977451-2.70594 1.953363-4.05756 2.931914 2.24054 2.398724 4.74359 4.601413 7.68825 6.093768 3.25183 1.841965 7.13161 2.665009 10.82624 1.922007 3.6294-.612513 7.11555-2.286566 9.77115-4.844758 1.96335-2.122487 2.68295-5.045637 3.19814-7.807952.3987-5.091629-.44666-10.18885-1.56074-15.141305-1.05935-4.233613-3.02767-8.207304-5.51137-11.780005-1.25317-1.797572-3.09833-3.242237-5.29091-3.639442-2.34828-.50242-4.76173-.155362-7.13833-.149969-1.48293.0791-2.96525.208398-4.43164.447266 1.1072-4.302368-.25828-8.87208-2.60303-12.520248-1.37932-2.074659-3.51292-4.084833-6.15674-4.09108z"/><path id="path468" style="fill:#000;stroke-width:.204716" d="m423.28906 62.134766c-1.63995.97054-3.28033 1.94036-4.92187 2.908203-.005 4.860224-.0554 9.74159.63518 14.564078.26451 3.642161-.0516 7.367269.98576 10.916826.42202 1.528949.57544 3.428854 2.02945 4.374565 1.67804 1.119853 3.85376.452608 5.42395-.533389 2.15482-1.410381 4.32474-2.885565 5.95208-4.915798 1.06489-1.237277 1.93975-2.619085 2.8603-3.962923-2.69521.780684-5.50568 1.495949-7.83152 3.126296-.73545.615066-1.29977 1.758673-2.3345 1.799485-.65265-2.346208-1.1458-4.764948-1.22309-7.213103-.001-3.183751-.28693-6.355244-.63761-9.516081-.28356-3.960842-.13171-8.020399-.13344-12.024722-.26823.158854-.53646.317708-.80469.476563z"/><path id="path470" style="fill:#000;stroke-width:.204716" d="m421.32422 50.556641c-1.07185.409354-1.82089 1.344889-2.78081 1.947169-.73001.555316-1.46029 1.110263-2.18989 1.666112 1.19469.615669 2.29216 1.471247 3.61328 1.802734-.0189 1.007812-.038 2.015621-.0566 3.023438 1.91341-1.124993 3.82781-2.248329 5.74023-3.375.0396-1.199558-.0142-2.413731.24219-3.587891-.0222-1.061754-1.27193-1.818341-2.21354-1.303916-.4361.07207-.95475.446837-1.31358.0097-.30768-.168724-.69727-.282971-1.04124-.182359z"/><path id="path474" style="fill:#000;stroke-width:.204716" d="m478.08398 8.6914062c-3.04434.14731-5.7197 1.8438508-8.10248 3.6007978-1.72765 1.357081-2.97442 3.250966-3.63815 5.337598-2.26887 6.050536-2.21342 12.612826-2.40727 18.981009-.15743 8.550261.61576 17.100356 1.57762 25.572923.191 1.852456.35825 3.707256.52146 5.56236-2.14353 4.328099-4.51967 8.591659-7.70401 12.250805-2.36409 2.930614-4.6741 5.893283-7.25693 8.60857-1.23948.310478-2.55965.07497-3.80664-.115235-2.07257-.364678-3.86782-1.59835-5.23261-3.16249-1.81027-2.033779-3.15103-4.509976-3.85346-7.138711-.58177-3.373649.71016-6.7518 2.34552-9.649041.48255-.732833.88067-1.621841 1.6468-2.092726 2.34007-.143427 4.64989.535834 6.77539 1.46875.99634-.283035 1.63883-1.177063 2.49285-1.713624.99586-.778422 1.99114-1.557572 2.98762-2.335204-3.46085-1.340304-7.09892-2.967477-10.89987-2.427405-2.11783.508015-3.79571 2.000439-5.52392 3.235425-2.68145 2.341808-4.00679 5.78142-5.09379 9.076745-.89502 3.13538-.75704 6.605691.71513 9.548105 1.7092 3.847785 4.41928 7.489981 8.28686 9.356697 2.33088 1.021718 4.95868 1.325034 7.47457 1.052229 2.3056-.511534 4.29585-1.953137 6.00586-3.52539 2.54674-2.587205 4.77423-5.461403 7.04935-8.278252 1.52223-1.934278 3.11838-3.823289 4.42135-5.917061.59397 4.795158.8271 9.581025.6875 14.417969.0867 1.188555-.17941 2.681701.89258 3.509766.8519.734443 2.1919.630446 2.95133-.187286.77818-.629943 1.39784-1.430245 2.18539-2.050996.33463-4.101681.12961-8.221072.17483-12.330182-.0958-2.588148-.18458-5.17999-.3428-7.763568-.3245-1.63234-.58546-3.442123.28436-4.958718.51754-.816296 1.63351-.855617 2.47541-1.136985 1.29347-.223993 2.66956-.428758 3.95583-.11448 1.70322.767865 2.36308 2.681045 3.25511 4.18284 2.45359 5.01299 2.5034 10.662947 3.45117 16.066406.39453 1.998924.93975 4.059017 2.15761 5.723926 1.20516 1.352908 3.27678 1.341194 4.82481.637402 4.38174-1.593728 8.19236-4.35232 12.07422-6.859375 1.31644-.900078 2.96011-1.738505 3.51562-3.339844.18957-1.049313-1.14649-1.612884-1.96679-1.169922-.35611.233689-.66171.381595-1.10399.363009-2.26559.572321-3.99719 2.262336-6.02241 3.343699-2.07882 1.256166-4.16238 2.484729-6.55915 3.076496-.54459-.626324-.63649-1.53044-.94141-2.28711-.9522-3.598937-.99491-7.326699-1.76776-10.965895-.59128-3.450187-1.70586-6.83908-3.59788-9.802482-1.17173-2.100903-3.12486-4.124232-5.67959-4.213301-1.78692-.04961-3.60589.110612-5.3292.60205-.7058.211269-1.39123.486775-2.05525.805409 3.21714-7.057532 5.53801-14.470846 8.14459-21.764942 1.39013-3.996916 2.6535-8.095743 2.86422-12.350426.27986-3.961867.2851-7.946035.11578-11.911498-.22997-2.048169-.57126-4.334547-2.12459-5.8286024-1.48757-1.1781658-3.52717-.9718637-5.30079-.9902344zm-1.34765 5.0468748c.75756.100169 1.59662-.102993 2.29883.236328 1.20912 2.467702.83156 5.298741.93641 7.954687.0175 5.110463-.15302 10.311699-1.90356 15.185035-2.1116 6.637828-4.48624 13.179085-6.98769 19.684909-.22521.70112-.41136 1.033956-.41626.0992-.7906-7.151956-1.36504-14.321603-1.13549-21.539947.1018-5.837394.16128-11.671654 2.02378-17.234781.55964-1.515727 1.23048-3.250281 2.74843-4.035819.79358-.213639 1.61188-.339885 2.43555-.34961zm-4.6543 76.720703c.62866.420068-.45727 1.13443-.58012.305527-.23418-.244089.43497-.422407.58012-.305527z"/><path id="path476" style="fill:#000;stroke-width:.204716" d="m444.84375 25.214844c-1.64773.385233-3.25602 1.067363-4.67561 1.987852-2.04086 1.6493-3.49412 3.884237-5.29746 5.771289-2.66063 2.970824-5.68987 5.575842-8.77289 8.092454-.58007.602259-1.39502 1.328599-1.25795 2.242155.25323.910636 1.38471.929547 2.11011.630268 1.39615-.334178 2.69141-1.03155 3.91085-1.761623 4.12198-3.246933 7.92443-6.902681 11.24802-10.966954 1.09459-1.394037 2.48316-2.522459 3.55811-3.926379.59161-.629078.42113-1.908335-.5224-2.035859-.10001-.0081-.19903-.06601-.30078-.0332z"/><path id="path510" style="fill:#000;stroke:#000;stroke-width:.0832446" d="m156.66797 65.568359c-1.40281.04819-2.00876 2.164215-.79102 2.908203 1.10643.978518 2.94358-.355474 2.51367-1.714843-.18241-.751321-.9599-1.271376-1.72265-1.19336z"/><path id="path512" style="fill:#000;stroke:#000;stroke-width:.0832446" d="m156.66797 65.568359c-1.40281.04819-2.00876 2.164215-.79102 2.908203 1.10643.978518 2.94358-.355474 2.51367-1.714843-.18241-.751321-.9599-1.271376-1.72265-1.19336z"/><path id="path1432" style="fill:#000;stroke-width:.202157" d="m94.878906 30.269531c-2.287631.898028-4.703901 1.605195-6.807724 2.877579-4.485024 5.491989-6.611133 12.401509-8.442948 19.132856-1.605329 6.046121-2.840557 12.204453-4.985613 18.095796-2.771657 8.014773-6.035967 15.844748-10.868943 22.859542-1.749947 2.479612-3.601343 4.885482-5.392819 7.335006 2.85849-1.26468 5.716446-2.530574 8.574219-3.796872 6.610002-8.720957 10.691919-19.019319 14.096589-29.330787 2.790753-8.7136 4.127071-17.89265 7.79901-26.319883 1.235636-2.821633 2.900303-5.441874 4.898209-7.783699.952846-1.237371 1.905694-2.474742 2.858536-3.712116-.576172.214193-1.152344.428386-1.728516.642578z"/><path id="path1434" style="fill:#000;stroke-width:.202157" d="m93.257812 30.740234c-1.733368.858571-3.440196 1.845878-5.164062 2.751954.810252 5.34993 3.024219 10.347909 4.425405 15.521466 2.072478 6.784453 3.847313 13.681516 5.505429 20.598588 1.180239 4.908903 1.729165 9.94751 2.987136 14.836977.96649 3.670046 2.49394 7.275685 4.9564 10.198384.78807.844102 1.64803 1.682248 2.67836 2.213725.88334.191728 1.43837-.72189 2.17288-1.03501 1.14091-.744883 2.2825-1.48873 3.42283-2.234521-1.77857-1.19183-3.63718-2.460542-4.64263-4.417814-3.0829-4.597975-3.70366-10.234336-4.77902-15.52966-.8585-4.588927-2.03141-9.108024-3.16222-13.634617-.51284-2.223885-1.15403-4.419896-1.735477-6.627752-1.569505-5.662739-3.34325-11.323358-5.050111-16.90562-.517229-1.710922-.87143-3.482123-.92156-5.26735-.0439-.278108-.408679-.604452-.69336-.46875zm7.623048 27.275391c-.2376.743408-1.454441-.29859-.48492-.165475.15225.06679.66504-.188859.48492.165475z"/><path id="path1440" style="fill:#000;stroke-width:.202157" d="m93.693359 58.945312c-4.070097.13705-8.123695.652337-12.201562.568416-3.492748.01042-6.98542-.0175-10.478125-.02935-2.241288 1.678066-4.483664 3.354679-6.72461 5.033203 6.767011-.175815 13.540661.04814 20.304958-.196194 5.878883-.507678 11.806803-.677339 17.69857-.02042 1.78153.149956 3.55694.456984 5.32078.675666 1.05621-.117502 1.71027-1.096398 2.59049-1.591397 1.38565-1.016663 2.77006-2.035027 4.15747-3.049296-3.12468-.07048-6.17775-.620639-9.27187-.956016-3.16628-.218965-6.328998-.549518-9.507395-.458409-.629656-.01131-1.259141.01642-1.888706.0238z"/><path id="path1442" style="fill:#000;stroke-width:.202157" d="m137.80273 32.195312c-.71131-.02645-1.22365.533659-1.76757.896485-3.32296-.648355-6.5358.949258-9.31521 2.591857-4.13708 2.423361-8.39589 5.160194-10.8685 9.405801-2.81817 4.65217-3.70379 10.122397-4.38312 15.431557-.71678 4.62043-.63171 9.312129-.6621 13.974246-.17073 3.941542 1.22301 7.714025 2.78316 11.263402 1.47756 3.374971 2.98687 6.93403 5.78974 9.440876 2.60206 2.103977 5.98229 2.938743 9.26997 3.079382 3.01616.178255 6.04839.197489 9.0654.05924 3.25526-.352297 6.13656-2.210964 8.52083-4.353872 1.9125-1.802379 3.23536-4.122029 4.467-6.415823 1.96654-3.819715 2.97141-8.06343 3.32178-12.327816.63197-6.298061.53467-12.640058.51157-18.961602-.31286-6.555578-3.34059-12.6311-7.00772-17.94516-1.36398-2.116257-3.08084-4.117768-5.41961-5.176398-1.33498-.643965-2.82253-.990471-4.30562-.962179zm.92969 5.699219c2.47608 1.49523 3.89223 4.131017 5.42803 6.481762 2.3619 3.875065 4.21223 8.273459 4.57393 12.778004.10946 3.540014.0754 7.199129.0226 10.786117-.13267 4.59801-.30727 9.207498-1.382 13.719742-.93846 3.818379-2.73823 7.354917-5.25828 10.371228-.54974.799923-1.41776 1.322856-2.39992 1.343616-2.75225.198886-5.52039.102639-8.2763.011-2.77568-.07296-5.73025-.633233-7.86708-2.529377-2.10928-2.179327-3.28872-5.047642-4.51317-7.774861-1.11282-2.692425-2.33357-5.39614-2.44851-8.361666-.14085-3.190521-.0674-6.390597.0562-9.581427.14975-3.270265.65943-6.610104 1.17386-9.878406.69163-3.869378 1.85813-7.786775 4.2574-10.998784 1.95471-2.475077 4.54847-4.446958 7.40796-5.758508 1.93693-.843915 4.24175-.844849 6.06259.206969.44889.199604.90067.715415 1.31312.18647.57632-.317847 1.12482-.8901 1.71804-1.053332l.0931.03644z"/><path id="path2471" style="fill:#000;stroke-width:.202157" d="m19.875-1.1464844c-2.467326.20038379-4.416995 1.8977635-6.465485 3.1000412-2.092157 1.6351412-3.347691 4.0900298-4.3407045 6.4976497-1.162515 3.0913185-1.9649042 6.3534035-2.1332636 9.6581685-.020817 3.848753 1.14656 7.564265 2.0214843 11.275391.9423091 3.535474 1.9990858 7.038851 3.0273438 10.550781-3.558475 2.085762-7.2987095 4.432847-9.2179466 8.23808-1.91058832 3.644811-3.22225643 7.686999-3.32760678 11.823119.0280441 1.872592 1.03030634 3.785445 2.80262948 4.546582 2.8585542 1.517064 6.1649538 1.732272 9.3167369 2.130179 2.211118.216219 4.432631.329845 6.654703.314774.344948 5.553728.702102 11.179714-.130052 16.708708-.113818.436681-.01061 1.276409-.671293.840427-3.346086-.889374-7.010389-.937983-10.2533429.368834-1.4220886.706309-2.8423797 1.439918-4.1587002 2.330061-1.4833855 1.011485-2.50642305 2.816075-2.15738584 4.639764.27670544 1.50483.83204454 2.946746 1.31812824 4.392702 1.0029707 2.447538 2.6634652 4.859863 5.174811 5.915053 1.664462.60635 3.4565307-.0423 4.8542497-.98599 2.199044-1.234 4.187541-2.882528 5.579001-5.004834 1.075465-1.478272 2.02244-3.044267 2.962162-4.610975 3.73972 1.912958 7.639363 3.750579 11.866027 4.220964 5.229014.819247 10.534141 1.238137 15.827896 1.103707 4.609822-.188519 9.320543-1.100025 13.28447-3.57145 2.628989-1.435801 5.127933-3.288571 6.707934-5.886007 2.551407-3.93756 3.549201-8.680994 3.793283-13.30966.08651-4.065033-.232752-8.209911-1.679065-12.044616-1.683663-4.622633-4.346852-8.915431-7.956449-12.282379-4.78356-4.628438-10.902243-7.535639-17.076681-9.825795-7.576235-2.890711-15.799324-3.887274-23.870477-3.415234-1.45148.184805-2.908547.38467-4.31686.793673-1.772122-6.15093-3.742629-12.328265-4.585432-18.662232-.243926-3.049717.472069-6.06426 1.365298-8.9933226.743461-2.0621443 1.62728-4.2323716 3.323377-5.6960226.804625-.5857958 1.775496.026879 2.575239.3129153.608663.2214678 1.178371.9384883.681754 1.546329-.687235 1.1336659-1.997566 1.6924602-2.676648 2.8375411-.420302.6993466-1.297068 1.3490728-.984369 2.2680738.448857.947951 1.697752.638275 2.485067.36589 1.793577-.782484 3.519119-1.7891435 5.009073-3.0651091 1.372296-1.2711291 2.618085-3.140637 2.133059-5.0953206-.549199-2.41423932-3.002514-3.84881267-5.297121-4.2288982-.484264-.078-.974257-.1160508-1.464844-.1015625zm2.066406 42.4824224c5.853967-.03158 11.785551.546324 17.387283 2.30404 4.052566 1.30083 8.026984 2.903842 11.762369 4.951333 5.171419 2.854776 9.830438 7.20005 12.475348 12.525877 1.234364 2.513606 2.149442 5.042218 2.600007 7.830174.348285 2.619998.47256 5.234756.24345 7.882353-.425086 3.919758-1.452478 7.980039-4.029004 11.066769-.637384.750619-1.422851 1.348609-2.123047 2.027344-3.417276 1.602835-7.25638 2.104568-11.001905 2.182687-4.985171.02644-9.943714-.403025-14.861623-1.232555-3.16245-.549877-6.092862-1.904429-8.944116-3.320687-.838298-.398379-1.679269-.793986-2.540012-1.141164 1.812739-5.97312 1.288897-12.293939 1.067125-18.439473.08478-.454615-.401074-1.38791.322921-1.299128 3.346957-.366107 6.725447-.875339 9.86123-2.155826 2.572518-.853242 5.295532-1.091423 7.965567-1.478959.642141-.03087 1.250964-.146033 1.697525-.648911 2.229063-1.713274 4.457918-3.426817 6.687195-5.139812-4.945597.703564-9.950537 1.113255-14.814788 2.283884-1.61454.601637-3.200266 1.331198-4.929937 1.532373-2.392654.476772-4.818149.835899-7.265041.964993-.635149-6.333213-1.951949-12.621946-4.230469-18.576172-.181271-.560347-.446635-1.227831-.632812-1.841797 1.092247-.174855 2.197184-.257762 3.302734-.277343zm-8.710937 2.630859c1.73383 4.920162 3.416007 9.901736 4.097298 15.096077.154901 1.011684.293383 2.025855.410514 3.042595-3.639733-.157396-7.270674-.462804-10.7617185-1.548828-.916187-.285016-1.9318113-.99391-1.7441406-2.091797.067658-2.619841.815338-5.182345 1.7460937-7.615235 1.0452584-2.582819 2.7582053-5.072404 5.2017964-6.593561.355667-.148591.965967-1.118661 1.0366-.331886zM11.498047 88.84375c1.581425.113622 3.132072.488669 4.638672.970703-1.320122 2.612878-3.004131 5.040366-4.855469 7.300781-.497488.672024-1.249391-.0561-1.6745127-.424631-1.8941345-1.83007-2.544719-4.510543-3.0598623-6.995291.5756926-.538238 1.4988482-.576207 2.2554181-.731905.8912275-.117794 1.7976289-.18021 2.6957539-.119657z"/></svg>
</a>
</div><div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div><script type=text/javascript src=/js/lunr.min.js?1646808665></script>
<script type=text/javascript src=/js/auto-complete.js?1646808665></script>
<script type=text/javascript>var baseurl="https://artisanbox.github.io"</script>
<script type=text/javascript src=/js/search.js?1646808665></script>
</div><section id=homelinks>
<ul>
<li>
<a class=padding href=/><i class="fas fa-home"></i> Gen 的学习笔记</a>
</li></ul></section><div class=highlightable>
<ul class=topics>
<li data-nav-id=/1/ title=MySQL实战45讲 class=dd-item>
<a href=/1/>
MySQL实战45讲
</a>
<ul>
<li data-nav-id=/1/1/ title=01_基础架构：一条SQL查询语句是如何执行的？ class=dd-item>
<a href=/1/1/>
01_基础架构：一条SQL查询语句是如何执行的？
</a>
</li><li data-nav-id=/1/2/ title=02_日志系统：一条SQL更新语句是如何执行的？ class=dd-item>
<a href=/1/2/>
02_日志系统：一条SQL更新语句是如何执行的？
</a>
</li><li data-nav-id=/1/3/ title=03_事务隔离：为什么你改了我还看不见？ class=dd-item>
<a href=/1/3/>
03_事务隔离：为什么你改了我还看不见？
</a>
</li><li data-nav-id=/1/4/ title=04_深入浅出索引（上） class=dd-item>
<a href=/1/4/>
04_深入浅出索引（上）
</a>
</li><li data-nav-id=/1/5/ title=05_深入浅出索引（下） class=dd-item>
<a href=/1/5/>
05_深入浅出索引（下）
</a>
</li><li data-nav-id=/1/6/ title=06_全局锁和表锁：给表加个字段怎么有这么多阻碍？ class=dd-item>
<a href=/1/6/>
06_全局锁和表锁：给表加个字段怎么有这么多阻碍？
</a>
</li><li data-nav-id=/1/7/ title=07_行锁功过：怎么减少行锁对性能的影响？ class=dd-item>
<a href=/1/7/>
07_行锁功过：怎么减少行锁对性能的影响？
</a>
</li><li data-nav-id=/1/8/ title=08_事务到底是隔离的还是不隔离的？ class=dd-item>
<a href=/1/8/>
08_事务到底是隔离的还是不隔离的？
</a>
</li><li data-nav-id=/1/9/ title=09_普通索引和唯一索引，应该怎么选择？ class=dd-item>
<a href=/1/9/>
09_普通索引和唯一索引，应该怎么选择？
</a>
</li><li data-nav-id=/1/10/ title=10_MySQL为什么有时候会选错索引？ class=dd-item>
<a href=/1/10/>
10_MySQL为什么有时候会选错索引？
</a>
</li><li data-nav-id=/1/11/ title=11_怎么给字符串字段加索引？ class=dd-item>
<a href=/1/11/>
11_怎么给字符串字段加索引？
</a>
</li><li data-nav-id=/1/12/ title=12_为什么我的MySQL会“抖”一下？ class=dd-item>
<a href=/1/12/>
12_为什么我的MySQL会“抖”一下？
</a>
</li><li data-nav-id=/1/13/ title=13_为什么表数据删掉一半，表文件大小不变？ class=dd-item>
<a href=/1/13/>
13_为什么表数据删掉一半，表文件大小不变？
</a>
</li><li data-nav-id=/1/14/ title=14_count(x)这么慢，我该怎么办？ class=dd-item>
<a href=/1/14/>
14_count(x)这么慢，我该怎么办？
</a>
</li><li data-nav-id=/1/15/ title=15_答疑文章（一）：日志和索引相关问题 class=dd-item>
<a href=/1/15/>
15_答疑文章（一）：日志和索引相关问题
</a>
</li><li data-nav-id=/1/16/ title=16_“orderby”是怎么工作的？ class=dd-item>
<a href=/1/16/>
16_“orderby”是怎么工作的？
</a>
</li><li data-nav-id=/1/17/ title=17_如何正确地显示随机消息？ class=dd-item>
<a href=/1/17/>
17_如何正确地显示随机消息？
</a>
</li><li data-nav-id=/1/18/ title=18_为什么这些SQL语句逻辑相同，性能却差异巨大？ class=dd-item>
<a href=/1/18/>
18_为什么这些SQL语句逻辑相同，性能却差异巨大？
</a>
</li><li data-nav-id=/1/19/ title=19_为什么我只查一行的语句，也执行这么慢？ class=dd-item>
<a href=/1/19/>
19_为什么我只查一行的语句，也执行这么慢？
</a>
</li><li data-nav-id=/1/20/ title=20_幻读是什么，幻读有什么问题？ class=dd-item>
<a href=/1/20/>
20_幻读是什么，幻读有什么问题？
</a>
</li><li data-nav-id=/1/21/ title=21_为什么我只改一行的语句，锁这么多？ class=dd-item>
<a href=/1/21/>
21_为什么我只改一行的语句，锁这么多？
</a>
</li><li data-nav-id=/1/22/ title=22_MySQL有哪些“饮鸩止渴”提高性能的方法？ class=dd-item>
<a href=/1/22/>
22_MySQL有哪些“饮鸩止渴”提高性能的方法？
</a>
</li><li data-nav-id=/1/23/ title=23_MySQL是怎么保证数据不丢的？ class=dd-item>
<a href=/1/23/>
23_MySQL是怎么保证数据不丢的？
</a>
</li><li data-nav-id=/1/24/ title=24_MySQL是怎么保证主备一致的？ class=dd-item>
<a href=/1/24/>
24_MySQL是怎么保证主备一致的？
</a>
</li><li data-nav-id=/1/25/ title=25_MySQL是怎么保证高可用的？ class=dd-item>
<a href=/1/25/>
25_MySQL是怎么保证高可用的？
</a>
</li><li data-nav-id=/1/26/ title=26_备库为什么会延迟好几个小时？ class=dd-item>
<a href=/1/26/>
26_备库为什么会延迟好几个小时？
</a>
</li><li data-nav-id=/1/27/ title=27_主库出问题了，从库怎么办？ class=dd-item>
<a href=/1/27/>
27_主库出问题了，从库怎么办？
</a>
</li><li data-nav-id=/1/28/ title=28_读写分离有哪些坑？ class=dd-item>
<a href=/1/28/>
28_读写分离有哪些坑？
</a>
</li><li data-nav-id=/1/29/ title=29_如何判断一个数据库是不是出问题了？ class=dd-item>
<a href=/1/29/>
29_如何判断一个数据库是不是出问题了？
</a>
</li><li data-nav-id=/1/30/ title=30_答疑文章（二）：用动态的观点看加锁 class=dd-item>
<a href=/1/30/>
30_答疑文章（二）：用动态的观点看加锁
</a>
</li><li data-nav-id=/1/31/ title=31_误删数据后除了跑路，还能怎么办？ class=dd-item>
<a href=/1/31/>
31_误删数据后除了跑路，还能怎么办？
</a>
</li><li data-nav-id=/1/32/ title=32_为什么还有kill不掉的语句？ class=dd-item>
<a href=/1/32/>
32_为什么还有kill不掉的语句？
</a>
</li><li data-nav-id=/1/33/ title=33_我查这么多数据，会不会把数据库内存打爆？ class=dd-item>
<a href=/1/33/>
33_我查这么多数据，会不会把数据库内存打爆？
</a>
</li><li data-nav-id=/1/34/ title=34_到底可不可以使用join？ class=dd-item>
<a href=/1/34/>
34_到底可不可以使用join？
</a>
</li><li data-nav-id=/1/35/ title=35_join语句怎么优化？ class=dd-item>
<a href=/1/35/>
35_join语句怎么优化？
</a>
</li><li data-nav-id=/1/36/ title=36_为什么临时表可以重名？ class=dd-item>
<a href=/1/36/>
36_为什么临时表可以重名？
</a>
</li><li data-nav-id=/1/37/ title=37_什么时候会使用内部临时表？ class=dd-item>
<a href=/1/37/>
37_什么时候会使用内部临时表？
</a>
</li><li data-nav-id=/1/38/ title=38_都说InnoDB好，那还要不要使用Memory引擎？ class=dd-item>
<a href=/1/38/>
38_都说InnoDB好，那还要不要使用Memory引擎？
</a>
</li><li data-nav-id=/1/39/ title=39_自增主键为什么不是连续的？ class=dd-item>
<a href=/1/39/>
39_自增主键为什么不是连续的？
</a>
</li><li data-nav-id=/1/40/ title=40_insert语句的锁为什么这么多？ class=dd-item>
<a href=/1/40/>
40_insert语句的锁为什么这么多？
</a>
</li><li data-nav-id=/1/41/ title=41_怎么最快地复制一张表？ class=dd-item>
<a href=/1/41/>
41_怎么最快地复制一张表？
</a>
</li><li data-nav-id=/1/42/ title=42_grant之后要跟着flushprivileges吗？ class=dd-item>
<a href=/1/42/>
42_grant之后要跟着flushprivileges吗？
</a>
</li><li data-nav-id=/1/43/ title=43_要不要使用分区表？ class=dd-item>
<a href=/1/43/>
43_要不要使用分区表？
</a>
</li><li data-nav-id=/1/44/ title=44_答疑文章（三）：说一说这些好问题 class=dd-item>
<a href=/1/44/>
44_答疑文章（三）：说一说这些好问题
</a>
</li><li data-nav-id=/1/45/ title=45_自增id用完怎么办？ class=dd-item>
<a href=/1/45/>
45_自增id用完怎么办？
</a>
</li><li data-nav-id=/1/47/ title=开篇词_这一次，让我们一起来搞懂MySQL class=dd-item>
<a href=/1/47/>
开篇词_这一次，让我们一起来搞懂MySQL
</a>
</li><li data-nav-id=/1/48/ title=直播回顾_林晓斌：我的MySQL心路历程 class=dd-item>
<a href=/1/48/>
直播回顾_林晓斌：我的MySQL心路历程
</a>
</li><li data-nav-id=/1/46/ title=结束语_点线网面，一起构建MySQL知识网络 class=dd-item>
<a href=/1/46/>
结束语_点线网面，一起构建MySQL知识网络
</a>
</li><li data-nav-id=/1/49/ title=结课测试｜这些MySQL知识你都掌握了吗？ class=dd-item>
<a href=/1/49/>
结课测试｜这些MySQL知识你都掌握了吗？
</a>
</li></ul></li><li data-nav-id=/3/ title=手把手带你写一门编程语言 class="dd-item
parent">
<a href=/3/>
手把手带你写一门编程语言
</a>
<ul>
<li data-nav-id=/3/3/ title=01｜实现一门超简单的语言最快需要多久？ class=dd-item>
<a href=/3/3/>
01｜实现一门超简单的语言最快需要多久？
</a>
</li><li data-nav-id=/3/4/ title=02｜词法分析：识别Token也可以很简单吗？ class=dd-item>
<a href=/3/4/>
02｜词法分析：识别Token也可以很简单吗？
</a>
</li><li data-nav-id=/3/5/ title=03｜支持表达式：解析表达式和解析语句有什么不同？ class=dd-item>
<a href=/3/5/>
03｜支持表达式：解析表达式和解析语句有什么不同？
</a>
</li><li data-nav-id=/3/6/ title=04｜如何让我们的语言支持变量和类型？ class=dd-item>
<a href=/3/6/>
04｜如何让我们的语言支持变量和类型？
</a>
</li><li data-nav-id=/3/7/ title=05｜函数实现：是时候让我们的语言支持函数和返回值了 class=dd-item>
<a href=/3/7/>
05｜函数实现：是时候让我们的语言支持函数和返回值了
</a>
</li><li data-nav-id=/3/8/ title=06｜怎么支持条件语句和循环语句？ class=dd-item>
<a href=/3/8/>
06｜怎么支持条件语句和循环语句？
</a>
</li><li data-nav-id=/3/9/ title=07｜怎么设计属于我们自己的虚拟机和字节码？ class=dd-item>
<a href=/3/9/>
07｜怎么设计属于我们自己的虚拟机和字节码？
</a>
</li><li data-nav-id=/3/10/ title=08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机 class="dd-item active">
<a href=/3/10/>
08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机
</a>
</li><li data-nav-id=/3/11/ title=09｜基于TypeScript的虚拟机（二）：丰富特性，支持跳转语句 class=dd-item>
<a href=/3/11/>
09｜基于TypeScript的虚拟机（二）：丰富特性，支持跳转语句
</a>
</li><li data-nav-id=/3/12/ title=10｜基于C语言的虚拟机（一）：实现一个简单的栈机 class=dd-item>
<a href=/3/12/>
10｜基于C语言的虚拟机（一）：实现一个简单的栈机
</a>
</li><li data-nav-id=/3/13/ title=11｜基于C语言的虚拟机（二）：性能增长10倍的秘密 class=dd-item>
<a href=/3/13/>
11｜基于C语言的虚拟机（二）：性能增长10倍的秘密
</a>
</li><li data-nav-id=/3/14/ title=12｜物理机上程序运行的硬件环境是怎么样的？ class=dd-item>
<a href=/3/14/>
12｜物理机上程序运行的硬件环境是怎么样的？
</a>
</li><li data-nav-id=/3/15/ title=13｜物理机上程序运行的软件环境是怎么样的？ class=dd-item>
<a href=/3/15/>
13｜物理机上程序运行的软件环境是怎么样的？
</a>
</li><li data-nav-id=/3/16/ title=14｜汇编代码学习（一）：熟悉CPU架构和指令集 class=dd-item>
<a href=/3/16/>
14｜汇编代码学习（一）：熟悉CPU架构和指令集
</a>
</li><li data-nav-id=/3/17/ title=15｜汇编语言学习（二）：熟悉X86汇编代码 class=dd-item>
<a href=/3/17/>
15｜汇编语言学习（二）：熟悉X86汇编代码
</a>
</li><li data-nav-id=/3/18/ title=16｜生成本地代码第1关：先把基础搭好 class=dd-item>
<a href=/3/18/>
16｜生成本地代码第1关：先把基础搭好
</a>
</li><li data-nav-id=/3/19/ title=17｜生成本地代码第2关：变量存储、函数调用和栈帧维护 class=dd-item>
<a href=/3/19/>
17｜生成本地代码第2关：变量存储、函数调用和栈帧维护
</a>
</li><li data-nav-id=/3/20/ title=18｜生成本地代码第3关：实现完整的功能 class=dd-item>
<a href=/3/20/>
18｜生成本地代码第3关：实现完整的功能
</a>
</li><li data-nav-id=/3/21/ title=19｜怎么实现一个更好的寄存器分配算法：原理篇 class=dd-item>
<a href=/3/21/>
19｜怎么实现一个更好的寄存器分配算法：原理篇
</a>
</li><li data-nav-id=/3/22/ title=20｜怎么实现一个更好的寄存器分配算法：实现篇 class=dd-item>
<a href=/3/22/>
20｜怎么实现一个更好的寄存器分配算法：实现篇
</a>
</li><li data-nav-id=/3/23/ title=21｜加深对栈的理解：实现尾递归和尾调用优化 class=dd-item>
<a href=/3/23/>
21｜加深对栈的理解：实现尾递归和尾调用优化
</a>
</li><li data-nav-id=/3/24/ title=22｜增强编译器前端功能第1步：再识数据流分析技术 class=dd-item>
<a href=/3/24/>
22｜增强编译器前端功能第1步：再识数据流分析技术
</a>
</li><li data-nav-id=/3/25/ title=23｜增强编译器前端功能第2步：增强类型体系 class=dd-item>
<a href=/3/25/>
23｜增强编译器前端功能第2步：增强类型体系
</a>
</li><li data-nav-id=/3/26/ title=24｜增强编译器前端功能第3步：全面的集合运算 class=dd-item>
<a href=/3/26/>
24｜增强编译器前端功能第3步：全面的集合运算
</a>
</li><li data-nav-id=/3/27/ title=25｜增强编译器前端功能第4步：综合运用多种语义分析技术 class=dd-item>
<a href=/3/27/>
25｜增强编译器前端功能第4步：综合运用多种语义分析技术
</a>
</li><li data-nav-id=/3/28/ title=26｜增强更丰富的类型第1步：如何支持浮点数？ class=dd-item>
<a href=/3/28/>
26｜增强更丰富的类型第1步：如何支持浮点数？
</a>
</li><li data-nav-id=/3/29/ title=27｜增加更丰富的类型第2步：如何支持字符串？ class=dd-item>
<a href=/3/29/>
27｜增加更丰富的类型第2步：如何支持字符串？
</a>
</li><li data-nav-id=/3/30/ title=28｜增加更丰富的类型第3步：支持数组 class=dd-item>
<a href=/3/30/>
28｜增加更丰富的类型第3步：支持数组
</a>
</li><li data-nav-id=/3/31/ title=29｜面向对象编程第1步：先把基础搭好 class=dd-item>
<a href=/3/31/>
29｜面向对象编程第1步：先把基础搭好
</a>
</li><li data-nav-id=/3/32/ title=30｜面向对象编程第2步：剖析一些技术细节 class=dd-item>
<a href=/3/32/>
30｜面向对象编程第2步：剖析一些技术细节
</a>
</li><li data-nav-id=/3/33/ title=31｜面向对象编程第3步：支持继承和多态 class=dd-item>
<a href=/3/33/>
31｜面向对象编程第3步：支持继承和多态
</a>
</li><li data-nav-id=/3/34/ title=32｜函数式编程第1关：实现高阶函数 class=dd-item>
<a href=/3/34/>
32｜函数式编程第1关：实现高阶函数
</a>
</li><li data-nav-id=/3/35/ title=33｜函数式编程第2关：实现闭包特性 class=dd-item>
<a href=/3/35/>
33｜函数式编程第2关：实现闭包特性
</a>
</li><li data-nav-id=/3/36/ title=34｜内存管理第1关：Arena技术和元数据 class=dd-item>
<a href=/3/36/>
34｜内存管理第1关：Arena技术和元数据
</a>
</li><li data-nav-id=/3/37/ title=35｜内存管理第2关：实现垃圾回收 class=dd-item>
<a href=/3/37/>
35｜内存管理第2关：实现垃圾回收
</a>
</li><li data-nav-id=/3/38/ title=36｜节点之海：怎么生成基于图的IR？ class=dd-item>
<a href=/3/38/>
36｜节点之海：怎么生成基于图的IR？
</a>
</li><li data-nav-id=/3/39/ title=37_从AST到IR：体会数据流和控制流思维 class=dd-item>
<a href=/3/39/>
37_从AST到IR：体会数据流和控制流思维
</a>
</li><li data-nav-id=/3/40/ title=38｜中端优化第1关：实现多种本地优化 class=dd-item>
<a href=/3/40/>
38｜中端优化第1关：实现多种本地优化
</a>
</li><li data-nav-id=/3/41/ title=39｜中端优化第2关：全局优化要怎么搞？ class=dd-item>
<a href=/3/41/>
39｜中端优化第2关：全局优化要怎么搞？
</a>
</li><li data-nav-id=/3/42/ title=40｜中端优化第3关：一起来挑战过程间优化 class=dd-item>
<a href=/3/42/>
40｜中端优化第3关：一起来挑战过程间优化
</a>
</li><li data-nav-id=/3/43/ title=41｜后端优化：生成LIR和指令选择 class=dd-item>
<a href=/3/43/>
41｜后端优化：生成LIR和指令选择
</a>
</li><li data-nav-id=/3/44/ title=42｜到这里，我们的收获和未尽的工作有哪些？ class=dd-item>
<a href=/3/44/>
42｜到这里，我们的收获和未尽的工作有哪些？
</a>
</li><li data-nav-id=/3/1/ title=“他山之石”｜Sugar：这门课你可以试试这么学 class=dd-item>
<a href=/3/1/>
“他山之石”｜Sugar：这门课你可以试试这么学
</a>
</li><li data-nav-id=/3/2/ title=“屠龙之秘”｜实现计算机语言这样的技术能用在哪里？（一） class=dd-item>
<a href=/3/2/>
“屠龙之秘”｜实现计算机语言这样的技术能用在哪里？（一）
</a>
</li><li data-nav-id=/3/46/ title=开篇词｜让我们来写一门计算机语言吧 class=dd-item>
<a href=/3/46/>
开篇词｜让我们来写一门计算机语言吧
</a>
</li><li data-nav-id=/3/49/ title=期中测试｜快来检验你在起步篇的学习成果吧 class=dd-item>
<a href=/3/49/>
期中测试｜快来检验你在起步篇的学习成果吧
</a>
</li><li data-nav-id=/3/48/ title=期末考试｜实现编程语言这些核心知识点，你掌握得咋样了？ class=dd-item>
<a href=/3/48/>
期末考试｜实现编程语言这些核心知识点，你掌握得咋样了？
</a>
</li><li data-nav-id=/3/45/ title=结束语｜等待你大展身手的那些领域 class=dd-item>
<a href=/3/45/>
结束语｜等待你大展身手的那些领域
</a>
</li><li data-nav-id=/3/47/ title=课前热身｜开始学习之前我们要准备什么？ class=dd-item>
<a href=/3/47/>
课前热身｜开始学习之前我们要准备什么？
</a>
</li></ul></li><li data-nav-id=/2/ title=数据结构与算法之美 class=dd-item>
<a href=/2/>
数据结构与算法之美
</a>
<ul>
<li data-nav-id=/2/2/ title=01_为什么要学习数据结构和算法？ class=dd-item>
<a href=/2/2/>
01_为什么要学习数据结构和算法？
</a>
</li><li data-nav-id=/2/3/ title=02_如何抓住重点，系统高效地学习数据结构与算法？ class=dd-item>
<a href=/2/3/>
02_如何抓住重点，系统高效地学习数据结构与算法？
</a>
</li><li data-nav-id=/2/4/ title=03_复杂度分析（上）：如何分析、统计算法的执行效率和资源消耗？ class=dd-item>
<a href=/2/4/>
03_复杂度分析（上）：如何分析、统计算法的执行效率和资源消耗？
</a>
</li><li data-nav-id=/2/5/ title=04_复杂度分析（下）：浅析最好、最坏、平均、均摊时间复杂度 class=dd-item>
<a href=/2/5/>
04_复杂度分析（下）：浅析最好、最坏、平均、均摊时间复杂度
</a>
</li><li data-nav-id=/2/6/ title=05_数组：为什么很多编程语言中数组都从0开始编号？ class=dd-item>
<a href=/2/6/>
05_数组：为什么很多编程语言中数组都从0开始编号？
</a>
</li><li data-nav-id=/2/7/ title=06_链表（上）：如何实现LRU缓存淘汰算法 class=dd-item>
<a href=/2/7/>
06_链表（上）：如何实现LRU缓存淘汰算法
</a>
</li><li data-nav-id=/2/8/ title=07_链表（下）：如何轻松写出正确的链表代码？ class=dd-item>
<a href=/2/8/>
07_链表（下）：如何轻松写出正确的链表代码？
</a>
</li><li data-nav-id=/2/9/ title=08_栈：如何实现浏览器的前进和后退功能？ class=dd-item>
<a href=/2/9/>
08_栈：如何实现浏览器的前进和后退功能？
</a>
</li><li data-nav-id=/2/10/ title=09_队列：队列在线程池等有限资源池中的应用 class=dd-item>
<a href=/2/10/>
09_队列：队列在线程池等有限资源池中的应用
</a>
</li><li data-nav-id=/2/11/ title=10_递归：如何用三行代码找到“最终推荐人”？ class=dd-item>
<a href=/2/11/>
10_递归：如何用三行代码找到“最终推荐人”？
</a>
</li><li data-nav-id=/2/12/ title=11_排序（上）：为什么插入排序比冒泡排序更受欢迎？ class=dd-item>
<a href=/2/12/>
11_排序（上）：为什么插入排序比冒泡排序更受欢迎？
</a>
</li><li data-nav-id=/2/13/ title=12_排序（下）：如何用快排思想在O(n)内查找第K大元素？ class=dd-item>
<a href=/2/13/>
12_排序（下）：如何用快排思想在O(n)内查找第K大元素？
</a>
</li><li data-nav-id=/2/14/ title=13_线性排序：如何根据年龄给100万用户数据排序？ class=dd-item>
<a href=/2/14/>
13_线性排序：如何根据年龄给100万用户数据排序？
</a>
</li><li data-nav-id=/2/15/ title=14_排序优化：如何实现一个通用的、高性能的排序函数？ class=dd-item>
<a href=/2/15/>
14_排序优化：如何实现一个通用的、高性能的排序函数？
</a>
</li><li data-nav-id=/2/16/ title=15_二分查找（上）：如何用最省内存的方式实现快速查找功能？ class=dd-item>
<a href=/2/16/>
15_二分查找（上）：如何用最省内存的方式实现快速查找功能？
</a>
</li><li data-nav-id=/2/17/ title=16_二分查找（下）：如何快速定位IP对应的省份地址？ class=dd-item>
<a href=/2/17/>
16_二分查找（下）：如何快速定位IP对应的省份地址？
</a>
</li><li data-nav-id=/2/18/ title=17_跳表：为什么Redis一定要用跳表来实现有序集合？ class=dd-item>
<a href=/2/18/>
17_跳表：为什么Redis一定要用跳表来实现有序集合？
</a>
</li><li data-nav-id=/2/19/ title=18_散列表（上）：Word文档中的单词拼写检查功能是如何实现的？ class=dd-item>
<a href=/2/19/>
18_散列表（上）：Word文档中的单词拼写检查功能是如何实现的？
</a>
</li><li data-nav-id=/2/20/ title=19_散列表（中）：如何打造一个工业级水平的散列表？ class=dd-item>
<a href=/2/20/>
19_散列表（中）：如何打造一个工业级水平的散列表？
</a>
</li><li data-nav-id=/2/21/ title=20_散列表（下）：为什么散列表和链表经常会一起使用？ class=dd-item>
<a href=/2/21/>
20_散列表（下）：为什么散列表和链表经常会一起使用？
</a>
</li><li data-nav-id=/2/22/ title=21_哈希算法（上）：如何防止数据库中的用户信息被脱库？ class=dd-item>
<a href=/2/22/>
21_哈希算法（上）：如何防止数据库中的用户信息被脱库？
</a>
</li><li data-nav-id=/2/23/ title=22_哈希算法（下）：哈希算法在分布式系统中有哪些应用？ class=dd-item>
<a href=/2/23/>
22_哈希算法（下）：哈希算法在分布式系统中有哪些应用？
</a>
</li><li data-nav-id=/2/24/ title=23_二叉树基础（上）：什么样的二叉树适合用数组来存储？ class=dd-item>
<a href=/2/24/>
23_二叉树基础（上）：什么样的二叉树适合用数组来存储？
</a>
</li><li data-nav-id=/2/25/ title=24_二叉树基础（下）：有了如此高效的散列表，为什么还需要二叉树？ class=dd-item>
<a href=/2/25/>
24_二叉树基础（下）：有了如此高效的散列表，为什么还需要二叉树？
</a>
</li><li data-nav-id=/2/26/ title=25_红黑树（上）：为什么工程中都用红黑树这种二叉树？ class=dd-item>
<a href=/2/26/>
25_红黑树（上）：为什么工程中都用红黑树这种二叉树？
</a>
</li><li data-nav-id=/2/27/ title=26_红黑树（下）：掌握这些技巧，你也可以实现一个红黑树 class=dd-item>
<a href=/2/27/>
26_红黑树（下）：掌握这些技巧，你也可以实现一个红黑树
</a>
</li><li data-nav-id=/2/28/ title=27_递归树：如何借助树来求解递归算法的时间复杂度？ class=dd-item>
<a href=/2/28/>
27_递归树：如何借助树来求解递归算法的时间复杂度？
</a>
</li><li data-nav-id=/2/29/ title=28_堆和堆排序：为什么说堆排序没有快速排序快？ class=dd-item>
<a href=/2/29/>
28_堆和堆排序：为什么说堆排序没有快速排序快？
</a>
</li><li data-nav-id=/2/30/ title=29_堆的应用：如何快速获取到Top10最热门的搜索关键词？ class=dd-item>
<a href=/2/30/>
29_堆的应用：如何快速获取到Top10最热门的搜索关键词？
</a>
</li><li data-nav-id=/2/31/ title=30_图的表示：如何存储微博、微信等社交网络中的好友关系？ class=dd-item>
<a href=/2/31/>
30_图的表示：如何存储微博、微信等社交网络中的好友关系？
</a>
</li><li data-nav-id=/2/32/ title=31_深度和广度优先搜索：如何找出社交网络中的三度好友关系？ class=dd-item>
<a href=/2/32/>
31_深度和广度优先搜索：如何找出社交网络中的三度好友关系？
</a>
</li><li data-nav-id=/2/33/ title=32_字符串匹配基础（上）：如何借助哈希算法实现高效字符串匹配？ class=dd-item>
<a href=/2/33/>
32_字符串匹配基础（上）：如何借助哈希算法实现高效字符串匹配？
</a>
</li><li data-nav-id=/2/34/ title=33_字符串匹配基础（中）：如何实现文本编辑器中的查找功能？ class=dd-item>
<a href=/2/34/>
33_字符串匹配基础（中）：如何实现文本编辑器中的查找功能？
</a>
</li><li data-nav-id=/2/35/ title=34_字符串匹配基础（下）：如何借助BM算法轻松理解KMP算法？ class=dd-item>
<a href=/2/35/>
34_字符串匹配基础（下）：如何借助BM算法轻松理解KMP算法？
</a>
</li><li data-nav-id=/2/36/ title=35_Trie树：如何实现搜索引擎的搜索关键词提示功能？ class=dd-item>
<a href=/2/36/>
35_Trie树：如何实现搜索引擎的搜索关键词提示功能？
</a>
</li><li data-nav-id=/2/37/ title=36_AC自动机：如何用多模式串匹配实现敏感词过滤功能？ class=dd-item>
<a href=/2/37/>
36_AC自动机：如何用多模式串匹配实现敏感词过滤功能？
</a>
</li><li data-nav-id=/2/38/ title=37_贪心算法：如何用贪心算法实现Huffman压缩编码？ class=dd-item>
<a href=/2/38/>
37_贪心算法：如何用贪心算法实现Huffman压缩编码？
</a>
</li><li data-nav-id=/2/39/ title=38_分治算法：谈一谈大规模计算框架MapReduce中的分治思想 class=dd-item>
<a href=/2/39/>
38_分治算法：谈一谈大规模计算框架MapReduce中的分治思想
</a>
</li><li data-nav-id=/2/40/ title=39_回溯算法：从电影《蝴蝶效应》中学习回溯算法的核心思想 class=dd-item>
<a href=/2/40/>
39_回溯算法：从电影《蝴蝶效应》中学习回溯算法的核心思想
</a>
</li><li data-nav-id=/2/41/ title=40_初识动态规划：如何巧妙解决“双十一”购物时的凑单问题？ class=dd-item>
<a href=/2/41/>
40_初识动态规划：如何巧妙解决“双十一”购物时的凑单问题？
</a>
</li><li data-nav-id=/2/42/ title=41_动态规划理论：一篇文章带你彻底搞懂最优子结构、无后效性和重复子问题 class=dd-item>
<a href=/2/42/>
41_动态规划理论：一篇文章带你彻底搞懂最优子结构、无后效性和重复子问题
</a>
</li><li data-nav-id=/2/43/ title=42_动态规划实战：如何实现搜索引擎中的拼写纠错功能？ class=dd-item>
<a href=/2/43/>
42_动态规划实战：如何实现搜索引擎中的拼写纠错功能？
</a>
</li><li data-nav-id=/2/44/ title=43_拓扑排序：如何确定代码源文件的编译依赖关系？ class=dd-item>
<a href=/2/44/>
43_拓扑排序：如何确定代码源文件的编译依赖关系？
</a>
</li><li data-nav-id=/2/45/ title=44_最短路径：地图软件是如何计算出最优出行路径的？ class=dd-item>
<a href=/2/45/>
44_最短路径：地图软件是如何计算出最优出行路径的？
</a>
</li><li data-nav-id=/2/46/ title=45_位图：如何实现网页爬虫中的URL去重功能？ class=dd-item>
<a href=/2/46/>
45_位图：如何实现网页爬虫中的URL去重功能？
</a>
</li><li data-nav-id=/2/47/ title=46_概率统计：如何利用朴素贝叶斯算法过滤垃圾短信？ class=dd-item>
<a href=/2/47/>
46_概率统计：如何利用朴素贝叶斯算法过滤垃圾短信？
</a>
</li><li data-nav-id=/2/48/ title=47_向量空间：如何实现一个简单的音乐推荐系统？ class=dd-item>
<a href=/2/48/>
47_向量空间：如何实现一个简单的音乐推荐系统？
</a>
</li><li data-nav-id=/2/49/ title=48_B+树：MySQL数据库索引是如何实现的？ class=dd-item>
<a href=/2/49/>
48_B+树：MySQL数据库索引是如何实现的？
</a>
</li><li data-nav-id=/2/50/ title=49_搜索：如何用Ax搜索算法实现游戏中的寻路功能？ class=dd-item>
<a href=/2/50/>
49_搜索：如何用Ax搜索算法实现游戏中的寻路功能？
</a>
</li><li data-nav-id=/2/51/ title=50_索引：如何在海量数据中快速查找某个数据？ class=dd-item>
<a href=/2/51/>
50_索引：如何在海量数据中快速查找某个数据？
</a>
</li><li data-nav-id=/2/52/ title=51_并行算法：如何利用并行处理提高算法的执行效率？ class=dd-item>
<a href=/2/52/>
51_并行算法：如何利用并行处理提高算法的执行效率？
</a>
</li><li data-nav-id=/2/53/ title=52_算法实战（一）：剖析Redis常用数据类型对应的数据结构 class=dd-item>
<a href=/2/53/>
52_算法实战（一）：剖析Redis常用数据类型对应的数据结构
</a>
</li><li data-nav-id=/2/54/ title=53_算法实战（二）：剖析搜索引擎背后的经典数据结构和算法 class=dd-item>
<a href=/2/54/>
53_算法实战（二）：剖析搜索引擎背后的经典数据结构和算法
</a>
</li><li data-nav-id=/2/55/ title=54_算法实战（三）：剖析高性能队列Disruptor背后的数据结构和算法 class=dd-item>
<a href=/2/55/>
54_算法实战（三）：剖析高性能队列Disruptor背后的数据结构和算法
</a>
</li><li data-nav-id=/2/56/ title=55_算法实战（四）：剖析微服务接口鉴权限流背后的数据结构和算法 class=dd-item>
<a href=/2/56/>
55_算法实战（四）：剖析微服务接口鉴权限流背后的数据结构和算法
</a>
</li><li data-nav-id=/2/57/ title=56_算法实战（五）：如何用学过的数据结构和算法实现一个短网址系统？ class=dd-item>
<a href=/2/57/>
56_算法实战（五）：如何用学过的数据结构和算法实现一个短网址系统？
</a>
</li><li data-nav-id=/2/1/ title=《数据结构与算法之美》学习指导手册 class=dd-item>
<a href=/2/1/>
《数据结构与算法之美》学习指导手册
</a>
</li><li data-nav-id=/2/61/ title=不定期福利第一期_数据结构与算法学习书单 class=dd-item>
<a href=/2/61/>
不定期福利第一期_数据结构与算法学习书单
</a>
</li><li data-nav-id=/2/59/ title=不定期福利第三期_测一测你的算法阶段学习成果 class=dd-item>
<a href=/2/59/>
不定期福利第三期_测一测你的算法阶段学习成果
</a>
</li><li data-nav-id=/2/58/ title=不定期福利第二期_王争：羁绊前行的，不是肆虐的狂风，而是内心的迷茫 class=dd-item>
<a href=/2/58/>
不定期福利第二期_王争：羁绊前行的，不是肆虐的狂风，而是内心的迷茫
</a>
</li><li data-nav-id=/2/60/ title=不定期福利第四期_刘超：我是怎么学习《数据结构与算法之美》的？ class=dd-item>
<a href=/2/60/>
不定期福利第四期_刘超：我是怎么学习《数据结构与算法之美》的？
</a>
</li><li data-nav-id=/2/77/ title=开篇词_从今天起，跨过“数据结构与算法”这道坎 class=dd-item>
<a href=/2/77/>
开篇词_从今天起，跨过“数据结构与算法”这道坎
</a>
</li><li data-nav-id=/2/81/ title=总结课_在实际开发中，如何权衡选择使用哪种数据结构和算法？ class=dd-item>
<a href=/2/81/>
总结课_在实际开发中，如何权衡选择使用哪种数据结构和算法？
</a>
</li><li data-nav-id=/2/69/ title=打卡召集令_60天攻克数据结构与算法 class=dd-item>
<a href=/2/69/>
打卡召集令_60天攻克数据结构与算法
</a>
</li><li data-nav-id=/2/73/ title=打卡召集令_第一阶段知识总结 class=dd-item>
<a href=/2/73/>
打卡召集令_第一阶段知识总结
</a>
</li><li data-nav-id=/2/71/ title=打卡召集令_第三阶段知识总结 class=dd-item>
<a href=/2/71/>
打卡召集令_第三阶段知识总结
</a>
</li><li data-nav-id=/2/70/ title=打卡召集令_第二阶段知识总结 class=dd-item>
<a href=/2/70/>
打卡召集令_第二阶段知识总结
</a>
</li><li data-nav-id=/2/72/ title=打卡召集令_第四阶段知识总结 class=dd-item>
<a href=/2/72/>
打卡召集令_第四阶段知识总结
</a>
</li><li data-nav-id=/2/62/ title=春节7天练_Day1：数组和链表 class=dd-item>
<a href=/2/62/>
春节7天练_Day1：数组和链表
</a>
</li><li data-nav-id=/2/63/ title=春节7天练_Day2：栈、队列和递归 class=dd-item>
<a href=/2/63/>
春节7天练_Day2：栈、队列和递归
</a>
</li><li data-nav-id=/2/64/ title=春节7天练_Day3：排序和二分查找 class=dd-item>
<a href=/2/64/>
春节7天练_Day3：排序和二分查找
</a>
</li><li data-nav-id=/2/65/ title=春节7天练_Day4：散列表和字符串 class=dd-item>
<a href=/2/65/>
春节7天练_Day4：散列表和字符串
</a>
</li><li data-nav-id=/2/66/ title=春节7天练_Day5：二叉树和堆 class=dd-item>
<a href=/2/66/>
春节7天练_Day5：二叉树和堆
</a>
</li><li data-nav-id=/2/67/ title=春节7天练_Day6：图 class=dd-item>
<a href=/2/67/>
春节7天练_Day6：图
</a>
</li><li data-nav-id=/2/68/ title=春节7天练_Day7：贪心、分治、回溯和动态规划 class=dd-item>
<a href=/2/68/>
春节7天练_Day7：贪心、分治、回溯和动态规划
</a>
</li><li data-nav-id=/2/79/ title=用户故事_Jerry银银：这一年我的脑海里只有算法 class=dd-item>
<a href=/2/79/>
用户故事_Jerry银银：这一年我的脑海里只有算法
</a>
</li><li data-nav-id=/2/80/ title=用户故事_zixuan：站在思维的高处，才有足够的视野和能力欣赏“美” class=dd-item>
<a href=/2/80/>
用户故事_zixuan：站在思维的高处，才有足够的视野和能力欣赏“美”
</a>
</li><li data-nav-id=/2/74/ title=第2季回归_这一次，我们一起拿下设计模式！ class=dd-item>
<a href=/2/74/>
第2季回归_这一次，我们一起拿下设计模式！
</a>
</li><li data-nav-id=/2/76/ title=结束语_送君千里，终须一别 class=dd-item>
<a href=/2/76/>
结束语_送君千里，终须一别
</a>
</li><li data-nav-id=/2/75/ title=结课测试｜这些数据结构与算法，你真的掌握了吗？ class=dd-item>
<a href=/2/75/>
结课测试｜这些数据结构与算法，你真的掌握了吗？
</a>
</li><li data-nav-id=/2/78/ title=课程迭代｜全新交付71讲音频 class=dd-item>
<a href=/2/78/>
课程迭代｜全新交付71讲音频
</a>
</li></ul></li><li data-nav-id=/4/ title=深入浅出计算机组成原理 class=dd-item>
<a href=/4/>
深入浅出计算机组成原理
</a>
<ul>
<li data-nav-id=/4/1/ title=01_冯·诺依曼体系结构：计算机组成的金字塔 class=dd-item>
<a href=/4/1/>
01_冯·诺依曼体系结构：计算机组成的金字塔
</a>
</li><li data-nav-id=/4/2/ title=02_给你一张知识地图，计算机组成原理应该这么学 class=dd-item>
<a href=/4/2/>
02_给你一张知识地图，计算机组成原理应该这么学
</a>
</li><li data-nav-id=/4/3/ title=03_通过你的CPU主频，我们来谈谈“性能”究竟是什么？ class=dd-item>
<a href=/4/3/>
03_通过你的CPU主频，我们来谈谈“性能”究竟是什么？
</a>
</li><li data-nav-id=/4/4/ title=04_穿越功耗墙，我们该从哪些方面提升“性能”？ class=dd-item>
<a href=/4/4/>
04_穿越功耗墙，我们该从哪些方面提升“性能”？
</a>
</li><li data-nav-id=/4/5/ title=05_计算机指令：让我们试试用纸带编程 class=dd-item>
<a href=/4/5/>
05_计算机指令：让我们试试用纸带编程
</a>
</li><li data-nav-id=/4/6/ title=06_指令跳转：原来if...else就是goto class=dd-item>
<a href=/4/6/>
06_指令跳转：原来if...else就是goto
</a>
</li><li data-nav-id=/4/7/ title=07_函数调用：为什么会发生stackoverflow？ class=dd-item>
<a href=/4/7/>
07_函数调用：为什么会发生stackoverflow？
</a>
</li><li data-nav-id=/4/8/ title=08_ELF和静态链接：为什么程序无法同时在Linux和Windows下运行？ class=dd-item>
<a href=/4/8/>
08_ELF和静态链接：为什么程序无法同时在Linux和Windows下运行？
</a>
</li><li data-nav-id=/4/9/ title=09_程序装载：“640K内存”真的不够用么？ class=dd-item>
<a href=/4/9/>
09_程序装载：“640K内存”真的不够用么？
</a>
</li><li data-nav-id=/4/10/ title=10_动态链接：程序内部的“共享单车” class=dd-item>
<a href=/4/10/>
10_动态链接：程序内部的“共享单车”
</a>
</li><li data-nav-id=/4/11/ title=11_二进制编码：“手持两把锟斤拷，口中疾呼烫烫烫”？ class=dd-item>
<a href=/4/11/>
11_二进制编码：“手持两把锟斤拷，口中疾呼烫烫烫”？
</a>
</li><li data-nav-id=/4/12/ title=12_理解电路：从电报机到门电路，我们如何做到“千里传信”？ class=dd-item>
<a href=/4/12/>
12_理解电路：从电报机到门电路，我们如何做到“千里传信”？
</a>
</li><li data-nav-id=/4/13/ title=13_加法器：如何像搭乐高一样搭电路（上）？ class=dd-item>
<a href=/4/13/>
13_加法器：如何像搭乐高一样搭电路（上）？
</a>
</li><li data-nav-id=/4/14/ title=14_乘法器：如何像搭乐高一样搭电路（下）？ class=dd-item>
<a href=/4/14/>
14_乘法器：如何像搭乐高一样搭电路（下）？
</a>
</li><li data-nav-id=/4/15/ title=15_浮点数和定点数（上）：怎么用有限的Bit表示尽可能多的信息？ class=dd-item>
<a href=/4/15/>
15_浮点数和定点数（上）：怎么用有限的Bit表示尽可能多的信息？
</a>
</li><li data-nav-id=/4/16/ title=16_浮点数和定点数（下）：深入理解浮点数到底有什么用？ class=dd-item>
<a href=/4/16/>
16_浮点数和定点数（下）：深入理解浮点数到底有什么用？
</a>
</li><li data-nav-id=/4/17/ title="17_建立数据通路（上）：指令+运算=CPU" class=dd-item>
<a href=/4/17/>
17_建立数据通路（上）：指令+运算=CPU
</a>
</li><li data-nav-id=/4/18/ title="18_建立数据通路（中）：指令+运算=CPU" class=dd-item>
<a href=/4/18/>
18_建立数据通路（中）：指令+运算=CPU
</a>
</li><li data-nav-id=/4/19/ title="19_建立数据通路（下）：指令+运算=CPU" class=dd-item>
<a href=/4/19/>
19_建立数据通路（下）：指令+运算=CPU
</a>
</li><li data-nav-id=/4/20/ title=20_面向流水线的指令设计（上）：一心多用的现代CPU class=dd-item>
<a href=/4/20/>
20_面向流水线的指令设计（上）：一心多用的现代CPU
</a>
</li><li data-nav-id=/4/21/ title=21_面向流水线的指令设计（下）：奔腾4是怎么失败的？ class=dd-item>
<a href=/4/21/>
21_面向流水线的指令设计（下）：奔腾4是怎么失败的？
</a>
</li><li data-nav-id=/4/22/ title=22_冒险和预测（一）：hazard是“危”也是“机” class=dd-item>
<a href=/4/22/>
22_冒险和预测（一）：hazard是“危”也是“机”
</a>
</li><li data-nav-id=/4/23/ title=23_冒险和预测（二）：流水线里的接力赛 class=dd-item>
<a href=/4/23/>
23_冒险和预测（二）：流水线里的接力赛
</a>
</li><li data-nav-id=/4/24/ title=24_冒险和预测（三）：CPU里的“线程池” class=dd-item>
<a href=/4/24/>
24_冒险和预测（三）：CPU里的“线程池”
</a>
</li><li data-nav-id=/4/25/ title=25_冒险和预测（四）：今天下雨了，明天还会下雨么？ class=dd-item>
<a href=/4/25/>
25_冒险和预测（四）：今天下雨了，明天还会下雨么？
</a>
</li><li data-nav-id=/4/26/ title=26_Superscalar和VLIW：如何让CPU的吞吐率超过1？ class=dd-item>
<a href=/4/26/>
26_Superscalar和VLIW：如何让CPU的吞吐率超过1？
</a>
</li><li data-nav-id=/4/27/ title=27_SIMD：如何加速矩阵乘法？ class=dd-item>
<a href=/4/27/>
27_SIMD：如何加速矩阵乘法？
</a>
</li><li data-nav-id=/4/28/ title=28_异常和中断：程序出错了怎么办？ class=dd-item>
<a href=/4/28/>
28_异常和中断：程序出错了怎么办？
</a>
</li><li data-nav-id=/4/29/ title=29_CISC和RISC：为什么手机芯片都是ARM？ class=dd-item>
<a href=/4/29/>
29_CISC和RISC：为什么手机芯片都是ARM？
</a>
</li><li data-nav-id=/4/30/ title=30_GPU（上）：为什么玩游戏需要使用GPU？ class=dd-item>
<a href=/4/30/>
30_GPU（上）：为什么玩游戏需要使用GPU？
</a>
</li><li data-nav-id=/4/31/ title=31_GPU（下）：为什么深度学习需要使用GPU？ class=dd-item>
<a href=/4/31/>
31_GPU（下）：为什么深度学习需要使用GPU？
</a>
</li><li data-nav-id=/4/32/ title=32_FPGA和ASIC：计算机体系结构的黄金时代 class=dd-item>
<a href=/4/32/>
32_FPGA和ASIC：计算机体系结构的黄金时代
</a>
</li><li data-nav-id=/4/33/ title=33_解读TPU：设计和拆解一块ASIC芯片 class=dd-item>
<a href=/4/33/>
33_解读TPU：设计和拆解一块ASIC芯片
</a>
</li><li data-nav-id=/4/34/ title=34_理解虚拟机：你在云上拿到的计算机是什么样的？ class=dd-item>
<a href=/4/34/>
34_理解虚拟机：你在云上拿到的计算机是什么样的？
</a>
</li><li data-nav-id=/4/35/ title=35_存储器层次结构全景：数据存储的大金字塔长什么样？ class=dd-item>
<a href=/4/35/>
35_存储器层次结构全景：数据存储的大金字塔长什么样？
</a>
</li><li data-nav-id=/4/36/ title=36_局部性原理：数据库性能跟不上，加个缓存就好了？ class=dd-item>
<a href=/4/36/>
36_局部性原理：数据库性能跟不上，加个缓存就好了？
</a>
</li><li data-nav-id=/4/37/ title=37_高速缓存（上）：“4毫秒”究竟值多少钱？ class=dd-item>
<a href=/4/37/>
37_高速缓存（上）：“4毫秒”究竟值多少钱？
</a>
</li><li data-nav-id=/4/38/ title=38_高速缓存（下）：你确定你的数据更新了么？ class=dd-item>
<a href=/4/38/>
38_高速缓存（下）：你确定你的数据更新了么？
</a>
</li><li data-nav-id=/4/39/ title=39_MESI协议：如何让多核CPU的高速缓存保持一致？ class=dd-item>
<a href=/4/39/>
39_MESI协议：如何让多核CPU的高速缓存保持一致？
</a>
</li><li data-nav-id=/4/40/ title=40_理解内存（上）：虚拟内存和内存保护是什么？ class=dd-item>
<a href=/4/40/>
40_理解内存（上）：虚拟内存和内存保护是什么？
</a>
</li><li data-nav-id=/4/41/ title=41_理解内存（下）：解析TLB和内存保护 class=dd-item>
<a href=/4/41/>
41_理解内存（下）：解析TLB和内存保护
</a>
</li><li data-nav-id=/4/42/ title=42_总线：计算机内部的高速公路 class=dd-item>
<a href=/4/42/>
42_总线：计算机内部的高速公路
</a>
</li><li data-nav-id=/4/43/ title=43_输入输出设备：我们并不是只能用灯泡显示“0”和“1” class=dd-item>
<a href=/4/43/>
43_输入输出设备：我们并不是只能用灯泡显示“0”和“1”
</a>
</li><li data-nav-id=/4/44/ title=44_理解IO_WAIT：IO性能到底是怎么回事儿？ class=dd-item>
<a href=/4/44/>
44_理解IO_WAIT：IO性能到底是怎么回事儿？
</a>
</li><li data-nav-id=/4/45/ title=45_机械硬盘：Google早期用过的“黑科技” class=dd-item>
<a href=/4/45/>
45_机械硬盘：Google早期用过的“黑科技”
</a>
</li><li data-nav-id=/4/46/ title=46_SSD硬盘（上）：如何完成性能优化的KPI？ class=dd-item>
<a href=/4/46/>
46_SSD硬盘（上）：如何完成性能优化的KPI？
</a>
</li><li data-nav-id=/4/47/ title=47_SSD硬盘（下）：如何完成性能优化的KPI？ class=dd-item>
<a href=/4/47/>
47_SSD硬盘（下）：如何完成性能优化的KPI？
</a>
</li><li data-nav-id=/4/48/ title=48_DMA：为什么Kafka这么快？ class=dd-item>
<a href=/4/48/>
48_DMA：为什么Kafka这么快？
</a>
</li><li data-nav-id=/4/49/ title=49_数据完整性（上）：硬件坏了怎么办？ class=dd-item>
<a href=/4/49/>
49_数据完整性（上）：硬件坏了怎么办？
</a>
</li><li data-nav-id=/4/50/ title=50_数据完整性（下）：如何还原犯罪现场？ class=dd-item>
<a href=/4/50/>
50_数据完整性（下）：如何还原犯罪现场？
</a>
</li><li data-nav-id=/4/51/ title=51_分布式计算：如果所有人的大脑都联网会怎样？ class=dd-item>
<a href=/4/51/>
51_分布式计算：如果所有人的大脑都联网会怎样？
</a>
</li><li data-nav-id=/4/52/ title=52_设计大型DMP系统（上）：MongoDB并不是什么灵丹妙药 class=dd-item>
<a href=/4/52/>
52_设计大型DMP系统（上）：MongoDB并不是什么灵丹妙药
</a>
</li><li data-nav-id=/4/53/ title=53_设计大型DMP系统（下）：SSD拯救了所有的DBA class=dd-item>
<a href=/4/53/>
53_设计大型DMP系统（下）：SSD拯救了所有的DBA
</a>
</li><li data-nav-id=/4/54/ title=54_理解Disruptor（上）：带你体会CPU高速缓存的风驰电掣 class=dd-item>
<a href=/4/54/>
54_理解Disruptor（上）：带你体会CPU高速缓存的风驰电掣
</a>
</li><li data-nav-id=/4/55/ title=55_理解Disruptor（下）：不需要换挡和踩刹车的CPU，有多快？ class=dd-item>
<a href=/4/55/>
55_理解Disruptor（下）：不需要换挡和踩刹车的CPU，有多快？
</a>
</li><li data-nav-id=/4/57/ title=FAQ第一期_学与不学，知识就在那里，不如就先学好了 class=dd-item>
<a href=/4/57/>
FAQ第一期_学与不学，知识就在那里，不如就先学好了
</a>
</li><li data-nav-id=/4/56/ title=FAQ第二期_世界上第一个编程语言是怎么来的？ class=dd-item>
<a href=/4/56/>
FAQ第二期_世界上第一个编程语言是怎么来的？
</a>
</li><li data-nav-id=/4/59/ title=开篇词_为什么你需要学习计算机组成原理？ class=dd-item>
<a href=/4/59/>
开篇词_为什么你需要学习计算机组成原理？
</a>
</li><li data-nav-id=/4/61/ title=特别加餐_我在2019年F8大会的两日见闻录 class=dd-item>
<a href=/4/61/>
特别加餐_我在2019年F8大会的两日见闻录
</a>
</li><li data-nav-id=/4/60/ title=特别加餐_我的一天怎么过？ class=dd-item>
<a href=/4/60/>
特别加餐_我的一天怎么过？
</a>
</li><li data-nav-id=/4/62/ title=用户故事_赵文海：怕什么真理无穷，进一寸有一寸的欢喜 class=dd-item>
<a href=/4/62/>
用户故事_赵文海：怕什么真理无穷，进一寸有一寸的欢喜
</a>
</li><li data-nav-id=/4/58/ title=结束语_知也无涯，愿你也享受发现的乐趣 class=dd-item>
<a href=/4/58/>
结束语_知也无涯，愿你也享受发现的乐趣
</a>
</li></ul></li><li data-nav-id=/5/ title=趣谈网络协议 class=dd-item>
<a href=/5/>
趣谈网络协议
</a>
<ul>
<li data-nav-id=/5/42/ title=加餐1_创作故事：我是如何创作“趣谈网络协议”专栏的？ class=dd-item>
<a href=/5/42/>
加餐1_创作故事：我是如何创作“趣谈网络协议”专栏的？
</a>
</li><li data-nav-id=/5/43/ title=加餐2_“趣谈网络协议”专栏食用指南 class=dd-item>
<a href=/5/43/>
加餐2_“趣谈网络协议”专栏食用指南
</a>
</li><li data-nav-id=/5/51/ title=协议专栏特别福利_答疑解惑第一期 class=dd-item>
<a href=/5/51/>
协议专栏特别福利_答疑解惑第一期
</a>
</li><li data-nav-id=/5/48/ title=协议专栏特别福利_答疑解惑第三期 class=dd-item>
<a href=/5/48/>
协议专栏特别福利_答疑解惑第三期
</a>
</li><li data-nav-id=/5/47/ title=协议专栏特别福利_答疑解惑第二期 class=dd-item>
<a href=/5/47/>
协议专栏特别福利_答疑解惑第二期
</a>
</li><li data-nav-id=/5/50/ title=协议专栏特别福利_答疑解惑第五期 class=dd-item>
<a href=/5/50/>
协议专栏特别福利_答疑解惑第五期
</a>
</li><li data-nav-id=/5/49/ title=协议专栏特别福利_答疑解惑第四期 class=dd-item>
<a href=/5/49/>
协议专栏特别福利_答疑解惑第四期
</a>
</li><li data-nav-id=/5/46/ title=开篇词_想成为技术牛人？先搞定网络协议！ class=dd-item>
<a href=/5/46/>
开篇词_想成为技术牛人？先搞定网络协议！
</a>
</li><li data-nav-id=/5/1/ title=第10讲_UDP协议：因性善而简单，难免碰到“城会玩” class=dd-item>
<a href=/5/1/>
第10讲_UDP协议：因性善而简单，难免碰到“城会玩”
</a>
</li><li data-nav-id=/5/2/ title=第11讲_TCP协议（上）：因性恶而复杂，先恶后善反轻松 class=dd-item>
<a href=/5/2/>
第11讲_TCP协议（上）：因性恶而复杂，先恶后善反轻松
</a>
</li><li data-nav-id=/5/3/ title=第12讲_TCP协议（下）：西行必定多妖孽，恒心智慧消磨难 class=dd-item>
<a href=/5/3/>
第12讲_TCP协议（下）：西行必定多妖孽，恒心智慧消磨难
</a>
</li><li data-nav-id=/5/4/ title=第13讲_套接字Socket：Talkischeap,showmethecode class=dd-item>
<a href=/5/4/>
第13讲_套接字Socket：Talkischeap,showmethecode
</a>
</li><li data-nav-id=/5/5/ title=第14讲_HTTP协议：看个新闻原来这么麻烦 class=dd-item>
<a href=/5/5/>
第14讲_HTTP协议：看个新闻原来这么麻烦
</a>
</li><li data-nav-id=/5/6/ title=第15讲_HTTPS协议：点外卖的过程原来这么复杂 class=dd-item>
<a href=/5/6/>
第15讲_HTTPS协议：点外卖的过程原来这么复杂
</a>
</li><li data-nav-id=/5/7/ title=第16讲_流媒体协议：如何在直播里看到美女帅哥？ class=dd-item>
<a href=/5/7/>
第16讲_流媒体协议：如何在直播里看到美女帅哥？
</a>
</li><li data-nav-id=/5/8/ title=第17讲_P2P协议：我下小电影，99%急死你 class=dd-item>
<a href=/5/8/>
第17讲_P2P协议：我下小电影，99%急死你
</a>
</li><li data-nav-id=/5/9/ title=第18讲_DNS协议：网络世界的地址簿 class=dd-item>
<a href=/5/9/>
第18讲_DNS协议：网络世界的地址簿
</a>
</li><li data-nav-id=/5/10/ title=第19讲_HttpDNS：网络世界的地址簿也会指错路 class=dd-item>
<a href=/5/10/>
第19讲_HttpDNS：网络世界的地址簿也会指错路
</a>
</li><li data-nav-id=/5/11/ title=第1讲_为什么要学习网络协议？ class=dd-item>
<a href=/5/11/>
第1讲_为什么要学习网络协议？
</a>
</li><li data-nav-id=/5/12/ title=第20讲_CDN：你去小卖部取过快递么？ class=dd-item>
<a href=/5/12/>
第20讲_CDN：你去小卖部取过快递么？
</a>
</li><li data-nav-id=/5/13/ title=第21讲_数据中心：我是开发商，自己拿地盖别墅 class=dd-item>
<a href=/5/13/>
第21讲_数据中心：我是开发商，自己拿地盖别墅
</a>
</li><li data-nav-id=/5/14/ title=第22讲_VPN：朝中有人好做官 class=dd-item>
<a href=/5/14/>
第22讲_VPN：朝中有人好做官
</a>
</li><li data-nav-id=/5/15/ title=第23讲_移动网络：去巴塞罗那，手机也上不了脸书 class=dd-item>
<a href=/5/15/>
第23讲_移动网络：去巴塞罗那，手机也上不了脸书
</a>
</li><li data-nav-id=/5/16/ title=第24讲_云中网络：自己拿地成本高，购买公寓更灵活 class=dd-item>
<a href=/5/16/>
第24讲_云中网络：自己拿地成本高，购买公寓更灵活
</a>
</li><li data-nav-id=/5/17/ title=第25讲_软件定义网络：共享基础设施的小区物业管理办法 class=dd-item>
<a href=/5/17/>
第25讲_软件定义网络：共享基础设施的小区物业管理办法
</a>
</li><li data-nav-id=/5/18/ title=第26讲_云中的网络安全：虽然不是土豪，也需要基本安全和保障 class=dd-item>
<a href=/5/18/>
第26讲_云中的网络安全：虽然不是土豪，也需要基本安全和保障
</a>
</li><li data-nav-id=/5/19/ title=第27讲_云中的网络QoS：邻居疯狂下电影，我该怎么办？ class=dd-item>
<a href=/5/19/>
第27讲_云中的网络QoS：邻居疯狂下电影，我该怎么办？
</a>
</li><li data-nav-id=/5/20/ title=第28讲_云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私 class=dd-item>
<a href=/5/20/>
第28讲_云中网络的隔离GRE、VXLAN：虽然住一个小区，也要保护隐私
</a>
</li><li data-nav-id=/5/21/ title=第29讲_容器网络：来去自由的日子，不买公寓去合租 class=dd-item>
<a href=/5/21/>
第29讲_容器网络：来去自由的日子，不买公寓去合租
</a>
</li><li data-nav-id=/5/22/ title=第2季回归_这次我们来“趣谈Linux操作系统” class=dd-item>
<a href=/5/22/>
第2季回归_这次我们来“趣谈Linux操作系统”
</a>
</li><li data-nav-id=/5/23/ title=第2讲_网络分层的真实含义是什么？ class=dd-item>
<a href=/5/23/>
第2讲_网络分层的真实含义是什么？
</a>
</li><li data-nav-id=/5/24/ title=第30讲_容器网络之Flannel：每人一亩三分地 class=dd-item>
<a href=/5/24/>
第30讲_容器网络之Flannel：每人一亩三分地
</a>
</li><li data-nav-id=/5/25/ title=第31讲_容器网络之Calico：为高效说出善意的谎言 class=dd-item>
<a href=/5/25/>
第31讲_容器网络之Calico：为高效说出善意的谎言
</a>
</li><li data-nav-id=/5/26/ title=第32讲_RPC协议综述：远在天边，近在眼前 class=dd-item>
<a href=/5/26/>
第32讲_RPC协议综述：远在天边，近在眼前
</a>
</li><li data-nav-id=/5/27/ title=第33讲_基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛 class=dd-item>
<a href=/5/27/>
第33讲_基于XML的SOAP协议：不要说NBA，请说美国职业篮球联赛
</a>
</li><li data-nav-id=/5/28/ title=第34讲_基于JSON的RESTful接口协议：我不关心过程，请给我结果 class=dd-item>
<a href=/5/28/>
第34讲_基于JSON的RESTful接口协议：我不关心过程，请给我结果
</a>
</li><li data-nav-id=/5/29/ title=第35讲_二进制类RPC协议：还是叫NBA吧，总说全称多费劲 class=dd-item>
<a href=/5/29/>
第35讲_二进制类RPC协议：还是叫NBA吧，总说全称多费劲
</a>
</li><li data-nav-id=/5/30/ title=第36讲_跨语言类RPC协议：交流之前，双方先来个专业术语表 class=dd-item>
<a href=/5/30/>
第36讲_跨语言类RPC协议：交流之前，双方先来个专业术语表
</a>
</li><li data-nav-id=/5/31/ title=第37讲_知识串讲：用双十一的故事串起碎片的网络协议（上） class=dd-item>
<a href=/5/31/>
第37讲_知识串讲：用双十一的故事串起碎片的网络协议（上）
</a>
</li><li data-nav-id=/5/32/ title=第38讲_知识串讲：用双十一的故事串起碎片的网络协议（中） class=dd-item>
<a href=/5/32/>
第38讲_知识串讲：用双十一的故事串起碎片的网络协议（中）
</a>
</li><li data-nav-id=/5/33/ title=第39讲_知识串讲：用双十一的故事串起碎片的网络协议（下） class=dd-item>
<a href=/5/33/>
第39讲_知识串讲：用双十一的故事串起碎片的网络协议（下）
</a>
</li><li data-nav-id=/5/34/ title=第3讲_ifconfig：最熟悉又陌生的命令行 class=dd-item>
<a href=/5/34/>
第3讲_ifconfig：最熟悉又陌生的命令行
</a>
</li><li data-nav-id=/5/35/ title=第40讲_搭建一个网络实验环境：授人以鱼不如授人以渔 class=dd-item>
<a href=/5/35/>
第40讲_搭建一个网络实验环境：授人以鱼不如授人以渔
</a>
</li><li data-nav-id=/5/36/ title=第4讲_DHCP与PXE：IP是怎么来的，又是怎么没的？ class=dd-item>
<a href=/5/36/>
第4讲_DHCP与PXE：IP是怎么来的，又是怎么没的？
</a>
</li><li data-nav-id=/5/37/ title=第5讲_从物理层到MAC层：如何在宿舍里自己组网玩联机游戏？ class=dd-item>
<a href=/5/37/>
第5讲_从物理层到MAC层：如何在宿舍里自己组网玩联机游戏？
</a>
</li><li data-nav-id=/5/38/ title=第6讲_交换机与VLAN：办公室太复杂，我要回学校 class=dd-item>
<a href=/5/38/>
第6讲_交换机与VLAN：办公室太复杂，我要回学校
</a>
</li><li data-nav-id=/5/39/ title=第7讲_ICMP与ping：投石问路的侦察兵 class=dd-item>
<a href=/5/39/>
第7讲_ICMP与ping：投石问路的侦察兵
</a>
</li><li data-nav-id=/5/40/ title=第8讲_世界这么大，我想出网关：欧洲十国游与玄奘西行 class=dd-item>
<a href=/5/40/>
第8讲_世界这么大，我想出网关：欧洲十国游与玄奘西行
</a>
</li><li data-nav-id=/5/41/ title=第9讲_路由协议：西出网关无故人，敢问路在何方 class=dd-item>
<a href=/5/41/>
第9讲_路由协议：西出网关无故人，敢问路在何方
</a>
</li><li data-nav-id=/5/45/ title=结束语_放弃完美主义，执行力就是限时限量认真完成 class=dd-item>
<a href=/5/45/>
结束语_放弃完美主义，执行力就是限时限量认真完成
</a>
</li><li data-nav-id=/5/44/ title=结课测试_这些网络协议你都掌握了吗？ class=dd-item>
<a href=/5/44/>
结课测试_这些网络协议你都掌握了吗？
</a>
</li></ul></li></ul><section id=footer>
<p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body>
<div id=overlay></div><div class="padding highlightable">
<div>
<div id=top-bar>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
<a href=/>Gen 的学习笔记</a> > <a href=/3/>手把手带你写一门编程语言</a> > 08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机
</span>
</div><div class=progress>
<div class=wrapper>
<nav id=TableOfContents></nav></div></div></div></div><div id=head-tags>
</div><div id=body-inner>
<h1>
08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机
</h1><p><audio title=08｜基于TypeScript的虚拟机（一）：实现一个简单的栈机 src=https://static001.geekbang.org/resource/audio/af/b9/afc98ff4c217c248943a1056ffa92ab9.mp3 controls></audio></p><p>你好，我是宫文学。</p><p>上一节课，我们已经探讨了设计一个虚拟机所要考虑的那些因素，并做出了一些设计决策。那么今天这一节课，我们就来实现一个初级的虚拟机。</p><p>要实现这个初级虚拟机，具体来说，我们要完成下面三方面的工作：</p><p>首先，我们要设计一些字节码，来支持第一批语言特性，包括支持函数、变量和整型数据的运算。也就是说，我们的虚拟机要能够支持下面程序的正确运行：</p><pre><code class=language-plain>//一个简单的函数，把输入的参数加10，然后返回
function foo(x:number):number{
    return x + 10;
}
//调用foo，并输出结果
println(foo(18));
</code></pre><p>第二，我们要做一个字节码生成程序，基于当前的AST生成正确的字节码。</p><p>第三，使用TypeScript，实现一个虚拟机的原型系统，验证相关设计概念。</p><p>话不多说，开搞，让我们先设计一下字节码吧！</p><h2>“设计”字节码</h2><p>说是设计，其实我比较懒，更愿意抄袭现成的设计，比如Java的字节码设计。因为Java字节码的资料最充分，比较容易研究，不像V8等的字节码，只有很少的文档资料，探讨的人也很少。另外，学会手工生成Java字节码还有潜在的实用价值，比如你可以把自己的语言编译后直接在JVM上运行。那么我们就先来研究一下Java字节码的特点。</p><p>上面的用TypeScript编写的示例代码，如果用Java改写，会变成下面的程序：</p><pre><code class=language-plain>//实现同样功能的Java程序。
public class A{
    public static int foo(int a){
        return a + 10;
    }
    public static void main(String args[]){
        System.out.println(foo(8));
    }
}
</code></pre><p>我们首先把这个Java程序编译成字节码。</p><pre><code class=language-plain>javac A.java
</code></pre><p>这个文件是一个二进制文件。我们可以用hexdump命令查看它的内容。</p><pre><code class=language-plain>hexdump -C A.class
</code></pre><p><img src="https://static001.geekbang.org/resource/image/19/2e/19380b1b13c608e9db8c842a3a7de92e.jpg?wh=1492x1199" alt=图片></p><p>从hexdump显示的信息中，你能看到一些可以阅读的字符，比如“java/lang/Object”、"java/lang/System"等等，这些是常量表中的内容。还有一些内容显然不是字符，没法在屏幕上显示，所以hexdump就用一个.号来表示。其中某些字节，代表的是指令，我在图中把代表foo函数、main函数和构造函数的指令标注了出来，这些都是。用于运行的字节码指令，其他都是一些符号表等描述性的信息。</p><p>通过上图，你还能得到一个直观的印象：<strong>字节码文件并不都是由指令构成的</strong>。</p><p>没错，指令只是一个程序文件的一部分。除了指令以外，在字节码文件中还要存储不少其他内容，才能保证程序的正常运行，比如类和方法的符号信息、字符串和数字常量，等等。至于字节码文件的格式，是由字节码的规范来规定的，你有兴趣的话，可以按照规范生成这样的字节码文件。这样的话，我们的程序就可以在JVM上运行了。</p><p>不过，我现在不想陷入字节码文件格式的细节里，而是想用自己的方式生成字节码文件，够支持现在的语言特性，能够在我们自己的虚拟机上运行就行了。</p><p>上面这张图显示的字节码文件不是很容易阅读和理解。所以，我们用javap命令把它转化成文本格式来看看。</p><pre><code class=language-plain>javap -v A.class &gt; A.bc
</code></pre><p>在这个新生成的文件里，我们可以清晰地看到每个函数的定义以及指令，我也在图里标注了主要的指令的含义。</p><p><img src="https://static001.geekbang.org/resource/image/c9/a1/c90344b05e25ffae95a2c3e9e1a804a1.jpg?wh=1328x1265" alt=图片 title=文本格式的字节码文件></p><p>看到这个字节码文件的内容，你可能会直观地觉得：这看上去跟我们的高级语言也没有那么大的区别嘛。程序照样划分成几个函数，只不过每个函数里的语句变成了栈机的指令而已，函数之间照样需要互相调用。</p><p>实际上也确实没错。字节码文件里本来就存储了各个类和方法的符号信息，相当于保存了高级语言里的主体框架。当然，每个方法体里的代码就看不出if语句、循环语句这样的结构了，而是变成了字节码的指令。</p><p>通过研究这些指令，加上查阅<a href=https://docs.oracle.com/javase/specs/jvms/se12/html/jvms-6.html>JVM规则</a>中对于字节码的规定，你会发现为了实现上面示例代码中的功能，我们目前只需要这几个指令就够了：</p><p><img src="https://static001.geekbang.org/resource/image/60/20/608cdfd47efe1e162e8bd7ca88f1d420.jpg?wh=1919x1265" alt=图片></p><p><img src="https://static001.geekbang.org/resource/image/55/f6/55334d4a30a41ed87bf7bc82c64c9ef6.jpg?wh=1920x1220" alt=图片 title=常数入栈指令></p><p><img src="https://static001.geekbang.org/resource/image/e5/8b/e52ef425d612381fe33628818c75c68b.jpg?wh=1920x1166" alt=图片 title=二元运算指令，以及函数调用和返回指令></p><p>你先花一两分钟看一下这些指令，看上去挺多，其实可以分为几组。</p><p>首先是iload系列，这是把指定下标的本地变量入栈。注意，变量的下标是由声明的顺序决定的，参数也算本地变量，并且排在最前面。所以，iload 0的意思，就是把第一个参数入栈。如果没有参数，就是把第一个本地变量入栈。</p><p>iload后面的那几个指令，是压缩格式的指令，也就是利用指令末尾富余的位，把操作数和指令压缩在了一起，这样可以少一个字节码，能够缩小最后生成的字节码文件的大小。从这里面，你能借鉴到字节码设计的一些好的实践。所以你看，学习成熟的设计是有好处的吧？</p><p>第二组是istore系列，它做的工作刚好跟iload相反，是把栈顶的值存到指定下标的变量里去。</p><p>第三组，是对常数做入栈的操作。对于0~5这几个数字，Java字节码也是提供了压缩格式的指令。对于8位整数（-128~127），使用bipush指令。对于16位整数（-32768~32767），使用sipush指令。而对于更大的常数，则要使用ldc指令，从常量池里去取。</p><p>第四组，是几个二元运算的指令。它们都是从栈里取两个操作数，计算完毕之后，再压回栈里。</p><p>最后一组指令，是函数调用和返回的指令。函数调用的时候，也是从栈里取参数。返回值呢，则压回栈里。</p><p>通过这些指令，我们就完全能够实现一些基本的功能了，之后我们再根据需要添加更多的指令就好。</p><p>现在，我们把这些指令做成枚举值，方便程序使用：</p><pre><code class=language-plain>/**
 * 指令的编码
 */
enum OpCode{
    iconst_0= 0x03,
    iconst_1= 0x04,
    iconst_2= 0x05,
    iconst_3= 0x06,
    iconst_4= 0x07,
    iconst_5= 0x08,
    bipush  = 0x10,  //8位整数入栈
    sipush  = 0x11,  //16位整数入栈
    iload   = 0x15,  //本地变量入栈
    iload_0 = 0x1a,
    iload_1 = 0x1b,
    iload_2 = 0x1c,
    iload_3 = 0x1d,
    istore  = 0x36,
    istore_0= 0x3b,
    istore_1= 0x3c,
    istore_2= 0x3d,
    istore_3= 0x3e,
    iadd    = 0x60,
    isub    = 0x64,
    imul    = 0x68,
    idiv    = 0x6c,
    ireturn = 0xac,
    return  = 0xb1,
    invokestatic= 0xb8, //调用函数
}
</code></pre><p>好了，我们通过全盘照抄的方式，“设计”出了自己所需要的字节码。不过这些都只是指令的部分。还要有常量池的部分，我们在下面使用到的时候再去设计。</p><p>接下来，我们来生成自己的字节码。</p><h2>生成字节码</h2><p>生成栈机的字节码是比较简单的。为什么呢？因为栈机的字节码基本上跟AST是同构的，通过深度优先的顺序遍历AST就可以实现。相对来说，生成寄存器机的指令的算法就要稍微绕一点，我们也会在后面的课程中体会到。</p><p>怎么来深度优先地遍历AST、生成栈机的字节码呢？以“3+a”这样一个简单的表达式为例，我们处理的顺序依次是字面量3、变量a和+号。</p><p>首先来处理字面量。处理整型字面量的时候，我们需要根据整数的不同长度，分别使用不同的常量指令。其中的一个细节是，当整数是32位时，操作数要拆成两个字节。而当大于32位时，我们干脆就把字面量放在常量池里，操作数只是该常数在常量池的索引值。</p><p>这里的处理你可以参照下面这个代码：</p><pre><code class=language-plain>visitIntegerLiteral(integerLiteral: IntegerLiteral):any{
    let ret:number[] = [];
    let value = integerLiteral.value;
    //0-5之间的数字，直接用快捷指令
    if (value &gt;= 0 &amp;&amp; value &lt;= 5) {
        switch (value) {
            case 0:
                ret.push(OpCode.iconst_0);
                break;
            ...省略1、2、3、4的情况
            case 5:
                ret.push(OpCode.iconst_5);
                break;
        }
    }
<pre><code>//如果是8位整数，用bipush指令，直接放在后面的一个字节的操作数里就行了
else if (value &amp;gt;= -128 &amp;amp;&amp;amp; value &amp;lt;128){
    ret.push(OpCode.bipush);
    ret.push(value);
}

//如果是16位整数，用sipush指令
else if (value &amp;gt;= -32768 &amp;amp;&amp;amp; value &amp;lt;32768){
    ret.push(OpCode.sipush);
    //要拆成两个字节
    ret.push(value &amp;gt;&amp;gt; 8);
    ret.push(value &amp;amp; 0x00ff);
}

//大于16位的，采用ldc指令，从常量池中去取
else{
    //把value值放入常量池。
    this.module.consts.push(value); 
    ret.push(this.module.consts.length -1);
}
return ret;
</code></pre><p>}
</code></pre><p>接着来处理变量a。在处理变量的时候，我们要区分左值和右值的情况。在“3+a”这个表达式中，a是个右值，我们需要取出a的值，也就是要生成iload指令。但对于“a=3”这样的表达式，a是个左值，这个时候返回a的符号即可，在处理赋值运算的时候再生成istore指令。</p><pre><code class=language-plain>/**</p>
<ul>
<li>左值的情况，返回符号。否则，生成iload指令。</li>
<li>@param v
*/
visitVariable(v:Variable):any{
if (v.isLeftValue){
return v.sym;
}
else{
return this.getVariableValue(v.sym);
}
}</li>
</ul>
<p>/**</p>
<ul>
<li>生成获取本地变量值的指令</li>
<li>@param varName
*/
private getVariableValue(sym:VarSymbol|null):any{
if (sym != null){
let code:number[] = [];  //生成的字节码
//本地变量的下标
let index = this.functionSym?.vars.indexOf(sym);
assert(index != -1, &ldquo;生成字节码时（获取变量的值），在函数符号中获取本地变量下标失败！&rdquo;);
//根据不同的下标生成指令，尽量生成压缩指令
switch (index){
case 0:
code.push(OpCode.iload_0);
break;
case 1:
code.push(OpCode.iload_1);
break;
case 2:
code.push(OpCode.iload_2);
break;
case 3:
code.push(OpCode.iload_3);
break;
default:
code.push(OpCode.iload); <br>
code.push(index as number);            <br>
}         <br>
return code;
}
}</li>
</ul>
<p></code></pre><p>然后，我们要对加减乘除这些二元运算来生成代码，我们可以先为左右子树分别生成代码，再把加减乘除的运算指令放在最后。注意，赋值运算的处理逻辑是不同的，它要生成istore指令。</p><pre><code class=language-plain>visitBinary(bi:Binary):any{
let code:number[];
let code1 = this.visit(bi.exp1);
let code2 = this.visit(bi.exp2);</p>
<pre><code>////1.处理赋值
if (bi.op == Op.Assign){
    let varSymbol = code1 as VarSymbol; 
    //加入右子树的代码
    code = code2;
    //加入istore代码
    code = code.concat(this.setVariableValue(varSymbol));
}
////2.处理其他二元运算
else{
    //加入左子树的代码
    code = code1;
    //加入右子树的代码
    code = code.concat(code2);
    //加入运算符的代码
    switch(bi.op){
        case Op.Plus: //'+'
            code.push(OpCode.iadd);
            break;
        case Op.Minus: //'-'
            code.push(OpCode.isub);
            break;
        case Op.Multiply: //'*'
            code.push(OpCode.imul);
            break;
        case Op.Divide: //'/'
            code.push(OpCode.idiv);
            break;
        default:
            console.log(&quot;Unsupported binary operation: &quot; + bi.op);
            return [];
    }
}
return code;
</code></pre><p>}
</code></pre><p>好了，到此这里，我们对处理基本的表达式就没有问题了。接下来，我们再增加与函数调用和返回有关的指令。</p><p>在进行函数调用的时候，我们要依次生成与参数计算有关的指令，最后生成invokestatic指令。</p><pre><code class=language-plain>let code:number[] = [];
//1.依次生成与参数计算有关的指令
for(let param of functionCall.paramValues){
let code = this.visit(param);
if (typeof code == &lsquo;object&rsquo;){
code = code.concat(code as number[]);
}
}
//2.生成invoke指令
let index = this.module.consts.indexOf(functionCall.sym);
code.push(OpCode.invokestatic);
code.push(index&gt;&gt;8);
code.push(index);
return code;
</code></pre><p>然后，在处理return语句的时候，也要注意，我们要根据是否有返回值，分别生成ireturn和return指令。</p><pre><code class=language-plain>let code:number[] = [];
//1.为return后面的表达式生成代码
if(returnStatement.exp != null){
let code1 = this.visit(returnStatement.exp);
if (typeof code1 == &lsquo;object&rsquo;){
code = code.concat(code1 as number[]);
//生成ireturn代码
code.push(OpCode.ireturn);
return code;
}
}
else{
//2.生成return代码，返回值是void
code.push(OpCode.return);
return code;
}
</code></pre><p>到这里，我们已经能够顺利的生成字节码了。生成字节码以后，接下来就只剩最后一步了：实现一个虚拟机，让这些字节码真正运行起来！</p><h2>实现一个TypeScript版本的虚拟机</h2><p>如果你是学习Java的同学，那你在面试的时候肯定经常会被问到与虚拟机有关的知识点。你也会根据自己了解的知识，对操作数栈、常量池等发表一通见解。但是，你心里多多少少对这些概念还会隔着一层面纱。</p><p>直到你自己亲自动手实现一遍，哪怕只是实现一个原型系统，你对这些概念，以及对虚拟机到底是如何运行的，才会有真真切切的理解。所以，我鼓励你动手实现一遍。而且，我可以告诉你，真的花不了多少时间。如果你看看我给出的示例代码，其实就是一个大函数，针对不同的字节码指令做处理而已。</p><p>不过，为了便于你理解代码，我还是先画一个虚拟机的示意图。我们这个简单的虚拟机主要涉及几个对象：</p><p><img src="https://static001.geekbang.org/resource/image/76/a0/76a4640bbe5c0d394c1ed8e330c214a0.jpg?wh=1584x1265" alt=图片></p><p><strong>首先是模块。</strong>模块代表了我们的程序，模块里最重要的就是一个常量表。常量表中的常量包含字符串常量、数字常量和函数符号。而函数符号里有一个bytecode属性，保存了这个函数的字节码。这样，我们就可以找到函数的代码并运行它们了。</p><pre><code class=language-plain>export class BCModule{
//常量
consts:any[] = [];</p>
<p>//入口函数
_main:FunctionSymbol|null = null;
}
</code></pre><p><strong>然后是运行程序的栈机。</strong>栈机里最重要的数据结构是一个调用栈，在AST解释器里也有类似的数据结构。调用栈是由栈桢构成的，在执行每个函数的时候，都需要在栈顶新加一个栈桢，而在退出函数的时候，就会弹出这个函数的栈桢。</p><pre><code class=language-plain>//栈机
export class VM{
//调用栈
callStack:StackFrame[]=[];
//执行一个模块
execute(bcModule:BCModule):number{
&hellip;
}
}
</code></pre><p>你要注意，栈桢是一个关键的数据结构，它用来保存每个函数运行时所需要保存的状态信息。每个栈桢里又有几个关键的组成部分。</p><ul></p><li>操作数栈：用来保存函数执行过程中各个指令所需要用到的操作数；</li><li>存放本地变量的数组：可以在这里存取变量值；</li><li>返回地址：也是在调用子函数的时候，告诉子函数返回以后，从哪条代码接着运行。</li></ul><p>栈机里的execute方法，就是虚拟机的核心执行引擎。下面我摘一些有代表性的代码给你讲一下，你先看一下示例代码的结构。</p><pre><code class=language-plain>//一直执行代码，直到遇到return语句
let opCode = code[codeIndex];
while(true){
    switch (opCode){
        case OpCode.iconst_0: //加载常量
            frame.oprandStack.push(0);
            opCode = code[++codeIndex];
            continue;
        ...
        case OpCode.sipush:  //加载32位常量，需要取出2个字节
            let byte1 = code[++codeIndex];
            let byte2 = code[++codeIndex];
            frame.oprandStack.push(byte1&lt;&lt;8|byte2); 
            opCode = code[++codeIndex];
            continue;
        ...
        case OpCode.iload_0: //从变量里取值
            frame.oprandStack.push(frame.localVars[0]);
            opCode = code[++codeIndex];
            continue;
        ...
        case OpCode.istore_0: //给变量赋值
            frame.localVars[0] = frame.oprandStack.pop();
            opCode = code[++codeIndex];
            continue;
        ...
        case OpCode.iadd:     //加减乘除
            frame.oprandStack.push(frame.oprandStack.pop() + frame.oprandStack.pop());
            opCode = code[++codeIndex];
            continue;
        ...
    }
}
</code></pre><p>你可能马上会注意到，<strong>整个程序执行的过程就是一个大的while循环</strong>。</p><p>几乎所有的虚拟机的核心执行引擎都是这么写的，因为程序的执行过程就是不停地读取指令，然后根据指令做相应的动作。其中的代码计数器，一直指向下一个要执行的指令的位置。由于指令的种类比较多，所以switch后面会罗列很多个case，代码也会很长。你用电脑看这些代码的话，可能要翻很多屏。</p><p>虽然这个函数的代码很长，我们一般也不会把它拆成多个函数。为什么呢？这似乎违背了通常的编程理念呀。通常我们都不会编写太长的函数，这不容易阅读，也不容易维护。</p><p>但事情总有例外。对于虚拟机的执行引擎来说，性能上的考虑是第一位的。执行一个指令，可能开销并不大。但如果执行这条指令要调用一个专门的函数，那函数调用的额外开销会比执行指令本身的开销都大，那显然就不合理了，这也是我们为什么弃用AST解释器的原因。</p><p>我们这个示例代码中体现了加载常量、加载变量、保存变量和执行加减乘除的运算的实现方式。你能通过这些代码，再一次验证栈机的工作原理，这里所有操作都是围绕着操作数栈来进行的。</p><p>而函数的调用和返回，则显得复杂一点。这两部分代码，也有助于你更加细致的了解栈桢的使用方式。</p><p>首先我们来看看函数调用：</p><pre><code class=language-plain>case OpCode.invokestatic:
    //从常量池找到被调用的函数
    byte1 = code[++codeIndex];
    byte2 = code[++codeIndex];
    let functionSym = bcModule.consts[byte1&lt;&lt;8|byte2] as FunctionSymbol;
<pre><code>//设置返回值地址，为函数调用的下一条指令
frame.returnIndex = codeIndex;

//创建新的栈桢
let lastFrame = frame;
frame = new StackFrame(functionSym);
this.callStack.push(frame);

//传递参数
let paramCount = (functionSym.decl as FunctionDecl).callSignature.params.length;
for(let i = paramCount -1; i&amp;gt;= 0; i--){
    frame.localVars[i] = lastFrame.oprandStack.pop();
}

//设置新的code、codeIndex和oPCode
if (frame.funtionSym.bytecode !=null){
    //切换到被调用函数的代码
    code = frame.funtionSym.bytecode;
    //代码指针归零
    codeIndex = 0;
    opCode = code[codeIndex];
    continue;
}
</code></pre><p></code></pre><p>在函数调用的时候，我们要完成这几项工作：</p><ul></p><li>设置返回地址，被调用的函数在执行return指令的时候，会回到这个位置；</li><li>为被调用的函数生成新的栈桢，并加到调用栈中；</li><li>从操作数栈中取出参数的值，并赋给新的栈桢，因为参数也算作本地变量，因此只需要对新栈桢的前几个本地变量赋值就可以了；</li><li>把代码切换到被调用函数的代码，并且把代码计数器设置为0，也就是从第一个字节码指令开始执行。</li></ul><p>而函数返回是函数调用的逆向操作：</p><pre><code class=language-plain>case OpCode.ireturn:
case OpCode.return:
    //确定返回值
    let retValue = undefined;
    if(opCode == OpCode.ireturn){
        retValue = frame.oprandStack.pop();
    }
<pre><code>//弹出栈桢，返回到上一级函数，继续执行
this.callStack.pop();
if (this.callStack.length == 0){ //主程序返回，结束运行
    return 0;
}
else { //返回到上一级调用者
    frame = this.callStack[this.callStack.length-1];
    //设置返回值到上一级栈桢
    // frame.retValue = retValue;
    if(opCode == OpCode.ireturn){
        frame.oprandStack.push(retValue);
    }    
    //设置新的code、codeIndex和oPCode
    if (frame.funtionSym.byteCode !=null){
        //切换到调用者的代码
        code = frame.funtionSym.byteCode;
        //设置指令指针为返回地址，也就是调用该函数的下一条指令
        codeIndex = frame.returnIndex;
        opCode = code[codeIndex];
        continue;
    }
    else{
        console.log(&quot;Can not find code for &quot;+ frame.funtionSym.name);
        return -1;
    }
}
continue;
</code></pre><p></code></pre><p>函数返回时，我们需要完成下面这几项工作：</p><ul></p><li>设置返回值，如果确实有一个返回值，那么就从当前操作数栈中取出来，返回值加载到上一级栈桢里的操作数栈；</li><li>从调用栈中弹出当前栈桢；</li><li>把代码切换成调用者的代码，并且把代码指针设置成函数调用指令的下一条指令，继续函数调用之后的工作；</li><li>这里还有一个特殊情况，执行到return指令的时候，你会发现当前栈桢之上，再也没有上一级栈桢了。这说明当前所在的函数已经是最顶层了，也就是我们的编译器内部的_main()函数。这个时候，return指令就会结束整个while循环，也意味着整个程序运行结束。</li></ul><p>好了，这就是函数调用和返回的过程。通过这个过程，你会发现这两类指令其实是遵循了一些共同的约定。</p><p>这些约定包括：我们传参数的时候，把参数放在哪里？函数返回的时候，又把返回值放在哪里？还有，调用函数的时候，我们应该在一个双方都知道的位置设置返回地址，以便函数返回后调到这个地址继续执行。</p><p>这里，你又学到一个概念，叫做<strong>调用约定（Calling Convention）</strong>。计算机语言的设计者，可以设计自己的调用约定，这样用自己的编译器编译出来的模块，都能互相调用。但如果一种语言想调用另一种语言编写的模块，那么它们必须遵循相同的调用约定，或者要在不同的调用约定之间做转换。比如，Java调用C语言写的模块，要使用JNI接口，就是要完成这种调用约定的转换。</p><p>跟调用约定差不多的一个概念叫做<strong>ABI（Application Binary Interface）</strong>。ABI这个名字更强调如何在二进制的层面上实现互相调用，以及二进制程序文件的格式，等等，所以更适合描述像C、C++这些编译成二进制目标代码的情形。</p><p>好了，现在我们已经拥有了一个简化版的虚拟机了，你可以用它跑几个程序试一下。因为现在我们这个虚拟机还不支持if语句和循环语句，所以还不方便做性能测试。这个工作，我们放在下一节课再去做。</p><h2>课程小结</h2><p>好了，今天这节课到这里就结束了，让我们来简单回顾一下。</p><p>今天，我们设计并实现了一个简单的基于栈机的虚拟机，实现了我们在虚拟机领域0的突破。如果你认真跟着学完了这一节，我相信你一定会有很多收获。</p><p>首先，我们学了栈机的指令，通常包括加载常数、加载变量、保存变量、加减乘除、函数调用和返回这些，用这些指令就能让程序运行起来了。下一节课我们还会多学习一些指令，特别是分支指令。</p><p>第二，我们已经可以通过遍历AST的方式生成字节码。其中稍微有点难度的地方，是在访问变量节点的时候，要区分左值和右值，分别生成给变量赋值的代码和读取变量值的代码。</p><p>第三，在虚拟机里，我们用了BCModule这个数据结构来表示可被执行的程序。其实你把这个数据结构保存到文件里就是字节码文件了，它里面主要的内容就是一个常量表。常量表里除了字符串、数字这样的常规意义上的常数以外，最重要的还有函数符号，函数符号中包含了要运行的字节码。</p><p>第四，栈机的执行引擎是一个很大的循环，要依次执行每条指令，在这个过程中操作数栈会不停的压入数据、弹出数据。在调用函数和返回函数的时候，要建立栈桢和弹出栈桢。函数参数被设置到新栈桢的本地变量里，而返回值则被设置到上一级栈桢的操作数栈里，这就构成了函数之间的调用约定。</p><p>虽然我们目前是在虚拟机层面上了解这些概念，但是，即使是到了我们把程序编译成机器码的时候，这些基本概念仍然是差不多的。你现在学习的成果，会为后面的学习内容打下很好的基础。</p><p>在下一节课，我们将继续深化我们虚拟机。到时候它会在哪些方面取得突破呢？敬请期待吧！</p><h2>思考题</h2><p>在这节课的BCModule中有一个常量表，为什么把函数符号也看做是常量呢？刨去其中的字节码，这些符号信息可能有什么潜在的用途呢？欢迎在留言区发表你的看法！</p><p>感谢你和我一起学习，欢迎你把我这节课分享给更多对字节码虚拟机感兴趣的朋友。我是宫文学，我们下节课见！</p><h2>课程资源</h2><p><a href=https://gitee.com/richard-gong/craft-a-language/tree/master/16-18>这节课的示例代码在这里！</a></p><style>ul{list-style:none;display:block;list-style-type:disc;margin-block-start:1em;margin-block-end:1em;margin-inline-start:0;margin-inline-end:0;padding-inline-start:40px}li{display:list-item;text-align:-webkit-match-parent}._2sjJGcOH_0{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-top:26px;border-bottom:1px solid rgba(233,233,233,.6)}._2sjJGcOH_0 ._3FLYR4bF_0{width:34px;height:34px;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}._2sjJGcOH_0 ._36ChpWj4_0{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding-bottom:20px}._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0{font-size:16px;color:#3d464d;font-weight:500;-webkit-font-smoothing:antialiased;line-height:34px}._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0{margin-top:12px;color:#505050;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;white-space:normal;word-break:break-all;line-height:24px}._2sjJGcOH_0 ._10o3OAxT_0{margin-top:18px;border-radius:4px;background-color:#f6f7fb}._2sjJGcOH_0 ._3klNVc4Z_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:15px}._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0{color:#505050;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;white-space:normal;word-break:break-word;padding:20px 20px 20px 24px}._2sjJGcOH_0 ._3klNVc4Z_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:15px}._2sjJGcOH_0 ._3Hkula0k_0{color:#b2b2b2;font-size:14px}</style><ul><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>罗 乾 林</span>
</div><div class=_2_QraFYR_0>看了老师后面的课程来回答一下:<br><br>可以在运行期来显示错误信息<br>把函数名称和函数签名的信息加进去，会有利于我们实现多模块的运行机制。也就是说，如果一个模块中的函数要调用另一个模块中的函数，那么我们可以创造一种机制，实现模块之间的代码查找。</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2021-09-02 17:05:09</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>有学识的兔子</span>
</div><div class=_2_QraFYR_0>函数符号被看作常量，是不是因为函数符号类似于函数地址，跟字符串常量和数字常量一样都不可以被更改？<br>这些符号信息是不是在需要调试或追踪程序运行信息时,方便了解程序运行的上下文信息？</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2021-08-29 22:42:04</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>奋斗的蜗牛</span>
</div><div class=_2_QraFYR_0>回答一下思考题，符号表信息可以实现函数式编程的支持</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2021-08-26 22:55:24</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>bjuthang</span>
</div><div class=_2_QraFYR_0>赞👍</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2021-08-25 18:58:20</div></div></div></div></li></ul><footer class=footline>
</footer></div></div><div id=navigation>
<a class="nav nav-prev" href=/3/9/ title=07｜怎么设计属于我们自己的虚拟机和字节码？> <i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/3/11/ title=09｜基于TypeScript的虚拟机（二）：丰富特性，支持跳转语句 style=margin-right:0><i class="fa fa-chevron-right"></i></a>
</div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1646808665></script>
<script src=/js/perfect-scrollbar.min.js?1646808665></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1646808665></script>
<script src=/js/jquery.sticky.js?1646808665></script>
<script src=/js/featherlight.min.js?1646808665></script>
<script src=/js/highlight.pack.js?1646808665></script>
<script>hljs.initHighlightingOnLoad()</script>
<script src=/js/modernizr.custom-3.6.0.js?1646808665></script>
<script src=/js/learn.js?1646808665></script>
<script src=/js/hugo-learn.js?1646808665></script>
<script src=/mermaid/mermaid.js?1646808665></script>
<script>mermaid.initialize({startOnLoad:!0})</script>
</body></html>