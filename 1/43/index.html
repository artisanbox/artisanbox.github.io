<!doctype html><html lang=en class="js csstransforms3d">
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=generator content="Hugo 0.93.3">
<meta name=description content>
<link rel=icon href=/images/favicon.png type=image/png>
<title>43_要不要使用分区表？ :: Gen 的学习笔记</title><link href=/css/nucleus.css?1646795377 rel=stylesheet>
<link href=/css/fontawesome-all.min.css?1646795377 rel=stylesheet>
<link href=/css/hybrid.css?1646795377 rel=stylesheet>
<link href=/css/featherlight.min.css?1646795377 rel=stylesheet>
<link href=/css/perfect-scrollbar.min.css?1646795377 rel=stylesheet>
<link href=/css/auto-complete.css?1646795377 rel=stylesheet>
<link href=/css/atom-one-dark-reasonable.css?1646795377 rel=stylesheet>
<link href=/css/theme.css?1646795377 rel=stylesheet>
<link href=/css/tabs.css?1646795377 rel=stylesheet>
<link href=/css/hugo-theme.css?1646795377 rel=stylesheet>
<link href=/css/theme-green.css?1646795377 rel=stylesheet>
<script src=/js/jquery-3.3.1.min.js?1646795377></script>
<style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/1/43/>
<nav id=sidebar>
<div id=header-wrapper>
<div id=header>
<a id=logo href=/><svg id="grav-logo" style="width:100%;height:100%" viewBox="0 0 504 140" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421"><path id="path189" style="fill:#000;stroke-width:.204716" d="m82.052734 5.96875c-.854728.206286-1.398833 1.0426648-2.119991 1.5136522-1.191736.9811717-2.382712 1.9632671-3.575321 2.9433788 2.594183.350428 5.145702.867699 7.545412 1.808313 5.15394 2.088262 10.087847 4.726839 15.416602 6.374822 1.147804.40744 2.285264.842546 3.422754 1.277803 1.75942-1.384373 3.51938-2.768062 5.27734-4.154297-5.15508-1.970902-10.472419-3.533913-15.466989-5.9135627-3.304489-1.4459104-6.569291-3.1504213-10.136525-3.8383905-.121039-.00522-.24197-.024031-.363282-.011719z"/><path id="path450" style="fill:#000;stroke-width:.204716" d="m196.30273 32.138672c-1.55372 1.106817-3.11032 2.209608-4.66406 3.316406 4.11763 4.405283 7.13993 9.726972 9.45954 15.262663 1.56282 4.287959 2.2182 8.808703 2.86451 13.292499.38887 3.231143.62551 6.590222.0466 9.712715-.96049 4.643178-2.51468 9.199787-4.84902 13.336481-1.78789 2.835013-4.77216 5.01731-8.11326 5.529767-2.16053.194334-4.25815-1.330295-4.80458-3.419166-.29054-.914485-.51906-1.850946-.67999-2.79699 2.1261-1.148168 4.25191-2.296867 6.37891-3.443359.78567-2.636208 1.75001-5.564844.60547-8.248047-.53525-1.298746-2.07776-1.892115-3.39901-1.607978-1.67519.02941-3.3829.406643-4.74129 1.430853-2.09614 1.168313-4.10099 2.916619-4.64291 5.358765-.73735 2.904669-.11138 5.915639.29727 8.820042.49411 2.882218 1.53935 5.996824 4.13517 7.643151 2.35305 1.561098 5.48511 1.763546 8.04109.579307 3.30354-1.331591 6.21912-3.456703 8.96703-5.688008 1.96663-1.643363 3.42478-3.806368 4.42597-6.15213 2.06828-4.393527 3.59057-9.083525 4.21247-13.907794.54472-5.741127-.61574-11.455157-1.66588-17.071718-.80064-3.920321-2.18078-7.71884-4.16423-11.197019-2.05596-3.912809-4.48616-7.631847-7.30162-11.041456-.13607.097-.27214.194011-.40821.291016zm-8.92578 46.195312c.2043 1.815935-.60122 3.548925-1.07929 5.263081-.26336.819832-.52694 1.639598-.78985 2.459576-.30945-2.140868-.59564-4.349894-.22997-6.496983.18103-.524926.30215-1.38075 1.03046-1.299978.29126.03359 1.0366-.341949 1.06865.0743z"/><path id="path452" style="fill:#000;stroke-width:.204716" d="m194.86719 31.490234c-1.70711 1.334537-3.41328 2.670271-5.1211 4.003907 2.86943.883205 5.775 2.063806 7.95683 4.093286 4.34216 3.834897 7.82362 8.740548 9.94201 14.191942 1.76448 4.476901 2.8312 9.131581 3.98461 13.784118.98733 4.367667 1.90544 8.806141 3.88594 12.856576 1.24292 2.622586 2.70301 5.245971 5.0027 7.092602 2.86039 2.399492 6.23621 4.055842 9.38886 6.021597 2.04982 1.173006 4.12056 2.42864 6.39784 3.079398 1.45651.10626 2.44267-1.215991 3.58737-1.828292.94383-.603205 1.48969-1.756053 1.1938-2.859996-.26262-3.334359-1.79835-6.420037-2.55184-9.603237-1.082-3.641846-2.12776-7.319367-2.61203-11.103361-1.00164-5.999038-1.25683-12.026556-1.07049-18.099458.15781-3.468309.76516-7.086829 1.79952-10.394254.64699-1.974316 1.63337-3.824169 2.48746-5.7485 1.81963 1.486138 2.86594 3.671816 3.9004 5.728955.64108 1.500012.97375 3.161278.76757 4.790577-.65333-.253181-1.39605-.122429-1.84271.440021-1.42475 1.127514-2.85059 2.25365-4.27448 3.382244 1.88905.912209 4.07218 1.774111 6.16993 1.046875 1.41721-.500184 2.61209-1.460186 3.82031-2.322265 1.61109-1.433166 2.12717-3.722659 1.84286-5.796283-.25541-3.407249-2.01838-6.471843-3.90241-9.234739-1.20503-1.564932-2.69095-3.179269-4.68989-3.629264-2.29359-.240154-4.23277 1.369272-5.7447 2.892708-1.43661 2.020458-2.19043 4.395461-3.26252 6.599693-1.49815 3.623296-2.20417 7.528274-2.57907 11.414395-.28341 3.951365-.19329 7.924341.002 11.877608.33001 4.919807.95661 9.833736 2.05577 14.642753.86678 3.567725 1.99782 7.062219 3.05361 10.576879-3.15033-1.782655-6.31477-3.575686-9.24095-5.712379-2.79226-2.230651-4.33102-5.569215-5.59547-8.821527-1.43467-3.856976-2.08138-7.93959-3.1517-11.901307-1.2033-4.621024-2.39596-9.284022-4.32968-13.665113-2.65871-5.844039-6.70058-11.067953-11.71736-15.073502-1.61991-1.219808-3.40929-2.21157-5.31445-2.910157-.0794.0625-.15886.125-.23828.1875z"/><path id="path454" style="fill:#000;stroke-width:.204716" d="m254.32422 60.896484c-2.83006.191036-5.03358 2.200857-7.25961 3.693573-2.47583 1.745762-4.35875 4.322203-5.13274 7.262544-.87682 3.10457-.8925 6.386041-.66333 9.580213.28103 2.760325 1.40168 5.413874 3.21193 7.520311 1.70594 2.226415 3.96523 4.02624 6.58223 5.060539 1.96205.825143 4.24546 1.477142 6.30644.60157.53052-.223408-.579.488221-.79955.696267-3.55669 2.717013-6.96075 5.643309-10.03806 8.898339-3.00732 3.02489-5.58812 6.54712-7.09012 10.56555-1.52988 3.64022-2.18897 7.75831-1.16537 11.62585 1.1817 4.89934 4.89376 9.02479 9.55065 10.89607 3.31904 1.41685 6.8989 2.15208 10.47421 2.53862 1.33062.14817 2.74633-.0804 3.79142-.97127 1.26107-.73033 2.85276-1.49217 3.09455-3.10504.98221-4.40417.4144-8.94054.57187-13.40766.0559-9.78704-.13373-19.58303.15814-29.363921.22294-.322518.70593-.47792.98565-.786323 3.15772-2.482196 6.24325-5.094621 9.44181-7.481219.59962-.562387 1.37371-1.333493 1.12122-2.214688-.58838-1.019752-1.9005-.72381-2.80832-.393333-1.78507.665067-3.47142 1.597264-4.9082 2.856236-1.27226.954663-2.48458 2.004466-3.71388 2.992226.0582-1.808273-.2238-3.702052.46966-5.419967 1.29511-4.12273 1.38265-8.583115.37497-12.777365-.40543-2.092479-.5444-4.224875-.57901-6.349544-.12138-1.041696-1.27545-1.792292-2.25563-1.339589-.44131.07748-.73882.621708-1.12056.653678-2.66594-1.25476-5.64308-1.684906-8.56131-1.835573zm.33203 5.285157c2.01725.246306 4.08801.70676 5.74023 1.958984.49385-.198426.10745 1.069897.2356 1.480834.0141 5.004454.0397 10.022836-.26491 15.015164-.54725 1.610021-1.37948 3.119937-2.27537 4.560643-.29357.413619-.64502.972024-1.23854.753886-2.97677-.555212-5.7871-2.226129-7.55638-4.708964-1.73668-1.945495-2.4821-4.544038-2.47151-7.147851-.0102-2.492946.0306-4.99488.91085-7.343489.73261-1.875515 1.96563-3.730677 3.8265-4.614744 1.01134-.351459 2.06471-.0229 3.09353.04554zm5.48437 34.769529c-.0724 10.74931.0496 21.50087-.0827 32.24888-.0316.50518-.0784 1.00973-.14971 1.51089-3.6299-.36444-7.17132-1.2816-10.41387-2.97137-3.31505-1.88151-5.62981-5.38503-6.00686-9.18451-.34732-2.69647.25495-5.42026 1.34629-7.88372 1.31942-3.35117 3.42797-6.40619 5.95909-8.88755 2.88063-3.07638 6.02153-5.910197 9.37903-8.457618-.0104 1.208333-.0208 2.416667-.0313 3.624998z"/><path id="path456" style="fill:#000;stroke-width:.204716" d="m286.45117 62.744141c-.66276.0108-1.0893.579612-1.58984.919921-2.93216-.416883-6.1457-.03654-8.52713 1.859521-1.32775.839426-2.71795 1.775792-3.34291 3.285064-1.96619 3.59837-2.81372 7.799977-2.48463 11.879219.58618 4.391569 3.77417 8.360576 8.02068 9.714478 3.09823 1.057475 6.42957 1.208399 9.67383 1.054687 2.00132-.177732 3.83824-1.164999 5.41409-2.288612 1.93792-1.221245 3.80495-2.745567 4.75664-4.887712 1.27631-2.582436 2.06687-5.395576 2.51547-8.233505.29359-2.654253-1.0275-5.228394-2.7852-7.132573-2.12288-2.207611-4.88968-3.643737-7.64514-4.897051-1.24663-.488298-2.51233-.998051-3.82059-1.270293-.0615.0067-.12392-.01566-.18527-.0031zm-.76172 5.544921c1.33874.466153 2.72682 1.108914 3.99146 1.820734 2.3343 1.241606 4.77095 2.977239 5.44214 5.689032.34285 2.011522-.5266 3.97606-1.06266 5.878051-.57623 1.593021-1.21802 3.351886-2.6703 4.347853-1.85437.702929-3.8863.346015-5.81627.291151-2.9267-.216886-6.09721-1.13898-7.8626-3.659801-1.58319-2.125298-1.94862-4.931501-1.41712-7.483183.34601-2.202505.95334-4.411407 2.16488-6.305711 1.72955-.549238 3.55003-.159042 5.2991.01258.58196.0145 1.07248-.33425 1.44114-.750866.16341.05339.32682.106771.49023.160156z"/><path id="path458" style="fill:#000;stroke-width:.204716" d="m312.22656 63.080078c-2.51287-.06687-4.65817 1.475076-6.57812 2.91211-2.04617 1.597902-3.36366 3.956301-3.96106 6.457589-.69758 2.785863-.78555 5.72098-.38894 8.557054.45501 2.562579 1.62143 5.141346 3.83069 6.648159 2.22165 1.784303 4.86213 3.031589 7.67199 3.533149 3.55108.707794 7.20025.635324 10.80301.591013 2.16637-.158142 4.39539-.452498 6.36267-1.410011 2.07587-1.747288 3.95151-3.712247 5.70312-5.78125-2.79921.445598-5.49844 1.330936-8.26339 1.923705-3.39336.425307-6.83433.249648-10.23012-.04257-3.24745-.407049-6.52917-1.646109-8.82841-4.041056-.87222-1.044913-1.21587-2.282305-1.45637-3.562052-.26964-2.262109-.13957-4.588823.36966-6.808958.33731-1.374369.93104-2.721367 1.91644-3.756179 2.37937-.429241 4.84399.104078 7.07813.939453 1.11063.442475 2.11782 1.117109 2.96875 1.955078 1.69271-1.222252 3.38676-2.442646 5.08008-3.664062-2.66632-2.652709-6.35737-4.016762-10.05096-4.376845-.67268-.08546-1.35003-.09118-2.02717-.07433z"/><path id="path460" style="fill:#000;stroke-width:.204716" d="m286.07422 99.496094c-1.07934-.0024-1.82247.939246-2.52539 1.519526-.851.70779-1.76177 1.34363-2.75 1.84571.10409 1.4247 1.00637 2.71545 2.30403 3.3049 1.0993.9205 2.58927 1.76482 4.04753 1.17752 1.90839-.57603 3.60529-2.60159 3.03127-4.66604-.24239-1.55382-1.36304-3.209315-3.09377-3.187476-.33817.0088-.67622-.02649-1.01367.0059z"/><path id="path464" style="fill:#000;stroke-width:.204716" d="m371.67188 20.626953c-3.87604 1.944717-7.75613 3.888659-11.47852 6.119141 1.10416-.0044 2.20833-.0089 3.3125-.01172-2.12786 4.917471-2.2546 10.388689-2.12305 15.660156.35129 5.01355 2.02586 9.810998 3.70363 14.509646 1.38866 3.777132 2.7827 7.452227 3.66164 11.3659.85336 3.402855 1.29928 6.910206 1.308 10.447135.0802 4.183874.21652 8.436832-.61619 12.533292-.82952 4.256594-2.10342 8.496467-4.44794 12.181686-1.27591 2.17814-2.95847 4.09056-4.92893 5.66614-1.4947 1.30394-3.28466 2.42294-5.1431 2.96612-2.39632.75818-4.8139.92992-7.31504.96576-1.38398-.001-2.76732-.6657-3.42811-1.91942-1.17952-1.92247-1.43828-4.29667-1.23452-6.50088-.072-.59683.49407-.45599.8906-.49906.4488-.0105 1.13089-.11797 1.17301.51024.41153 1.70485.26658 3.48863.31896 5.23047 71e-5.68229.002 1.36459.003 2.04688 1.90405-1.12478 3.80883-2.24831 5.7129-3.37305-.13258-2.7825.25622-5.8613-1.42774-8.28125-.9124-1.199373-2.54906-1.368673-3.94062-1.215946-1.58257-.05091-3.231.243516-4.50269 1.241586-2.01363 1.04845-3.69566 2.97113-3.89001 5.30511-.35901 2.56593.15031 5.20715 1.10217 7.59326 1.08182 2.48207 3.33319 4.66552 6.14699 4.84641 2.41571.25391 4.83773-.17138 7.23065-.45987 3.43975-.6249 6.46732-2.49346 9.27287-4.49033 3.70335-2.48113 7.17849-5.51773 9.32948-9.48525 2.76734-4.614072 4.23626-9.901741 4.96799-15.199902.5525-4.277499.36306-8.601147.27024-12.900272-.10538-3.360412-.59916-6.701988-1.5034-9.941147-1.01323-4.310005-2.61015-8.445066-4.11035-12.599558-1.15953-3.383432-2.2477-6.765931-2.76717-10.283458-.33024-3.191741-.23107-6.55122.089-9.779123.36915-3.275313 1.43804-6.518457 3.45986-9.153927.90985-1.339577 1.8197-2.679149 2.72974-4.018598-.60873.307943-1.21745.615885-1.82617.923828z"/><path id="path466" style="fill:#000;stroke-width:.204716" d="m378.41211 36.992188c-2.95498.280324-5.86099.959554-8.72191 1.726685-3.48706 1.125695-6.68165 3.068917-9.47059 5.423031-2.56647 2.52845-3.92486 5.941757-5.55982 9.083275-.82608 1.721803-1.65239 3.443491-2.47815 5.165446 2.4334-1.275762 4.86732-2.550527 7.30078-3.826172 1.48474-3.078592 2.82421-6.267576 5.04492-8.919922.37009-.484192 1.06101-.352533 1.4769-.805542.96403-.824462 2.26732-1.015047 3.43718-1.415431 2.16001-.556031 4.36494-1.020535 6.56444-1.321996 1.63608-.05267 2.81813 1.277896 3.61272 2.548816 1.61011 2.517063 2.53967 5.509476 2.17683 8.471365-.15926.806383-.30463 1.757669-.91027 2.335911-1.23529.812349-2.5271 1.570455-3.64881 2.53258-1.05465 1.010852-1.29014 2.99378.005 3.90959 1.10397.771221 2.48005.146732 3.46359-.520192 1.29018-.710688 2.43727-1.673469 3.63473-2.496494 3.70686-.791836 7.53625-.861897 11.30656-.662435 1.77784.291901 3.18039 1.611104 4.02392 3.142913 2.57898 3.825958 4.24413 8.148004 4.98248 12.705642.67022 3.616411 1.12179 7.379282.74216 11.014872-.34106 1.748258-.84725 3.691605-1.96926 5.175636-.96893.649595-2.1745.835524-3.28802 1.122337-2.6009.548228-5.39227.396336-7.7976-.803806-2.77349-1.192048-5.22531-3.0329-7.28016-5.233016-.3945-.779099-.90346-.07995-1.38135.226711-1.35242.977451-2.70594 1.953363-4.05756 2.931914 2.24054 2.398724 4.74359 4.601413 7.68825 6.093768 3.25183 1.841965 7.13161 2.665009 10.82624 1.922007 3.6294-.612513 7.11555-2.286566 9.77115-4.844758 1.96335-2.122487 2.68295-5.045637 3.19814-7.807952.3987-5.091629-.44666-10.18885-1.56074-15.141305-1.05935-4.233613-3.02767-8.207304-5.51137-11.780005-1.25317-1.797572-3.09833-3.242237-5.29091-3.639442-2.34828-.50242-4.76173-.155362-7.13833-.149969-1.48293.0791-2.96525.208398-4.43164.447266 1.1072-4.302368-.25828-8.87208-2.60303-12.520248-1.37932-2.074659-3.51292-4.084833-6.15674-4.09108z"/><path id="path468" style="fill:#000;stroke-width:.204716" d="m423.28906 62.134766c-1.63995.97054-3.28033 1.94036-4.92187 2.908203-.005 4.860224-.0554 9.74159.63518 14.564078.26451 3.642161-.0516 7.367269.98576 10.916826.42202 1.528949.57544 3.428854 2.02945 4.374565 1.67804 1.119853 3.85376.452608 5.42395-.533389 2.15482-1.410381 4.32474-2.885565 5.95208-4.915798 1.06489-1.237277 1.93975-2.619085 2.8603-3.962923-2.69521.780684-5.50568 1.495949-7.83152 3.126296-.73545.615066-1.29977 1.758673-2.3345 1.799485-.65265-2.346208-1.1458-4.764948-1.22309-7.213103-.001-3.183751-.28693-6.355244-.63761-9.516081-.28356-3.960842-.13171-8.020399-.13344-12.024722-.26823.158854-.53646.317708-.80469.476563z"/><path id="path470" style="fill:#000;stroke-width:.204716" d="m421.32422 50.556641c-1.07185.409354-1.82089 1.344889-2.78081 1.947169-.73001.555316-1.46029 1.110263-2.18989 1.666112 1.19469.615669 2.29216 1.471247 3.61328 1.802734-.0189 1.007812-.038 2.015621-.0566 3.023438 1.91341-1.124993 3.82781-2.248329 5.74023-3.375.0396-1.199558-.0142-2.413731.24219-3.587891-.0222-1.061754-1.27193-1.818341-2.21354-1.303916-.4361.07207-.95475.446837-1.31358.0097-.30768-.168724-.69727-.282971-1.04124-.182359z"/><path id="path474" style="fill:#000;stroke-width:.204716" d="m478.08398 8.6914062c-3.04434.14731-5.7197 1.8438508-8.10248 3.6007978-1.72765 1.357081-2.97442 3.250966-3.63815 5.337598-2.26887 6.050536-2.21342 12.612826-2.40727 18.981009-.15743 8.550261.61576 17.100356 1.57762 25.572923.191 1.852456.35825 3.707256.52146 5.56236-2.14353 4.328099-4.51967 8.591659-7.70401 12.250805-2.36409 2.930614-4.6741 5.893283-7.25693 8.60857-1.23948.310478-2.55965.07497-3.80664-.115235-2.07257-.364678-3.86782-1.59835-5.23261-3.16249-1.81027-2.033779-3.15103-4.509976-3.85346-7.138711-.58177-3.373649.71016-6.7518 2.34552-9.649041.48255-.732833.88067-1.621841 1.6468-2.092726 2.34007-.143427 4.64989.535834 6.77539 1.46875.99634-.283035 1.63883-1.177063 2.49285-1.713624.99586-.778422 1.99114-1.557572 2.98762-2.335204-3.46085-1.340304-7.09892-2.967477-10.89987-2.427405-2.11783.508015-3.79571 2.000439-5.52392 3.235425-2.68145 2.341808-4.00679 5.78142-5.09379 9.076745-.89502 3.13538-.75704 6.605691.71513 9.548105 1.7092 3.847785 4.41928 7.489981 8.28686 9.356697 2.33088 1.021718 4.95868 1.325034 7.47457 1.052229 2.3056-.511534 4.29585-1.953137 6.00586-3.52539 2.54674-2.587205 4.77423-5.461403 7.04935-8.278252 1.52223-1.934278 3.11838-3.823289 4.42135-5.917061.59397 4.795158.8271 9.581025.6875 14.417969.0867 1.188555-.17941 2.681701.89258 3.509766.8519.734443 2.1919.630446 2.95133-.187286.77818-.629943 1.39784-1.430245 2.18539-2.050996.33463-4.101681.12961-8.221072.17483-12.330182-.0958-2.588148-.18458-5.17999-.3428-7.763568-.3245-1.63234-.58546-3.442123.28436-4.958718.51754-.816296 1.63351-.855617 2.47541-1.136985 1.29347-.223993 2.66956-.428758 3.95583-.11448 1.70322.767865 2.36308 2.681045 3.25511 4.18284 2.45359 5.01299 2.5034 10.662947 3.45117 16.066406.39453 1.998924.93975 4.059017 2.15761 5.723926 1.20516 1.352908 3.27678 1.341194 4.82481.637402 4.38174-1.593728 8.19236-4.35232 12.07422-6.859375 1.31644-.900078 2.96011-1.738505 3.51562-3.339844.18957-1.049313-1.14649-1.612884-1.96679-1.169922-.35611.233689-.66171.381595-1.10399.363009-2.26559.572321-3.99719 2.262336-6.02241 3.343699-2.07882 1.256166-4.16238 2.484729-6.55915 3.076496-.54459-.626324-.63649-1.53044-.94141-2.28711-.9522-3.598937-.99491-7.326699-1.76776-10.965895-.59128-3.450187-1.70586-6.83908-3.59788-9.802482-1.17173-2.100903-3.12486-4.124232-5.67959-4.213301-1.78692-.04961-3.60589.110612-5.3292.60205-.7058.211269-1.39123.486775-2.05525.805409 3.21714-7.057532 5.53801-14.470846 8.14459-21.764942 1.39013-3.996916 2.6535-8.095743 2.86422-12.350426.27986-3.961867.2851-7.946035.11578-11.911498-.22997-2.048169-.57126-4.334547-2.12459-5.8286024-1.48757-1.1781658-3.52717-.9718637-5.30079-.9902344zm-1.34765 5.0468748c.75756.100169 1.59662-.102993 2.29883.236328 1.20912 2.467702.83156 5.298741.93641 7.954687.0175 5.110463-.15302 10.311699-1.90356 15.185035-2.1116 6.637828-4.48624 13.179085-6.98769 19.684909-.22521.70112-.41136 1.033956-.41626.0992-.7906-7.151956-1.36504-14.321603-1.13549-21.539947.1018-5.837394.16128-11.671654 2.02378-17.234781.55964-1.515727 1.23048-3.250281 2.74843-4.035819.79358-.213639 1.61188-.339885 2.43555-.34961zm-4.6543 76.720703c.62866.420068-.45727 1.13443-.58012.305527-.23418-.244089.43497-.422407.58012-.305527z"/><path id="path476" style="fill:#000;stroke-width:.204716" d="m444.84375 25.214844c-1.64773.385233-3.25602 1.067363-4.67561 1.987852-2.04086 1.6493-3.49412 3.884237-5.29746 5.771289-2.66063 2.970824-5.68987 5.575842-8.77289 8.092454-.58007.602259-1.39502 1.328599-1.25795 2.242155.25323.910636 1.38471.929547 2.11011.630268 1.39615-.334178 2.69141-1.03155 3.91085-1.761623 4.12198-3.246933 7.92443-6.902681 11.24802-10.966954 1.09459-1.394037 2.48316-2.522459 3.55811-3.926379.59161-.629078.42113-1.908335-.5224-2.035859-.10001-.0081-.19903-.06601-.30078-.0332z"/><path id="path510" style="fill:#000;stroke:#000;stroke-width:.0832446" d="m156.66797 65.568359c-1.40281.04819-2.00876 2.164215-.79102 2.908203 1.10643.978518 2.94358-.355474 2.51367-1.714843-.18241-.751321-.9599-1.271376-1.72265-1.19336z"/><path id="path512" style="fill:#000;stroke:#000;stroke-width:.0832446" d="m156.66797 65.568359c-1.40281.04819-2.00876 2.164215-.79102 2.908203 1.10643.978518 2.94358-.355474 2.51367-1.714843-.18241-.751321-.9599-1.271376-1.72265-1.19336z"/><path id="path1432" style="fill:#000;stroke-width:.202157" d="m94.878906 30.269531c-2.287631.898028-4.703901 1.605195-6.807724 2.877579-4.485024 5.491989-6.611133 12.401509-8.442948 19.132856-1.605329 6.046121-2.840557 12.204453-4.985613 18.095796-2.771657 8.014773-6.035967 15.844748-10.868943 22.859542-1.749947 2.479612-3.601343 4.885482-5.392819 7.335006 2.85849-1.26468 5.716446-2.530574 8.574219-3.796872 6.610002-8.720957 10.691919-19.019319 14.096589-29.330787 2.790753-8.7136 4.127071-17.89265 7.79901-26.319883 1.235636-2.821633 2.900303-5.441874 4.898209-7.783699.952846-1.237371 1.905694-2.474742 2.858536-3.712116-.576172.214193-1.152344.428386-1.728516.642578z"/><path id="path1434" style="fill:#000;stroke-width:.202157" d="m93.257812 30.740234c-1.733368.858571-3.440196 1.845878-5.164062 2.751954.810252 5.34993 3.024219 10.347909 4.425405 15.521466 2.072478 6.784453 3.847313 13.681516 5.505429 20.598588 1.180239 4.908903 1.729165 9.94751 2.987136 14.836977.96649 3.670046 2.49394 7.275685 4.9564 10.198384.78807.844102 1.64803 1.682248 2.67836 2.213725.88334.191728 1.43837-.72189 2.17288-1.03501 1.14091-.744883 2.2825-1.48873 3.42283-2.234521-1.77857-1.19183-3.63718-2.460542-4.64263-4.417814-3.0829-4.597975-3.70366-10.234336-4.77902-15.52966-.8585-4.588927-2.03141-9.108024-3.16222-13.634617-.51284-2.223885-1.15403-4.419896-1.735477-6.627752-1.569505-5.662739-3.34325-11.323358-5.050111-16.90562-.517229-1.710922-.87143-3.482123-.92156-5.26735-.0439-.278108-.408679-.604452-.69336-.46875zm7.623048 27.275391c-.2376.743408-1.454441-.29859-.48492-.165475.15225.06679.66504-.188859.48492.165475z"/><path id="path1440" style="fill:#000;stroke-width:.202157" d="m93.693359 58.945312c-4.070097.13705-8.123695.652337-12.201562.568416-3.492748.01042-6.98542-.0175-10.478125-.02935-2.241288 1.678066-4.483664 3.354679-6.72461 5.033203 6.767011-.175815 13.540661.04814 20.304958-.196194 5.878883-.507678 11.806803-.677339 17.69857-.02042 1.78153.149956 3.55694.456984 5.32078.675666 1.05621-.117502 1.71027-1.096398 2.59049-1.591397 1.38565-1.016663 2.77006-2.035027 4.15747-3.049296-3.12468-.07048-6.17775-.620639-9.27187-.956016-3.16628-.218965-6.328998-.549518-9.507395-.458409-.629656-.01131-1.259141.01642-1.888706.0238z"/><path id="path1442" style="fill:#000;stroke-width:.202157" d="m137.80273 32.195312c-.71131-.02645-1.22365.533659-1.76757.896485-3.32296-.648355-6.5358.949258-9.31521 2.591857-4.13708 2.423361-8.39589 5.160194-10.8685 9.405801-2.81817 4.65217-3.70379 10.122397-4.38312 15.431557-.71678 4.62043-.63171 9.312129-.6621 13.974246-.17073 3.941542 1.22301 7.714025 2.78316 11.263402 1.47756 3.374971 2.98687 6.93403 5.78974 9.440876 2.60206 2.103977 5.98229 2.938743 9.26997 3.079382 3.01616.178255 6.04839.197489 9.0654.05924 3.25526-.352297 6.13656-2.210964 8.52083-4.353872 1.9125-1.802379 3.23536-4.122029 4.467-6.415823 1.96654-3.819715 2.97141-8.06343 3.32178-12.327816.63197-6.298061.53467-12.640058.51157-18.961602-.31286-6.555578-3.34059-12.6311-7.00772-17.94516-1.36398-2.116257-3.08084-4.117768-5.41961-5.176398-1.33498-.643965-2.82253-.990471-4.30562-.962179zm.92969 5.699219c2.47608 1.49523 3.89223 4.131017 5.42803 6.481762 2.3619 3.875065 4.21223 8.273459 4.57393 12.778004.10946 3.540014.0754 7.199129.0226 10.786117-.13267 4.59801-.30727 9.207498-1.382 13.719742-.93846 3.818379-2.73823 7.354917-5.25828 10.371228-.54974.799923-1.41776 1.322856-2.39992 1.343616-2.75225.198886-5.52039.102639-8.2763.011-2.77568-.07296-5.73025-.633233-7.86708-2.529377-2.10928-2.179327-3.28872-5.047642-4.51317-7.774861-1.11282-2.692425-2.33357-5.39614-2.44851-8.361666-.14085-3.190521-.0674-6.390597.0562-9.581427.14975-3.270265.65943-6.610104 1.17386-9.878406.69163-3.869378 1.85813-7.786775 4.2574-10.998784 1.95471-2.475077 4.54847-4.446958 7.40796-5.758508 1.93693-.843915 4.24175-.844849 6.06259.206969.44889.199604.90067.715415 1.31312.18647.57632-.317847 1.12482-.8901 1.71804-1.053332l.0931.03644z"/><path id="path2471" style="fill:#000;stroke-width:.202157" d="m19.875-1.1464844c-2.467326.20038379-4.416995 1.8977635-6.465485 3.1000412-2.092157 1.6351412-3.347691 4.0900298-4.3407045 6.4976497-1.162515 3.0913185-1.9649042 6.3534035-2.1332636 9.6581685-.020817 3.848753 1.14656 7.564265 2.0214843 11.275391.9423091 3.535474 1.9990858 7.038851 3.0273438 10.550781-3.558475 2.085762-7.2987095 4.432847-9.2179466 8.23808-1.91058832 3.644811-3.22225643 7.686999-3.32760678 11.823119.0280441 1.872592 1.03030634 3.785445 2.80262948 4.546582 2.8585542 1.517064 6.1649538 1.732272 9.3167369 2.130179 2.211118.216219 4.432631.329845 6.654703.314774.344948 5.553728.702102 11.179714-.130052 16.708708-.113818.436681-.01061 1.276409-.671293.840427-3.346086-.889374-7.010389-.937983-10.2533429.368834-1.4220886.706309-2.8423797 1.439918-4.1587002 2.330061-1.4833855 1.011485-2.50642305 2.816075-2.15738584 4.639764.27670544 1.50483.83204454 2.946746 1.31812824 4.392702 1.0029707 2.447538 2.6634652 4.859863 5.174811 5.915053 1.664462.60635 3.4565307-.0423 4.8542497-.98599 2.199044-1.234 4.187541-2.882528 5.579001-5.004834 1.075465-1.478272 2.02244-3.044267 2.962162-4.610975 3.73972 1.912958 7.639363 3.750579 11.866027 4.220964 5.229014.819247 10.534141 1.238137 15.827896 1.103707 4.609822-.188519 9.320543-1.100025 13.28447-3.57145 2.628989-1.435801 5.127933-3.288571 6.707934-5.886007 2.551407-3.93756 3.549201-8.680994 3.793283-13.30966.08651-4.065033-.232752-8.209911-1.679065-12.044616-1.683663-4.622633-4.346852-8.915431-7.956449-12.282379-4.78356-4.628438-10.902243-7.535639-17.076681-9.825795-7.576235-2.890711-15.799324-3.887274-23.870477-3.415234-1.45148.184805-2.908547.38467-4.31686.793673-1.772122-6.15093-3.742629-12.328265-4.585432-18.662232-.243926-3.049717.472069-6.06426 1.365298-8.9933226.743461-2.0621443 1.62728-4.2323716 3.323377-5.6960226.804625-.5857958 1.775496.026879 2.575239.3129153.608663.2214678 1.178371.9384883.681754 1.546329-.687235 1.1336659-1.997566 1.6924602-2.676648 2.8375411-.420302.6993466-1.297068 1.3490728-.984369 2.2680738.448857.947951 1.697752.638275 2.485067.36589 1.793577-.782484 3.519119-1.7891435 5.009073-3.0651091 1.372296-1.2711291 2.618085-3.140637 2.133059-5.0953206-.549199-2.41423932-3.002514-3.84881267-5.297121-4.2288982-.484264-.078-.974257-.1160508-1.464844-.1015625zm2.066406 42.4824224c5.853967-.03158 11.785551.546324 17.387283 2.30404 4.052566 1.30083 8.026984 2.903842 11.762369 4.951333 5.171419 2.854776 9.830438 7.20005 12.475348 12.525877 1.234364 2.513606 2.149442 5.042218 2.600007 7.830174.348285 2.619998.47256 5.234756.24345 7.882353-.425086 3.919758-1.452478 7.980039-4.029004 11.066769-.637384.750619-1.422851 1.348609-2.123047 2.027344-3.417276 1.602835-7.25638 2.104568-11.001905 2.182687-4.985171.02644-9.943714-.403025-14.861623-1.232555-3.16245-.549877-6.092862-1.904429-8.944116-3.320687-.838298-.398379-1.679269-.793986-2.540012-1.141164 1.812739-5.97312 1.288897-12.293939 1.067125-18.439473.08478-.454615-.401074-1.38791.322921-1.299128 3.346957-.366107 6.725447-.875339 9.86123-2.155826 2.572518-.853242 5.295532-1.091423 7.965567-1.478959.642141-.03087 1.250964-.146033 1.697525-.648911 2.229063-1.713274 4.457918-3.426817 6.687195-5.139812-4.945597.703564-9.950537 1.113255-14.814788 2.283884-1.61454.601637-3.200266 1.331198-4.929937 1.532373-2.392654.476772-4.818149.835899-7.265041.964993-.635149-6.333213-1.951949-12.621946-4.230469-18.576172-.181271-.560347-.446635-1.227831-.632812-1.841797 1.092247-.174855 2.197184-.257762 3.302734-.277343zm-8.710937 2.630859c1.73383 4.920162 3.416007 9.901736 4.097298 15.096077.154901 1.011684.293383 2.025855.410514 3.042595-3.639733-.157396-7.270674-.462804-10.7617185-1.548828-.916187-.285016-1.9318113-.99391-1.7441406-2.091797.067658-2.619841.815338-5.182345 1.7460937-7.615235 1.0452584-2.582819 2.7582053-5.072404 5.2017964-6.593561.355667-.148591.965967-1.118661 1.0366-.331886zM11.498047 88.84375c1.581425.113622 3.132072.488669 4.638672.970703-1.320122 2.612878-3.004131 5.040366-4.855469 7.300781-.497488.672024-1.249391-.0561-1.6745127-.424631-1.8941345-1.83007-2.544719-4.510543-3.0598623-6.995291.5756926-.538238 1.4988482-.576207 2.2554181-.731905.8912275-.117794 1.7976289-.18021 2.6957539-.119657z"/></svg>
</a>
</div><div class=searchbox>
<label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span>
</div><script type=text/javascript src=/js/lunr.min.js?1646795377></script>
<script type=text/javascript src=/js/auto-complete.js?1646795377></script>
<script type=text/javascript>var baseurl="https://artisanbox.github.io"</script>
<script type=text/javascript src=/js/search.js?1646795377></script>
</div><section id=homelinks>
<ul>
<li>
<a class=padding href=/><i class="fas fa-home"></i> Gen 的学习笔记</a>
</li></ul></section><div class=highlightable>
<ul class=topics>
<li data-nav-id=/1/ title=MySQL实战45讲 class="dd-item
parent">
<a href=/1/>
MySQL实战45讲
</a>
<ul>
<li data-nav-id=/1/1/ title=01_基础架构：一条SQL查询语句是如何执行的？ class=dd-item>
<a href=/1/1/>
01_基础架构：一条SQL查询语句是如何执行的？
</a>
</li><li data-nav-id=/1/2/ title=02_日志系统：一条SQL更新语句是如何执行的？ class=dd-item>
<a href=/1/2/>
02_日志系统：一条SQL更新语句是如何执行的？
</a>
</li><li data-nav-id=/1/3/ title=03_事务隔离：为什么你改了我还看不见？ class=dd-item>
<a href=/1/3/>
03_事务隔离：为什么你改了我还看不见？
</a>
</li><li data-nav-id=/1/4/ title=04_深入浅出索引（上） class=dd-item>
<a href=/1/4/>
04_深入浅出索引（上）
</a>
</li><li data-nav-id=/1/5/ title=05_深入浅出索引（下） class=dd-item>
<a href=/1/5/>
05_深入浅出索引（下）
</a>
</li><li data-nav-id=/1/6/ title=06_全局锁和表锁：给表加个字段怎么有这么多阻碍？ class=dd-item>
<a href=/1/6/>
06_全局锁和表锁：给表加个字段怎么有这么多阻碍？
</a>
</li><li data-nav-id=/1/7/ title=07_行锁功过：怎么减少行锁对性能的影响？ class=dd-item>
<a href=/1/7/>
07_行锁功过：怎么减少行锁对性能的影响？
</a>
</li><li data-nav-id=/1/8/ title=08_事务到底是隔离的还是不隔离的？ class=dd-item>
<a href=/1/8/>
08_事务到底是隔离的还是不隔离的？
</a>
</li><li data-nav-id=/1/9/ title=09_普通索引和唯一索引，应该怎么选择？ class=dd-item>
<a href=/1/9/>
09_普通索引和唯一索引，应该怎么选择？
</a>
</li><li data-nav-id=/1/10/ title=10_MySQL为什么有时候会选错索引？ class=dd-item>
<a href=/1/10/>
10_MySQL为什么有时候会选错索引？
</a>
</li><li data-nav-id=/1/11/ title=11_怎么给字符串字段加索引？ class=dd-item>
<a href=/1/11/>
11_怎么给字符串字段加索引？
</a>
</li><li data-nav-id=/1/12/ title=12_为什么我的MySQL会“抖”一下？ class=dd-item>
<a href=/1/12/>
12_为什么我的MySQL会“抖”一下？
</a>
</li><li data-nav-id=/1/13/ title=13_为什么表数据删掉一半，表文件大小不变？ class=dd-item>
<a href=/1/13/>
13_为什么表数据删掉一半，表文件大小不变？
</a>
</li><li data-nav-id=/1/14/ title=14_count(x)这么慢，我该怎么办？ class=dd-item>
<a href=/1/14/>
14_count(x)这么慢，我该怎么办？
</a>
</li><li data-nav-id=/1/15/ title=15_答疑文章（一）：日志和索引相关问题 class=dd-item>
<a href=/1/15/>
15_答疑文章（一）：日志和索引相关问题
</a>
</li><li data-nav-id=/1/16/ title=16_“orderby”是怎么工作的？ class=dd-item>
<a href=/1/16/>
16_“orderby”是怎么工作的？
</a>
</li><li data-nav-id=/1/17/ title=17_如何正确地显示随机消息？ class=dd-item>
<a href=/1/17/>
17_如何正确地显示随机消息？
</a>
</li><li data-nav-id=/1/18/ title=18_为什么这些SQL语句逻辑相同，性能却差异巨大？ class=dd-item>
<a href=/1/18/>
18_为什么这些SQL语句逻辑相同，性能却差异巨大？
</a>
</li><li data-nav-id=/1/19/ title=19_为什么我只查一行的语句，也执行这么慢？ class=dd-item>
<a href=/1/19/>
19_为什么我只查一行的语句，也执行这么慢？
</a>
</li><li data-nav-id=/1/20/ title=20_幻读是什么，幻读有什么问题？ class=dd-item>
<a href=/1/20/>
20_幻读是什么，幻读有什么问题？
</a>
</li><li data-nav-id=/1/21/ title=21_为什么我只改一行的语句，锁这么多？ class=dd-item>
<a href=/1/21/>
21_为什么我只改一行的语句，锁这么多？
</a>
</li><li data-nav-id=/1/22/ title=22_MySQL有哪些“饮鸩止渴”提高性能的方法？ class=dd-item>
<a href=/1/22/>
22_MySQL有哪些“饮鸩止渴”提高性能的方法？
</a>
</li><li data-nav-id=/1/23/ title=23_MySQL是怎么保证数据不丢的？ class=dd-item>
<a href=/1/23/>
23_MySQL是怎么保证数据不丢的？
</a>
</li><li data-nav-id=/1/24/ title=24_MySQL是怎么保证主备一致的？ class=dd-item>
<a href=/1/24/>
24_MySQL是怎么保证主备一致的？
</a>
</li><li data-nav-id=/1/25/ title=25_MySQL是怎么保证高可用的？ class=dd-item>
<a href=/1/25/>
25_MySQL是怎么保证高可用的？
</a>
</li><li data-nav-id=/1/26/ title=26_备库为什么会延迟好几个小时？ class=dd-item>
<a href=/1/26/>
26_备库为什么会延迟好几个小时？
</a>
</li><li data-nav-id=/1/27/ title=27_主库出问题了，从库怎么办？ class=dd-item>
<a href=/1/27/>
27_主库出问题了，从库怎么办？
</a>
</li><li data-nav-id=/1/28/ title=28_读写分离有哪些坑？ class=dd-item>
<a href=/1/28/>
28_读写分离有哪些坑？
</a>
</li><li data-nav-id=/1/29/ title=29_如何判断一个数据库是不是出问题了？ class=dd-item>
<a href=/1/29/>
29_如何判断一个数据库是不是出问题了？
</a>
</li><li data-nav-id=/1/30/ title=30_答疑文章（二）：用动态的观点看加锁 class=dd-item>
<a href=/1/30/>
30_答疑文章（二）：用动态的观点看加锁
</a>
</li><li data-nav-id=/1/31/ title=31_误删数据后除了跑路，还能怎么办？ class=dd-item>
<a href=/1/31/>
31_误删数据后除了跑路，还能怎么办？
</a>
</li><li data-nav-id=/1/32/ title=32_为什么还有kill不掉的语句？ class=dd-item>
<a href=/1/32/>
32_为什么还有kill不掉的语句？
</a>
</li><li data-nav-id=/1/33/ title=33_我查这么多数据，会不会把数据库内存打爆？ class=dd-item>
<a href=/1/33/>
33_我查这么多数据，会不会把数据库内存打爆？
</a>
</li><li data-nav-id=/1/34/ title=34_到底可不可以使用join？ class=dd-item>
<a href=/1/34/>
34_到底可不可以使用join？
</a>
</li><li data-nav-id=/1/35/ title=35_join语句怎么优化？ class=dd-item>
<a href=/1/35/>
35_join语句怎么优化？
</a>
</li><li data-nav-id=/1/36/ title=36_为什么临时表可以重名？ class=dd-item>
<a href=/1/36/>
36_为什么临时表可以重名？
</a>
</li><li data-nav-id=/1/37/ title=37_什么时候会使用内部临时表？ class=dd-item>
<a href=/1/37/>
37_什么时候会使用内部临时表？
</a>
</li><li data-nav-id=/1/38/ title=38_都说InnoDB好，那还要不要使用Memory引擎？ class=dd-item>
<a href=/1/38/>
38_都说InnoDB好，那还要不要使用Memory引擎？
</a>
</li><li data-nav-id=/1/39/ title=39_自增主键为什么不是连续的？ class=dd-item>
<a href=/1/39/>
39_自增主键为什么不是连续的？
</a>
</li><li data-nav-id=/1/40/ title=40_insert语句的锁为什么这么多？ class=dd-item>
<a href=/1/40/>
40_insert语句的锁为什么这么多？
</a>
</li><li data-nav-id=/1/41/ title=41_怎么最快地复制一张表？ class=dd-item>
<a href=/1/41/>
41_怎么最快地复制一张表？
</a>
</li><li data-nav-id=/1/42/ title=42_grant之后要跟着flushprivileges吗？ class=dd-item>
<a href=/1/42/>
42_grant之后要跟着flushprivileges吗？
</a>
</li><li data-nav-id=/1/43/ title=43_要不要使用分区表？ class="dd-item active">
<a href=/1/43/>
43_要不要使用分区表？
</a>
</li><li data-nav-id=/1/44/ title=44_答疑文章（三）：说一说这些好问题 class=dd-item>
<a href=/1/44/>
44_答疑文章（三）：说一说这些好问题
</a>
</li><li data-nav-id=/1/45/ title=45_自增id用完怎么办？ class=dd-item>
<a href=/1/45/>
45_自增id用完怎么办？
</a>
</li><li data-nav-id=/1/47/ title=开篇词_这一次，让我们一起来搞懂MySQL class=dd-item>
<a href=/1/47/>
开篇词_这一次，让我们一起来搞懂MySQL
</a>
</li><li data-nav-id=/1/48/ title=直播回顾_林晓斌：我的MySQL心路历程 class=dd-item>
<a href=/1/48/>
直播回顾_林晓斌：我的MySQL心路历程
</a>
</li><li data-nav-id=/1/46/ title=结束语_点线网面，一起构建MySQL知识网络 class=dd-item>
<a href=/1/46/>
结束语_点线网面，一起构建MySQL知识网络
</a>
</li><li data-nav-id=/1/49/ title=结课测试｜这些MySQL知识你都掌握了吗？ class=dd-item>
<a href=/1/49/>
结课测试｜这些MySQL知识你都掌握了吗？
</a>
</li></ul></li></ul><section id=footer>
<p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body>
<div id=overlay></div><div class="padding highlightable">
<div>
<div id=top-bar>
<div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb>
<span id=sidebar-toggle-span>
<a href=# id=sidebar-toggle data-sidebar-toggle>
<i class="fas fa-bars"></i>
</a>
</span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>
<a href=/>Gen 的学习笔记</a> > <a href=/1/>MySQL实战45讲</a> > 43_要不要使用分区表？
</span>
</div><div class=progress>
<div class=wrapper>
<nav id=TableOfContents></nav></div></div></div></div><div id=head-tags>
</div><div id=body-inner>
<h1>
43_要不要使用分区表？
</h1><p><audio title="43 _ 要不要使用分区表？" src=https://static001.geekbang.org/resource/audio/93/2d/933a010d2267de5eb3ffb0e52eea7f2d.mp3 controls></audio></p><p>我经常被问到这样一个问题：分区表有什么问题，为什么公司规范不让使用分区表呢？今天，我们就来聊聊分区表的使用行为，然后再一起回答这个问题。</p><h1>分区表是什么？</h1><p>为了说明分区表的组织形式，我先创建一个表t：</p><pre><code>CREATE TABLE `t` (
  `ftime` datetime NOT NULL,
  `c` int(11) DEFAULT NULL,
  KEY (`ftime`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1
PARTITION BY RANGE (YEAR(ftime))
(PARTITION p_2017 VALUES LESS THAN (2017) ENGINE = InnoDB,
 PARTITION p_2018 VALUES LESS THAN (2018) ENGINE = InnoDB,
 PARTITION p_2019 VALUES LESS THAN (2019) ENGINE = InnoDB,
PARTITION p_others VALUES LESS THAN MAXVALUE ENGINE = InnoDB);
insert into t values('2017-4-1',1),('2018-4-1',1);
</code></pre><p><img src=https://static001.geekbang.org/resource/image/06/f5/06f041129783533de9c75580f9decdf5.png alt></p><center><span class=reference>图1 表t的磁盘文件</span></center><p>我在表t中初始化插入了两行记录，按照定义的分区规则，这两行记录分别落在p_2018和p_2019这两个分区上。</p><p>可以看到，这个表包含了一个.frm文件和4个.ibd文件，每个分区对应一个.ibd文件。也就是说：</p><ul>
<li>对于引擎层来说，这是4个表；</li><li>对于Server层来说，这是1个表。</li></ul><p>你可能会觉得这两句都是废话。其实不然，这两句话非常重要，可以帮我们理解分区表的执行逻辑。</p><h1>分区表的引擎层行为</h1><p>我先给你举个在分区表加间隙锁的例子，目的是说明对于InnoDB来说，这是4个表。</p><p><img src=https://static001.geekbang.org/resource/image/d2/c7/d28d6ab873bd8337d88812d45b9266c7.png alt></p><center><span class=reference>图2 分区表间隙锁示例</span></center><p>这里顺便复习一下，我在<a href=https://time.geekbang.org/column/article/75659>第21篇文章</a>和你介绍的间隙锁加锁规则。</p><p>我们初始化表t的时候，只插入了两行数据， ftime的值分别是，'2017-4-1' 和'2018-4-1' 。session A的select语句对索引ftime上这两个记录之间的间隙加了锁。如果是一个普通表的话，那么T1时刻，在表t的ftime索引上，间隙和加锁状态应该是图3这样的。</p><p><img src=https://static001.geekbang.org/resource/image/27/d2/273c9ca869f5b52621641d73eb6f72d2.jpg alt></p><center><span class=reference>图3 普通表的加锁范围</span></center><p>也就是说，'2017-4-1' 和'2018-4-1' 这两个记录之间的间隙是会被锁住的。那么，sesion B的两条插入语句应该都要进入锁等待状态。</p><p>但是，从上面的实验效果可以看出，session B的第一个insert语句是可以执行成功的。这是因为，对于引擎来说，p_2018和p_2019是两个不同的表，也就是说2017-4-1的下一个记录并不是2018-4-1，而是p_2018分区的supremum。所以T1时刻，在表t的ftime索引上，间隙和加锁的状态其实是图4这样的：</p><p><img src=https://static001.geekbang.org/resource/image/92/5c/92f63aba0b24adefac7316c75463b95c.jpg alt></p><center><span class=reference>图4 分区表t的加锁范围</span></center><p>由于分区表的规则，session A的select语句其实只操作了分区p_2018，因此加锁范围就是图4中深绿色的部分。</p><p>所以，session B要写入一行ftime是2018-2-1的时候是可以成功的，而要写入2017-12-1这个记录，就要等session A的间隙锁。</p><p>图5就是这时候的show engine innodb status的部分结果。</p><p><img src=https://static001.geekbang.org/resource/image/e3/0f/e3d83d9ba89de9a6f541c9a2f24a3b0f.png alt></p><center><span class=reference>图5 session B被锁住信息</span></center><p>看完InnoDB引擎的例子，我们再来一个MyISAM分区表的例子。</p><p>我首先用alter table t engine=myisam，把表t改成MyISAM表；然后，我再用下面这个例子说明，对于MyISAM引擎来说，这是4个表。</p><p><img src=https://static001.geekbang.org/resource/image/94/76/941306d4a7193455dcf1cfebf7678876.png alt></p><center><span class=reference>图6 用MyISAM表锁验证</span></center><p>在session A里面，我用sleep(100)将这条语句的执行时间设置为100秒。由于MyISAM引擎只支持表锁，所以这条update语句会锁住整个表t上的读。</p><p>但我们看到的结果是，session B的第一条查询语句是可以正常执行的，第二条语句才进入锁等待状态。</p><p>这正是因为MyISAM的表锁是在引擎层实现的，session A加的表锁，其实是锁在分区p_2018上。因此，只会堵住在这个分区上执行的查询，落到其他分区的查询是不受影响的。</p><p>看到这里，你可能会说，分区表看来还不错嘛，为什么不让用呢？我们使用分区表的一个重要原因就是单表过大。那么，如果不使用分区表的话，我们就是要使用手动分表的方式。</p><p>接下来，我们一起看看手动分表和分区表有什么区别。</p><p>比如，按照年份来划分，我们就分别创建普通表t_2017、t_2018、t_2019等等。手工分表的逻辑，也是找到需要更新的所有分表，然后依次执行更新。在性能上，这和分区表并没有实质的差别。</p><p>分区表和手工分表，一个是由server层来决定使用哪个分区，一个是由应用层代码来决定使用哪个分表。因此，从引擎层看，这两种方式也是没有差别的。</p><p>其实这两个方案的区别，主要是在server层上。从server层看，我们就不得不提到分区表一个被广为诟病的问题：打开表的行为。</p><h1>分区策略</h1><p>每当第一次访问一个分区表的时候，MySQL需要把所有的分区都访问一遍。<strong>一个典型的报错情况</strong>是这样的：如果一个分区表的分区很多，比如超过了1000个，而MySQL启动的时候，open_files_limit参数使用的是默认值1024，那么就会在访问这个表的时候，由于需要打开所有的文件，导致打开表文件的个数超过了上限而报错。</p><p>下图就是我创建的一个包含了很多分区的表t_myisam，执行一条插入语句后报错的情况。</p><p><img src=https://static001.geekbang.org/resource/image/ab/e7/abfa0054ec43d97fb18ba3c1c8829ae7.png alt></p><center><span class=reference>图 7 insert 语句报错</span></center><p>可以看到，这条insert语句，明显只需要访问一个分区，但语句却无法执行。</p><p>这时，你一定从表名猜到了，这个表我用的是MyISAM引擎。是的，因为使用InnoDB引擎的话，并不会出现这个问题。</p><p>MyISAM分区表使用的分区策略，我们称为<strong>通用分区策略</strong>（generic partitioning），每次访问分区都由server层控制。通用分区策略，是MySQL一开始支持分区表的时候就存在的代码，在文件管理、表管理的实现上很粗糙，因此有比较严重的性能问题。</p><p>从MySQL 5.7.9开始，InnoDB引擎引入了<strong>本地分区策略</strong>（native partitioning）。这个策略是在InnoDB内部自己管理打开分区的行为。</p><p>MySQL从5.7.17开始，将MyISAM分区表标记为即将弃用(deprecated)，意思是“从这个版本开始不建议这么使用，请使用替代方案。在将来的版本中会废弃这个功能”。</p><p>从MySQL 8.0版本开始，就不允许创建MyISAM分区表了，只允许创建已经实现了本地分区策略的引擎。目前来看，只有InnoDB和NDB这两个引擎支持了本地分区策略。</p><p>接下来，我们再看一下分区表在server层的行为。</p><h1>分区表的server层行为</h1><p>如果从server层看的话，一个分区表就只是一个表。</p><p>这句话是什么意思呢？接下来，我就用下面这个例子来和你说明。如图8和图9所示，分别是这个例子的操作序列和执行结果图。</p><p><img src=https://static001.geekbang.org/resource/image/0e/81/0eca5a3190161e59ea58493915bd5e81.png alt></p><center><span class=reference>图8 分区表的MDL锁</span></center><p><img src=https://static001.geekbang.org/resource/image/af/a8/afe662f5e051a2ceb96a87624a589aa8.png alt></p><center><span class=reference>图9 show processlist结果</span></center><p>可以看到，虽然session B只需要操作p_2017这个分区，但是由于session A持有整个表t的MDL锁，就导致了session B的alter语句被堵住。</p><p>这也是DBA同学经常说的，分区表，在做DDL的时候，影响会更大。如果你使用的是普通分表，那么当你在truncate一个分表的时候，肯定不会跟另外一个分表上的查询语句，出现MDL锁冲突。</p><p>到这里我们小结一下：</p><ol>
<li>
<p>MySQL在第一次打开分区表的时候，需要访问所有的分区；</p></li><li>
<p>在server层，认为这是同一张表，因此所有分区共用同一个MDL锁；</p></li><li>
<p>在引擎层，认为这是不同的表，因此MDL锁之后的执行过程，会根据分区表规则，只访问必要的分区。</p></li></ol><p>而关于“必要的分区”的判断，就是根据SQL语句中的where条件，结合分区规则来实现的。比如我们上面的例子中，where ftime='2018-4-1'，根据分区规则year函数算出来的值是2018，那么就会落在p_2019这个分区。</p><p>但是，如果这个where 条件改成 where ftime>='2018-4-1'，虽然查询结果相同，但是这时候根据where条件，就要访问p_2019和p_others这两个分区。</p><p>如果查询语句的where条件中没有分区key，那就只能访问所有分区了。当然，这并不是分区表的问题。即使是使用业务分表的方式，where条件中没有使用分表的key，也必须访问所有的分表。</p><p>我们已经理解了分区表的概念，那么什么场景下适合使用分区表呢？</p><h1>分区表的应用场景</h1><p>分区表的一个显而易见的优势是对业务透明，相对于用户分表来说，使用分区表的业务代码更简洁。还有，分区表可以很方便的清理历史数据。</p><p>如果一项业务跑的时间足够长，往往就会有根据时间删除历史数据的需求。这时候，按照时间分区的分区表，就可以直接通过alter table t drop partition ...这个语法删掉分区，从而删掉过期的历史数据。</p><p>这个alter table t drop partition ...操作是直接删除分区文件，效果跟drop普通表类似。与使用delete语句删除数据相比，优势是速度快、对系统影响小。</p><h1>小结</h1><p>这篇文章，我主要和你介绍的是server层和引擎层对分区表的处理方式。我希望通过这些介绍，你能够对是否选择使用分区表，有更清晰的想法。</p><p>需要注意的是，我是以范围分区（range）为例和你介绍的。实际上，MySQL还支持hash分区、list分区等分区方法。你可以在需要用到的时候，再翻翻<a href=https://dev.mysql.com/doc/refman/8.0/en/partitioning-types.html>手册</a>。</p><p>实际使用时，分区表跟用户分表比起来，有两个绕不开的问题：一个是第一次访问的时候需要访问所有分区，另一个是共用MDL锁。</p><p>因此，如果要使用分区表，就不要创建太多的分区。我见过一个用户做了按天分区策略，然后预先创建了10年的分区。这种情况下，访问分区表的性能自然是不好的。这里有两个问题需要注意：</p><ol>
<li>
<p>分区并不是越细越好。实际上，单表或者单分区的数据一千万行，只要没有特别大的索引，对于现在的硬件能力来说都已经是小表了。</p></li><li>
<p>分区也不要提前预留太多，在使用之前预先创建即可。比如，如果是按月分区，每年年底时再把下一年度的12个新分区创建上即可。对于没有数据的历史分区，要及时的drop掉。</p></li></ol><p>至于分区表的其他问题，比如查询需要跨多个分区取数据，查询性能就会比较慢，基本上就不是分区表本身的问题，而是数据量的问题或者说是使用方式的问题了。</p><p>当然，如果你的团队已经维护了成熟的分库分表中间件，用业务分表，对业务开发同学没有额外的复杂性，对DBA也更直观，自然是更好的。</p><p>最后，我给你留下一个思考题吧。</p><p>我们举例的表中没有用到自增主键，假设现在要创建一个自增字段id。MySQL要求分区表中的主键必须包含分区字段。如果要在表t的基础上做修改，你会怎么定义这个表的主键呢？为什么这么定义呢？</p><p>你可以把你的结论和分析写在留言区，我会在下一篇文章的末尾和你讨论这个问题。感谢你的收听，也欢迎你把这篇文章分享给更多的朋友一起阅读。</p><h1>上期问题时间</h1><p>上篇文章后面还不够多，可能很多同学还没来记得看吧，我们就等后续有更多留言的时候，再补充本期的“上期问题时间”吧。</p><p>@夹心面包 提到了在grant的时候是支持通配符的："_"表示一个任意字符，“%”表示任意字符串。这个技巧在一个分库分表方案里面，同一个分库上有多个db的时候，是挺方便的。不过我个人认为，权限赋值的时候，控制的精确性还是要优先考虑的。</p><style>ul{list-style:none;display:block;list-style-type:disc;margin-block-start:1em;margin-block-end:1em;margin-inline-start:0;margin-inline-end:0;padding-inline-start:40px}li{display:list-item;text-align:-webkit-match-parent}._2sjJGcOH_0{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-top:26px;border-bottom:1px solid rgba(233,233,233,.6)}._2sjJGcOH_0 ._3FLYR4bF_0{width:34px;height:34px;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}._2sjJGcOH_0 ._36ChpWj4_0{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding-bottom:20px}._2sjJGcOH_0 ._36ChpWj4_0 ._2zFoi7sd_0{font-size:16px;color:#3d464d;font-weight:500;-webkit-font-smoothing:antialiased;line-height:34px}._2sjJGcOH_0 ._36ChpWj4_0 ._2_QraFYR_0{margin-top:12px;color:#505050;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;white-space:normal;word-break:break-all;line-height:24px}._2sjJGcOH_0 ._10o3OAxT_0{margin-top:18px;border-radius:4px;background-color:#f6f7fb}._2sjJGcOH_0 ._3klNVc4Z_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:15px}._2sjJGcOH_0 ._10o3OAxT_0 ._3KxQPN3V_0{color:#505050;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;white-space:normal;word-break:break-word;padding:20px 20px 20px 24px}._2sjJGcOH_0 ._3klNVc4Z_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:15px}._2sjJGcOH_0 ._3Hkula0k_0{color:#b2b2b2;font-size:14px}</style><ul><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>夹心面包</span>
</div><div class=_2_QraFYR_0>我说下我的感想<br>1 经典的利用分区表的场景<br> 1 zabbix历史数据表的改造,利用存储过程创建和改造<br> 2 后台数据的分析汇总,比如日志数据,便于清理<br>这两种场景我们都在执行,我们对于分区表在业务采用的是hash 用户ID方式,不过大规模应用分区表的公司我还没遇到过<br>2 分区表需要注意的几点<br>总结下<br>1 由于分区表都很大,DDL耗时是非常严重的,必须考虑这个问题<br>2 分区表不能建立太多的分区,我曾被分享一个因为分区表分区过多导致的主从延迟问题<br>3 分区表的规则和分区需要预先设置好,否则后来进行修改也很麻烦<br></div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 👍 非常好<br></p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 14:42:04</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>aliang</span>
</div><div class=_2_QraFYR_0>老师，mysql还有一个参数是innodb_open_files，资料上说作用是限制Innodb能打开的表的数量。它和open_files_limit之间有什么关系吗？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 好问题。<br><br>在InnoDB引擎打开文件超过 innodb_open_files这个值的时候，就会关掉一些之前打开的文件。<br><br>其实我们文章中 ，InnoDB分区表使用了本地分区策略以后，即使分区个数大于open_files_limit ，打开InnoDB分区表也不会报“打开文件过多”这个错误，就是innodb_open_files这个参数发挥的作用。<br></p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-21 14:47:17</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>钱</span>
</div><div class=_2_QraFYR_0>1：啥是分区表？<br>创建表的时候，使用了数据分区相关的语法，存储数据的时候，存储引擎会根据分区规则将不同的数据存入不同的分区文件。<br>2：使用分区表的劣势？<br>2-1：MySQL 在第一次打开分区表的时候，需要访问所有的分区——打开的表较多，性能糟糕也可能报打开的表超过设置的问题。<br>2-2：在 server 层，认为这是同一张表，因此所有分区共用同一个 MDL 锁——锁粒度大，影响并发度，站在Server看也是合理的，不过站在存储引擎的角度看就不合理了。<br>2-3：在引擎层，认为这是不同的表，因此 MDL 锁之后的执行过程，会根据分区表规则，只访问必要的分区——被访问到的分区。<br>3：使用分区表的优势？<br>分区表的一个显而易见的优势是对业务透明，相对于用户分表来说，使用分区表的业务代码更简洁。还有，分区表可以很方便的清理历史数据。<br>4：啥时候适合使用分区表？<br>单表过大时，使用时注意一下两点<br>4-1：分区并不是越细越好。实际上，单表或者单分区的数据一千万行，只要没有特别大的索引，对于现在的硬件能力来说都已经是小表了。<br>4-2：分区也不要提前预留太多，在使用之前预先创建即可。比如，如果是按月分区，每年年底时再把下一年度的 12 个新分区创建上即可。对于没有数据的历史分区，要及时的 drop 掉。<br>5：使用分区表，有其特点的根本原因？<br>对于Server层，分区表还是一个表<br>对于存储引擎层，分区表会是多张表</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-08-09 09:17:35</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>万勇</span>
</div><div class=_2_QraFYR_0>老师，请问add column after column_name跟add column不指定位置，这两种性能上有区别吗？我们在add column 指定after column_name的情况很多。</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 仅仅看性能，是没什么差别的<br><br>但是建议尽量不要加after column_name，<br>也就是说尽量加到最后一列。<br><br>因为其实没差别，但是加在最后有以下两个好处：<br>1. 开始有一些分支支持快速加列，就是说如果你加在最后一列，是瞬间就能完成，而加了after column_name，就用不上这些优化（以后潜在的好处）<br><br>2. 我们在前面的文章有提到过，如果怕对线上业务造成影响，有时候是通过“先做备库、切换、再做备库”这种方式来执行ddl的，那么使用after column_name的时候用不上这种方式。<br><br>实际上列的数据是不应该有影响的，还是要形成好习惯😆</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-21 17:41:47</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>郭江伟</span>
</div><div class=_2_QraFYR_0>此时主键包含自增列+分区键，原因为对innodb来说分区等于单独的表，自增字段每个分区可以插入相同的值，如果主键只有自增列无法完全保证唯一性。<br>测试表如下：<br>mysql> show create table t\G<br> Table: t<br>Create Table: CREATE TABLE `t` (<br> `id` int(11) NOT NULL AUTO_INCREMENT,<br> `ftime` datetime NOT NULL,<br> `c` int(11) DEFAULT NULL,<br> PRIMARY KEY (`id`,`ftime`),<br> KEY `ftime` (`ftime`)<br>) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4<br>/*!50100 PARTITION BY RANGE (YEAR(ftime))<br>(PARTITION p_2017 VALUES LESS THAN (2017) ENGINE = InnoDB,<br> PARTITION p_2018 VALUES LESS THAN (2018) ENGINE = InnoDB,<br> PARTITION p_2019 VALUES LESS THAN (2019) ENGINE = InnoDB,<br> PARTITION p_others VALUES LESS THAN MAXVALUE ENGINE = InnoDB) */<br>1 row in set (0.00 sec)<br>mysql> insert into t values(1,'2017-4-1',1),(1,'2018-4-1',1);<br>Query OK, 2 rows affected (0.02 sec)<br>mysql> select * from t;<br>+----+---------------------+------+<br>| id | ftime | c |<br>+----+---------------------+------+<br>| 1 | 2017-04-01 00:00:00 | 1 |<br>| 1 | 2018-04-01 00:00:00 | 1 |<br>+----+---------------------+------+<br>2 rows in set (0.00 sec)<br><br>mysql> insert into t values(null,'2017-5-1',1),(null,'2018-5-1',1);<br>Query OK, 2 rows affected (0.02 sec)<br><br>mysql> select * from t;<br>+----+---------------------+------+<br>| id | ftime | c |<br>+----+---------------------+------+<br>| 1 | 2017-04-01 00:00:00 | 1 |<br>| 2 | 2017-05-01 00:00:00 | 1 |<br>| 1 | 2018-04-01 00:00:00 | 1 |<br>| 3 | 2018-05-01 00:00:00 | 1 |<br>+----+---------------------+------+<br>4 rows in set (0.00 sec)</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 👍</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 09:36:55</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>☞</span>
</div><div class=_2_QraFYR_0>老师确认下，5.7.9之后的innodb分区表，是访问第一个表时不会去打开所有的分区表了吗？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 第一次访问的时候，要打开所有分区的<br><br></p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-25 16:35:20</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>wljs</span>
</div><div class=_2_QraFYR_0><br>老师我想问个问题 我们公司一个订单表有110个字段 想拆分成两个表 第一个表放经常查的字段 第二个表放不常查的 现在程序端不想改sql，数据库端来实现 当查询字段中 第一个表不存在 就去关联第二个表查出数据 db能实现不</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 用view可能可以实现部分你的需求，但是强烈不建议这么做。<br>业务不想修改，就好好跟他们说，毕竟这样分（常查和不常查的垂直拆分）是合理的，对读写性能都有明显的提升的。</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 08:48:51</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>权恒星</span>
</div><div class=_2_QraFYR_0>这个只适合单机吧？集群没法即使用innodb引擎，又支持分区表吧，只能使用中间件了。之前调研了一下，官方只有ndb cluster才支持分区表？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 对这篇文章讲的是单机上的单表多分区</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 20:34:51</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>怀刚</span>
</div><div class=_2_QraFYR_0>请教下采用”先做备库、切换、再做备库”DDL方式不支持AFTER COLUMN是因为BINLOG原因吗？<br>以上DDL方式会存在影响“有损”的吧？“无损”有哪些方案呢？如果备库承载读请求但又不能接受“长时间”延时</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 1. 对，binlog对原因<br>2. 如果延迟算损失，确实是有损的。备库上的读流量要先切换到主库（也就是为什么需要在低峰期做做个操作）</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-03-09 10:01:56</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>千木</span>
</div><div class=_2_QraFYR_0>老师您好，你在文章里面有说通用分区规则会打开所有引擎文件导致不可用，而本地分区规则应该是只打开单个引擎文件，那你不建议创建太多分区的原因是什么呢？如果是本地分区规则，照例说是不会影响的吧，叨扰了</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: “本地分区规则应该是只打开单个引擎文件”，并不是哈，我在文章末尾说了，也会打开所有文件的，只是说本地分区规则有优化，比如如果文件数过多，就会淘汰之前打开的文件句柄（暂时关掉）。<br><br>所以分区太多，还是会有影响的<br></p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 09:46:22</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>Q</span>
</div><div class=_2_QraFYR_0>老师 请问下 网站开发数据库表是myisam和innodb混合引擎 考虑管理比较麻烦 想统一成innodb 请问是否影响数据库或带来什么隐患吗？ 网站是网上商城购物类型的</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 应该统一成innodb<br>网上商城购物类型更要用InnoDB，因为MyISAM并不是crash-safe的。<br><br>测试环境改完回归下</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 21:25:25</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>分清云淡</span>
</div><div class=_2_QraFYR_0>阿里云的DRDS就是分库分表的中间件典型代表。自己实现了一个层Server访问层在这一层进行分库分表（对透明），然后MySQL只是相当于存储层。一些Join、负载Order by/Group by都在DRDS中间件这层完成，简单的逻辑插叙计算完对应的分库分表后下推给MySQL https://www.aliyun.com/product/drds</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-25 17:01:18</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>helloworld.xs</span>
</div><div class=_2_QraFYR_0>请教个问题，一般mysql会有查询缓存，但是update操作也有缓存机制吗？使用mysql console第一次执行一个update SQL耗时明显比后面执行相同update SQL要慢，这是为什么？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: update的话，主要应该第一次执行的时候，数据都读入到了</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-21 18:37:35</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>布衣骇客</span>
</div><div class=_2_QraFYR_0>这次竟然只需要再读两次就能读懂，之前接触过mycat和sharding-jdbc实现分区,老师能否谈谈这方面的呢</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 赞两次 😆<br><br>这个就是我们文章说的“分库分表中间件”<br>不过看到不少公司都会要在这基础上做点定制化</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 15:51:23</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>zc</span>
</div><div class=_2_QraFYR_0>alter table t drop partition 不加元数据锁吗？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 要加 不过因为时间很短，可以认为是安全操作</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2020-02-10 16:19:14</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>daka</span>
</div><div class=_2_QraFYR_0>本期提到了ndb，了解了下，这个存储引擎高可用及读写可扩展性功能都是自带，感觉是不错，为什么很少见人使用呢？生产不可靠？</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-21 22:55:06</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>NICK</span>
</div><div class=_2_QraFYR_0>老师，如果用户分区，业务要做分页过滤查询怎么做才好？</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 分区表的用法跟普通表，在sql语句上是相同的。</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-25 15:00:00</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>undifined</span>
</div><div class=_2_QraFYR_0>老师，有两个问题<br>1. 图三的间隙锁，根据“索引上的等值查询，向右遍历时且最后一个值不满足等值条件的时候，next-key lock 退化为间隙锁”，不应该是 (-∞,2017-4-1],(2017-4-1,2018-4-1)吗，图4左边的也应该是 (-∞,2017-4-1],(2017-4-1, supernum)，是不是图画错了<br>2. 现有的一个表，一千万行的数据， InnoDB 引擎，如果以月份分区，即使有 MDL 锁和初次访问时会查询所有分区，但是综合来看，分区表的查询性能还是要比不分区好，这样理解对吗<br><br>思考题的答案 <br>ALTER TABLE t<br> ADD COLUMN (id INT AUTO_INCREMENT ),<br> ADD PRIMARY KEY (id, ftime);<br><br>麻烦老师解答一下，谢谢老师</div><div class=_10o3OAxT_0>
<p class=_3KxQPN3V_0>作者回复: 1. 我们语句里面是 where ftime='2017-5-1' 哈，不是“4-1”<br>2. “分区表的查询性能还是要比不分区好，这样理解对吗”，其实还是要看表的索引情况。<br> 当然一定存在一个数量级N，把这N行分到10个分区表，比把这N行放到一个大表里面，效率高</p></div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-02-20 10:53:49</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>何霖</span>
</div><div class=_2_QraFYR_0>尊敬的作者，你说“分区并不是越细越好。实际上，单表或者单分区的数据一千万行，只要没有特别大的索引，对于现在的硬件能力来说都已经是小表了”，怎么判断索引是大索引还是小索引啊。</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2021-05-19 09:40:15</div></div></div></div></li><li>
<div class=_2sjJGcOH_0>
<div class=_36ChpWj4_0>
<div class=_2zFoi7sd_0><span>程辉</span>
</div><div class=_2_QraFYR_0>奇哥，我们现在有个表的数据量上亿了，每个月百万+的数据量，考虑做分区。表结构：<br>id bigint(20) auto_increment,<br>imei varchar(32),<br>atime timestamp,<br>primary key (id),<br>unique key imei (imei)<br>经讨论后考虑对atime做range分区，然后因为分区字段必须被包含在主键和唯一索引上，imei的唯一索引已经没有意义了，变成下面的表结构：<br>id bigint(20) primary key,<br>imei varchar(32),<br>atime timestamp,<br>primary key (id, atime),<br>key imei (imei)<br>partition by range ( UNIX_TIMESTAMP(atime) ) (<br>partition p2018_01_06 values less than ( UNIX_TIMESTAMP('2018-07-01') ),<br>partition p2018_07_12 values less than ( UNIX_TIMESTAMP('2019-01-01') ),<br>...<br>)<br>之前imei有唯一索引，是可以用REPLACE INTO做批量插入的，这样插入很快。<br>但是分区之后，因为imei失去了唯一性，在插入的时候要先去查这个imei存不存在，不存在再插入，没办法做批量插入了，性能下降很多。<br>这个有办法解决吗？</div><div class=_10o3OAxT_0>
</div><div class=_3klNVc4Z_0>
<div class=_3Hkula0k_0>2019-08-16 10:16:35</div></div></div></div></li></ul><footer class=footline>
</footer></div></div><div id=navigation>
<a class="nav nav-prev" href=/1/42/ title=42_grant之后要跟着flushprivileges吗？> <i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/1/44/ title=44_答疑文章（三）：说一说这些好问题 style=margin-right:0><i class="fa fa-chevron-right"></i></a>
</div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px>
<div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1646795377></script>
<script src=/js/perfect-scrollbar.min.js?1646795377></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1646795377></script>
<script src=/js/jquery.sticky.js?1646795377></script>
<script src=/js/featherlight.min.js?1646795377></script>
<script src=/js/highlight.pack.js?1646795377></script>
<script>hljs.initHighlightingOnLoad()</script>
<script src=/js/modernizr.custom-3.6.0.js?1646795377></script>
<script src=/js/learn.js?1646795377></script>
<script src=/js/hugo-learn.js?1646795377></script>
<script src=/mermaid/mermaid.js?1646795377></script>
<script>mermaid.initialize({startOnLoad:!0})</script>
</body></html>